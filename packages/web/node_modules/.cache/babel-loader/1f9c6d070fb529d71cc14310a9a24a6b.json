{"ast":null,"code":"import _defineProperty from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport r, { useState as f, useEffect as b, useRef as K } from \"react\";\nimport { connect as $ } from \"react-redux\";\nimport { classnames as I } from \"../../../../utils/index.js\";\nimport { Input as q } from \"antd/es\";\nimport { cKeyCode as L, uuid as M } from \"@label-u/annotation\";\nimport { UpdateImgList as U, PageForward as B } from \"../../../../store/annotation/actionCreators.js\";\nimport { ConfigUtils as J } from \"../../../../utils/ConfigUtils.js\";\nimport { useTranslation as z } from \"react-i18next\";\nvar V = Object.defineProperty,\n  W = Object.defineProperties,\n  G = Object.getOwnPropertyDescriptors,\n  S = Object.getOwnPropertySymbols,\n  H = Object.prototype.hasOwnProperty,\n  Q = Object.prototype.propertyIsEnumerable,\n  C = function C(e, t, o) {\n    return t in e ? V(e, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: o\n    }) : e[t] = o;\n  },\n  R = function R(e, t) {\n    for (var o in t || (t = {})) H.call(t, o) && C(e, o, t[o]);\n    if (S) {\n      var _iterator = _createForOfIteratorHelper(S(t)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var o = _step.value;\n          Q.call(t, o) && C(e, o, t[o]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return e;\n  },\n  X = function X(e, t) {\n    return W(e, G(t));\n  };\nvar F = L.default,\n  k = function k(e) {\n    e.stopPropagation(), e.nativeEvent.stopPropagation(), e.nativeEvent.stopImmediatePropagation();\n  },\n  D = function D(e) {\n    var t = e.textareaProps,\n      o = e.footer;\n    return /*#__PURE__*/r.createElement(r.Fragment, null, /*#__PURE__*/r.createElement(q.TextArea, R({\n      bordered: !1,\n      rows: 6,\n      onKeyDown: k,\n      onKeyUp: k\n    }, t)), /*#__PURE__*/r.createElement(\"div\", {\n      className: I({\n        textAreaLength: !0\n      })\n    }, o));\n  },\n  j = function j(e) {\n    var t;\n    var o = K(null),\n      _f = f(!1),\n      _f2 = _slicedToArray(_f, 2),\n      v = _f2[0],\n      g = _f2[1],\n      _f3 = f(!1),\n      _f4 = _slicedToArray(_f3, 2),\n      N = _f4[0],\n      T = _f4[1],\n      _z = z(),\n      h = _z.t,\n      u = e.disabled,\n      i = e.config,\n      c = e.result,\n      y = e.updateText,\n      l = e.index,\n      p = e.switchToNextTextarea,\n      _ = e.hasMultiple,\n      P = e.onNext,\n      x = i.maxLength,\n      _f5 = f(\"\"),\n      _f6 = _slicedToArray(_f5, 2),\n      d = _f6[0],\n      O = _f6[1];\n    b(function () {\n      c && c.length > 0 && c[l] && O(c[l].value[i.key]);\n    }, [c]);\n    var w = (t = d == null ? void 0 : d.length) != null ? t : 0,\n      a = function a(s) {\n        y && (y(s, i.key, l), i.required && T(!s));\n      },\n      n = _ && p,\n      E = {\n        id: \"textInput-\".concat(l),\n        ref: o,\n        disabled: u,\n        value: d,\n        maxLength: x,\n        autoSize: {\n          minRows: 2,\n          maxRows: 6\n        },\n        onChange: function onChange(s) {\n          var A = s.target.value;\n          O(A);\n        },\n        onFocus: function onFocus() {\n          g(!0);\n        },\n        onBlur: function onBlur(s) {\n          g(!1), a(d), i.required && T(!s.target.value);\n        },\n        style: {\n          resize: \"none\",\n          wordBreak: \"break-all\"\n        },\n        onKeyDownCapture: function onKeyDownCapture(s) {\n          s.ctrlKey && s.keyCode === F.Enter && (P && P(), s.preventDefault()), s.keyCode === F.Tab && n && (s.preventDefault(), s.nativeEvent.stopImmediatePropagation(), p(l)), s.nativeEvent.stopPropagation();\n        }\n      },\n      m = /*#__PURE__*/r.createElement(\"div\", {\n        className: \"textAreaFooter\"\n      }, /*#__PURE__*/r.createElement(\"div\", {\n        className: \"hotkeyTip\"\n      }, n && /*#__PURE__*/r.createElement(\"span\", null, \"[\".concat(h(\"Switch\"), \"]Tab\")), /*#__PURE__*/r.createElement(\"span\", null, \"[\".concat(h(\"TurnPage\"), \"]Ctrl+Enter\"))), /*#__PURE__*/r.createElement(\"div\", {\n        className: \"wordCount\"\n      }, /*#__PURE__*/r.createElement(\"span\", {\n        className: w >= x ? \"warning\" : \"\"\n      }, w), \"/\", /*#__PURE__*/r.createElement(\"span\", null, x)));\n    return b(function () {\n      u && g(!1);\n    }, [u]), /*#__PURE__*/r.createElement(\"div\", {\n      className: \"textField\"\n    }, /*#__PURE__*/r.createElement(\"div\", {\n      className: \"label\"\n    }, /*#__PURE__*/r.createElement(\"span\", {\n      className: I({\n        required: i.required\n      })\n    }, i.label)), /*#__PURE__*/r.createElement(\"div\", {\n      className: I({\n        disabled: u,\n        \"textarea-outline\": !0,\n        \"ant-input-focused\": v,\n        textareaContainer: !0,\n        focus: v,\n        invalid: N\n      })\n    }, /*#__PURE__*/r.createElement(D, {\n      footer: m,\n      textareaProps: E\n    })));\n  },\n  Y = function Y(_ref) {\n    var e = _ref.imgList,\n      t = _ref.textConfig,\n      o = _ref.imgIndex,\n      v = _ref.dispatch,\n      g = _ref.isPreview,\n      N = _ref.step,\n      T = _ref.stepList,\n      h = _ref.basicResultList;\n    var _f7 = f(0),\n      _f8 = _slicedToArray(_f7, 2),\n      u = _f8[0],\n      i = _f8[1],\n      _f9 = f(0),\n      _f10 = _slicedToArray(_f9, 2),\n      c = _f10[0],\n      y = _f10[1],\n      _f11 = f([]),\n      _f12 = _slicedToArray(_f11, 2),\n      l = _f12[0],\n      p = _f12[1],\n      _ = function _(a) {\n        var n = (a + 1) % t.length;\n        P(n);\n      },\n      P = function P(a) {\n        setTimeout(function () {\n          var n = document.getElementById(\"textInput-\".concat(a));\n          n && (i(a), n.focus(), n.select(), n.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"center\"\n          }));\n        });\n      };\n    b(function () {\n      if (e && e.length > 0) {\n        var a = JSON.parse(e[o].result),\n          n = (a == null ? void 0 : a.textTool) ? a == null ? void 0 : a.textTool.result : [];\n        if (n && n.length > 0 && p(n), (!n || n.length === 0) && t && t.length > 0) {\n          var E = t.map(function (m, s) {\n            return {\n              id: M(),\n              sourceID: \"\",\n              value: _defineProperty({}, m.key, m.default)\n            };\n          });\n          p(E);\n        }\n      }\n    }, [t, e, o]);\n    var x = function x(a, n, E) {\n      if (a) {\n        l[E].value[n] = a;\n        var m = JSON.parse(e[o].result),\n          s = X(R({}, m), {\n            textTool: {\n              toolName: \"textTool\",\n              result: l\n            }\n          });\n        e[o].result = JSON.stringify(s), v(U(e)), p(l);\n      }\n    };\n    b(function () {\n      y(new Date().getTime());\n    }, [l]);\n    var d = function d() {\n        v(B(!0));\n      },\n      w = J.getStepConfig(T, N).dataSourceStep > 0 && h.length === 0;\n    return /*#__PURE__*/r.createElement(\"div\", {\n      className: I({\n        textToolOperationMenu: !0,\n        textToolOperationMenuPreview: g\n      })\n    }, l && l.length > 0 && t.map(function (a, n) {\n      return /*#__PURE__*/r.createElement(j, {\n        config: a,\n        key: a.key + c,\n        index: n,\n        result: l,\n        updateText: x,\n        switchToNextTextarea: _,\n        hasMultiple: t.length > 1,\n        focus: u === n,\n        onNext: d,\n        disabled: w\n      });\n    }));\n  };\nfunction Z(e) {\n  return {\n    imgList: e.annotation.imgList,\n    textConfig: e.annotation.textConfig,\n    imgIndex: e.annotation.imgIndex,\n    step: e.annotation.step,\n    basicResultList: e.annotation.basicResultList,\n    stepList: e.annotation.stepList,\n    triggerEventAfterIndexChanged: e.annotation.triggerEventAfterIndexChanged\n  };\n}\nvar ee = $(Z)(Y);\nexport { j as SingleTextInput, D as TextareaWithFooter, ee as default };","map":null,"metadata":{},"sourceType":"module"}