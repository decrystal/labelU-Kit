{"ast":null,"code":"import _toConsumableArray from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// cl 2021/9/8 09:51\nimport React,{useState}from'react';import{Input,Button,Tooltip,Modal,Form}from'antd';import{cloneDeep}from'lodash';import{SettingOutlined,CloseCircleFilled}from'@ant-design/icons';// import { Config, defaultValue } from '../index';\nimport TextConfig from'./textConfig';import classnames from'classnames';import'./index.less';import{useTranslation}from'react-i18next';import{jsx as _jsx}from\"@emotion/react/jsx-runtime\";import{jsxs as _jsxs}from\"@emotion/react/jsx-runtime\";var confirm=Modal.confirm;export var defaultValue={label:'文本',key:'text',required:false,default:'',maxLength:1000};var TextList=function TextList(_ref){var value=_ref.value,onChange=_ref.onChange,onDelete=_ref.onDelete,onAdd=_ref.onAdd;var _useState=useState([defaultValue]),_useState2=_slicedToArray(_useState,2),configs=_useState2[0],setConfigs=_useState2[1];var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var _useTranslation=useTranslation(),t=_useTranslation.t;var triggerChange=function triggerChange(list){onChange===null||onChange===void 0?void 0:onChange(list);};var updateConfigItem=function updateConfigItem(newConfig,index){var textConfigListArray=cloneDeep(value||configs);Object.assign(textConfigListArray[index],newConfig);if(!value){setConfigs(textConfigListArray);}triggerChange(textConfigListArray);};var addTextConfigItem=function addTextConfigItem(){var len=(value||configs).length;var newConfig=_objectSpread({},defaultValue);newConfig.label+=len+1;newConfig.key+=len+1;if(!value){setConfigs(function(state){return[].concat(_toConsumableArray(state),[newConfig]);});}onAdd===null||onAdd===void 0?void 0:onAdd([].concat(_toConsumableArray(value||configs),[newConfig]));// triggerChange([...(value || configs), newConfig]);\n};var deleteConfig=function deleteConfig(index){var tmpValue=value||configs;var list=_toConsumableArray(tmpValue).filter(function(item,Tindex){return Tindex!==index;});if(list.length===1&&list[0].key!=='text'){list=[_objectSpread({},defaultValue)];}if(!value){setConfigs(_toConsumableArray(list));}onDelete===null||onDelete===void 0?void 0:onDelete(_toConsumableArray(list));};function showPromiseConfirm(obj,index){confirm({title:'文本设置',icon:null,width:600,content:_jsx(TextConfig,{form:form,label:obj.label,maxLength:obj.maxLength,default:obj.default}),onOk:function onOk(){return new Promise(function(resolve,reject){form.validateFields().then(function(values){if(values){updateConfigItem(values,index);resolve(true);}else{reject();}});});},onCancel:function onCancel(){}});}return _jsxs(\"div\",{className:classnames({// selectedMain: true,\nlabeluInputWrap:true}),children:[(value||configs).map(function(i,index){return _jsxs(\"div\",{className:classnames({multiple:(value||configs).length>1,textConfigItem:true}),children:[_jsx(\"span\",{className:\"textConfigIndex\",children:index+1}),_jsx(Input,{value:i.label,className:\"textConfigInput labelu-input\",placeholder:t('DisplayValue'),onChange:function onChange(e){updateConfigItem({label:e.target.value},index);}}),_jsx(Input,{value:i.key,className:\"textConfigInput\",placeholder:t('SaveValue'),disabled:(value||configs).length===1,onChange:function onChange(e){updateConfigItem({key:e.target.value},index);}}),_jsxs(\"div\",{className:\"textConfigIconBox\",children:[_jsx(Tooltip,{title:t('MoreSettings'),children:_jsx(SettingOutlined,{className:classnames({activeColor:i.default}),onClick:function onClick(){return showPromiseConfirm({label:i.label,default:i.default,maxLength:i.maxLength},index);}})}),_jsx(CloseCircleFilled,{className:\"close\",onClick:function onClick(){deleteConfig(index);}}),_jsx(\"span\",{})]})]},index);}),_jsx(Button,{type:\"primary\",style:{marginTop:16,borderRadius:4},onClick:addTextConfigItem,ghost:true,children:\"\\u65B0\\u5EFA\"})]});};export default TextList;","map":null,"metadata":{},"sourceType":"module"}