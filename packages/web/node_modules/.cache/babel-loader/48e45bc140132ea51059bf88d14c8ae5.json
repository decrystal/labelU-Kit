{"ast":null,"code":"import _regeneratorRuntime from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,Suspense,useCallback,useState}from'react';import{Layout,Drawer}from'antd';import'./index.less';import MenuComponent from'./menu';import HeaderComponent from'./header';import{getGlobalState}from'../../utils/getGloabal';import SuspendFallbackLoading from'./suspendFallbackLoading';import{getMenuList}from'../../api/layout.api';import{Outlet,useLocation,useNavigate}from'react-router';import{setUserItem}from'../../stores/user.store';import{useDispatch,useSelector}from'react-redux';import{jsx as _jsx}from\"@emotion/react/jsx-runtime\";import{jsxs as _jsxs}from\"@emotion/react/jsx-runtime\";var Sider=Layout.Sider,Content=Layout.Content;var WIDTH=992;var LayoutPage=function LayoutPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),menuList=_useState2[0],setMenuList=_useState2[1];var _useSelector=useSelector(function(state){return state.user;}),device=_useSelector.device,collapsed=_useSelector.collapsed;var isMobile=device==='MOBILE';var dispatch=useDispatch();// const { driverStart } = useGuide();\nvar location=useLocation();var navigate=useNavigate();useEffect(function(){if(location.pathname==='/'){navigate('/dashboard');}},[navigate,location]);var toggle=function toggle(){dispatch(setUserItem({collapsed:!collapsed}));};var initMenuListAll=function initMenuListAll(menu){var MenuListAll=[];menu.forEach(function(m){var _m$children;if(!(m!==null&&m!==void 0&&(_m$children=m.children)!==null&&_m$children!==void 0&&_m$children.length)){MenuListAll.push(m);}else{m===null||m===void 0?void 0:m.children.forEach(function(mu){MenuListAll.push(mu);});}});return MenuListAll;};var fetchMenuList=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$getMenuList,status,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return getMenuList();case 2:_yield$getMenuList=_context.sent;status=_yield$getMenuList.status;result=_yield$getMenuList.result;if(status){setMenuList(result);dispatch(setUserItem({menuList:initMenuListAll(result)}));}case 6:case\"end\":return _context.stop();}},_callee);})),[dispatch]);useEffect(function(){fetchMenuList();},[fetchMenuList]);useEffect(function(){window.onresize=function(){var _getGlobalState=getGlobalState(),device=_getGlobalState.device;var rect=document.body.getBoundingClientRect();var needCollapse=rect.width<WIDTH;dispatch(setUserItem({device:device,collapsed:needCollapse}));};},[dispatch]);return _jsxs(Layout,{className:\"layout-page\",children:[_jsx(HeaderComponent,{collapsed:collapsed,toggle:toggle}),_jsxs(Layout,{children:[!isMobile?_jsx(Sider,{className:\"layout-page-sider\",trigger:null,collapsible:true,collapsed:collapsed,breakpoint:\"md\",children:_jsx(MenuComponent,{menuList:menuList})}):_jsx(Drawer,{width:\"200\",placement:\"left\",bodyStyle:{padding:0,height:'100%'},closable:false,onClose:toggle,visible:!collapsed,children:_jsx(MenuComponent,{menuList:menuList})}),_jsx(Content,{className:\"layout-page-content\",children:_jsx(Suspense,{fallback:_jsx(SuspendFallbackLoading,{message:\"\\u6B63\\u5728\\u52A0\\u8F7D\\u4E2D\",description:\"\\u8D44\\u6E90\\u52A0\\u8F7D\\u4E2D\\uFF0C\\u8BF7\\u7A0D\\u540E\\uFF01.\"}),children:_jsx(Outlet,{})})})]})]});};export default LayoutPage;","map":null,"metadata":{},"sourceType":"module"}