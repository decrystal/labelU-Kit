{"ast":null,"code":"import _slicedToArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport f, { useState as R, useRef as h, useEffect as a } from \"react\";\nimport { message as I } from \"antd/es\";\nimport { connect as x, useDispatch as z } from \"react-redux\";\nimport L from \"lodash\";\nimport { store as N } from \"../../../index.js\";\nimport T from \"../../../hooks/useSize.js\";\nimport { InitToolStyleConfig as D } from \"../../../store/toolStyle/actionCreators.js\";\nimport { ImgUtils as F } from \"@label-u/annotation\";\nimport k from \"../../../components/fileException/FileError.js\";\nimport { i18n as O } from \"@label-u/utils\";\nimport { ChangeSave as B } from \"../../../store/annotation/actionCreators.js\";\nvar U = Object.defineProperty,\n  V = Object.defineProperties,\n  Y = Object.getOwnPropertyDescriptors,\n  y = Object.getOwnPropertySymbols,\n  $ = Object.prototype.hasOwnProperty,\n  q = Object.prototype.propertyIsEnumerable,\n  E = function E(t, e, n) {\n    return e in t ? U(t, e, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: n\n    }) : t[e] = n;\n  },\n  b = function b(t, e) {\n    for (var n in e || (e = {})) $.call(e, n) && E(t, n, e[n]);\n    if (y) {\n      var _iterator = _createForOfIteratorHelper(y(e)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var n = _step.value;\n          q.call(e, n) && E(t, n, e[n]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return t;\n  },\n  G = function G(t, e) {\n    return V(t, Y(e));\n  };\nvar H = function H(t) {\n    var _R = R(0),\n      _R2 = _slicedToArray(_R, 2),\n      e = _R2[1],\n      n = z(),\n      l = t.toolName,\n      p = t.imgAttribute,\n      c = t.toolStyle,\n      o = t.toolInstance,\n      r = t.annotationEngine,\n      d = t.imgList,\n      w = t.imgIndex,\n      g = t.dataInjectionAtCreation,\n      v = t.renderEnhance,\n      S = h(null),\n      P = h(null),\n      s = T(S);\n    a(function () {\n      N.dispatch(D());\n    }, []), a(function () {\n      if (!!r) {\n        switch (O.language) {\n          case \"cn\":\n          case \"en\":\n            r.setLang(O.language);\n            break;\n        }\n        r == null || r.setDataInjectionAtCreation(g), r == null || r.setRenderEnhance(v);\n      }\n    }, [r, g, v]), a(function () {\n      o && (o.singleOn(\"messageError\", function (i) {\n        I.error(i);\n      }), o.singleOn(\"messageInfo\", function (i) {\n        I.info(i);\n      }), o.singleOn(\"changeAnnotationShow\", function () {\n        e(function (i) {\n          return i + 1;\n        });\n      }));\n    }, [o]), a(function () {\n      o && o.setImgAttribute(p);\n    }, [p]), a(function () {\n      o && o.setStyle(c), r && r.setStyle(c);\n    }, [c]), a(function () {\n      (o == null ? void 0 : o.setSize) && o.setSize(s), r && r.setSize(s);\n    }, [s]);\n    var j = function j() {\n      var i = d == null ? void 0 : d[w];\n      !(i == null ? void 0 : i.url) || F.load(i.url).then(function (m) {\n        r.setImgNode(m);\n      });\n    };\n    return a(function () {\n      var i;\n      var m = function m(_, A) {\n        var u;\n        return function () {\n          u && clearTimeout(u), u = setTimeout(function () {\n            _();\n          }, A);\n        };\n      };\n      window.Cthrottle = m;\n      var C = window.Cthrottle(function () {\n        n(B);\n      }, 100);\n      (i = document.getElementById(\"toolContainer\")) == null || i.addEventListener(\"saveLabelResultToImg\", function (_) {\n        C();\n      });\n    }, []), /*#__PURE__*/f.createElement(\"div\", {\n      ref: S,\n      className: \"annotationOperation\"\n    }, /*#__PURE__*/f.createElement(\"div\", {\n      className: \"canvas\",\n      ref: P,\n      style: s,\n      id: \"toolContainer\",\n      key: l\n    }), (o == null ? void 0 : o.isImgError) === !0 && /*#__PURE__*/f.createElement(k, G(b({}, s), {\n      reloadImage: j,\n      backgroundColor: \"#e2e2e2\",\n      ignoreOffsetY: !0\n    })));\n  },\n  J = function J(t) {\n    var e = L.pickBy(t.annotation, function (n, l) {\n      return [\"imgList\", \"imgIndex\", \"stepList\", \"step\", \"toolInstance\", \"annotationEngine\", \"loading\"].includes(l);\n    });\n    return b({\n      imgAttribute: t.imgAttribute,\n      toolStyle: t.toolStyle\n    }, e);\n  };\nvar K = x(J)(H);\nexport { K as default };","map":null,"metadata":{},"sourceType":"module"}