{"ast":null,"code":"import _slicedToArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport L from \"../../../../components/attributeList/index.js\";\nimport J from \"../../../../components/checkboxList/index.js\";\nimport { CaretRightOutlined as U } from \"@ant-design/icons\";\nimport { Collapse as E, Tooltip as z } from \"antd/es\";\nimport O, { cloneDeep as F } from \"lodash\";\nimport c, { useState as k, useRef as H, useEffect as P, useCallback as q } from \"react\";\nimport { TagUtils as G, CommonToolUtils as Q, uuid as W } from \"@label-u/annotation\";\nimport { connect as X, useDispatch as Y } from \"react-redux\";\nimport { useTranslation as Z } from \"react-i18next\";\nimport { ChangeSave as x, UpdateImgList as V } from \"../../../../store/annotation/actionCreators.js\";\nimport ee from \"classnames\";\nvar te = Object.defineProperty,\n  le = Object.defineProperties,\n  re = Object.getOwnPropertyDescriptors,\n  w = Object.getOwnPropertySymbols,\n  oe = Object.prototype.hasOwnProperty,\n  ne = Object.prototype.propertyIsEnumerable,\n  S = function S(n, o, s) {\n    return o in n ? te(n, o, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: s\n    }) : n[o] = s;\n  },\n  ae = function ae(n, o) {\n    for (var s in o || (o = {})) oe.call(o, s) && S(n, s, o[s]);\n    if (w) {\n      var _iterator = _createForOfIteratorHelper(w(o)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var s = _step.value;\n          ne.call(o, s) && S(n, s, o[s]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return n;\n  },\n  se = function se(n, o) {\n    return le(n, re(o));\n  };\nvar ue = E.Panel,\n  C = function C(_ref) {\n    var n = _ref.isActive;\n    return /*#__PURE__*/c.createElement(U, {\n      rotate: n ? 90 : 0,\n      style: {\n        color: \"rgba(0, 0, 0, 0.36)\"\n      }\n    });\n  },\n  ce = function ce(_ref2) {\n    var n = _ref2.imgList,\n      o = _ref2.tagConfigList,\n      s = _ref2.imgIndex,\n      N = _ref2.isPreview;\n    var _k = k([]),\n      _k2 = _slicedToArray(_k, 2),\n      g = _k2[0],\n      R = _k2[1],\n      _k3 = k([]),\n      _k4 = _slicedToArray(_k3, 2),\n      v = _k4[0],\n      y = _k4[1],\n      $ = H(null),\n      _Z = Z(),\n      f = _Z.t,\n      _ = Y(),\n      j = function j() {\n        var r = document.getElementById(\"toolContainer\"),\n          e = window.self.document.getElementById(\"tagToolTag\");\n        e && r && r.contains(e) && (r == null || r.removeChild(e));\n      };\n    P(function () {\n      var r;\n      if (n && n.length > 0) {\n        var e = JSON.parse(n[s].result),\n          l = (e == null ? void 0 : e.tagTool) ? (r = e == null ? void 0 : e.tagTool) == null ? void 0 : r.result : [];\n        y(l);\n      }\n    }, [s, n]), P(function () {\n      B();\n    }, [v]);\n    var B = function B() {\n        var r, e, l;\n        if (j(), !((v == null ? void 0 : v.length) > 0)) return;\n        var t = document.getElementById(\"toolContainer\"),\n          i = document.createElement(\"div\"),\n          d = G.getTagNameList((e = (r = v[0]) == null ? void 0 : r.result) != null ? e : {}, o);\n        i.innerHTML = (l = d.reduce(function (a, p) {\n          return \"\".concat(a).concat(p.keyName, \": \").concat(p.value.join(\" \\u3001 \"), \"\\n\");\n        }, \"\")) != null ? l : \"\", i.setAttribute(\"id\", \"tagToolTag\"), i.setAttribute(\"style\", \"\\n        position: absolute;\\n        top: 0;\\n        right: 0;\\n        z-index: 5;\\n        padding: 0 20px;\\n        font-size: 15px;\\n        color: white;\\n        text-align: right;\\n        line-height: 32px;\\n        white-space: pre;\\n        background: rgba(102, 111, 255, 1);\\n        opacity: 0.6;\\n        clear: both;\\n      \");\n        var u = document.getElementById(\"tagToolTag\");\n        (t == null ? void 0 : t.contains(u)) || t == null || t.appendChild(i);\n      },\n      A = function A(r, e) {\n        var l;\n        try {\n          var t = o,\n            i = t.length > 1,\n            d = e !== void 0 ? r : 0,\n            u = e !== void 0 ? e : r,\n            a = i ? t[d] : t[0],\n            p = ((l = a.subSelected) != null ? l : [])[u];\n          if (a && p) return {\n            value: {\n              key: a.value,\n              value: p.value\n            },\n            isMulti: a.isMulti\n          };\n        } catch (t) {\n          return;\n        }\n      },\n      D = function D(r, e) {\n        var l, t;\n        var i = A(r, e);\n        if (i) {\n          var d = I(i, (t = (l = v[0]) == null ? void 0 : l.result) != null ? t : {}),\n            u = [{\n              sourceID: Q.getSourceID(),\n              id: W(8, 62),\n              result: d\n            }];\n          var a = JSON.parse(n[s].result),\n            p = se(ae({}, a), {\n              tagTool: {\n                toolName: \"tagTool\",\n                result: [].concat(u)\n              }\n            });\n          n[s].result = JSON.stringify(p), _(V(n)), y(u);\n        }\n      },\n      I = function I(r) {\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var l, t;\n        var i = r.isMulti,\n          _r$value = r.value,\n          d = _r$value.key,\n          u = _r$value.value;\n        if (i) {\n          var a = (t = (l = e[d]) == null ? void 0 : l.split(\";\")) != null ? t : [];\n          a.includes(u) ? a = a.filter(function (m) {\n            return m !== u;\n          }) : a.push(u);\n          var p = new Set(a);\n          return e[d] = Array.from(p).join(\";\"), O.pickBy(e, function (m) {\n            return m;\n          });\n        }\n        return e[d] = e[d] === u ? void 0 : u, O.pickBy(e, function (a) {\n          return a;\n        });\n      },\n      b = function b(r, e) {\n        D(r, e);\n      },\n      M = q(function (r, e, l) {\n        var t = F(g);\n        t[r] === \"\" || l === !0 ? t[r] = e : t[r] = \"\", R(t);\n      }, [g]),\n      T = function T(r) {\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : -1;\n        return r ? r.map(function (l, t) {\n          var i, d, u, a, p;\n          if (l.subSelected) return /*#__PURE__*/c.createElement(E, {\n            bordered: !1,\n            expandIcon: C,\n            key: \"collapse_\".concat(t, \"_\").concat(e + 1),\n            onChange: function onChange() {\n              return M(t, l.value);\n            },\n            activeKey: [l.value]\n          }, /*#__PURE__*/c.createElement(ue, {\n            header: /*#__PURE__*/c.createElement(\"div\", {\n              style: {\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                flex: 1\n              }\n            }, /*#__PURE__*/c.createElement(\"span\", null, l.key, /*#__PURE__*/c.createElement(z, {\n              placement: \"bottom\",\n              title: f(\"ClearThisOption\")\n            }, /*#__PURE__*/c.createElement(\"img\", {\n              style: {\n                marginLeft: 5,\n                cursor: \"pointer\"\n              },\n              onClick: function onClick(K) {\n                K.stopPropagation();\n              }\n            })))),\n            key: l.value\n          }, /*#__PURE__*/c.createElement(\"div\", {\n            className: \"level\"\n          }, T(l.subSelected, t))));\n          var m = (o == null ? void 0 : o[e]) ? o == null ? void 0 : o[e].value : 0,\n            h = ((a = (u = (d = (i = v[0]) == null ? void 0 : i.result) == null ? void 0 : d[m]) == null ? void 0 : u.split(\";\")) == null ? void 0 : a.indexOf(l.value)) > -1 ? l.value : \"\";\n          return ((p = o == null ? void 0 : o[e]) == null ? void 0 : p.isMulti) === !0 ? /*#__PURE__*/c.createElement(\"div\", {\n            className: \"singleBar\",\n            key: \"\".concat(m, \"_\").concat(e, \"_\").concat(t)\n          }, /*#__PURE__*/c.createElement(J, {\n            attributeChanged: function attributeChanged() {\n              _(x), b(e, t);\n            },\n            selectedAttribute: [h],\n            list: [{\n              value: l.value,\n              label: l.key\n            }],\n            num: t + 1\n          })) : /*#__PURE__*/c.createElement(\"div\", {\n            className: \"singleBar\",\n            key: \"\".concat(m, \"_\").concat(e, \"_\").concat(t)\n          }, /*#__PURE__*/c.createElement(L, {\n            forbidColor: !0,\n            attributeChanged: function attributeChanged() {\n              return b(e, t);\n            },\n            selectedAttribute: h,\n            list: [{\n              value: l.value,\n              label: l.key\n            }],\n            num: t + 1\n          }));\n        }) : null;\n      };\n    return /*#__PURE__*/c.createElement(\"div\", {\n      className: ee({\n        tagOperationMenu: !0,\n        tagOperationMenuPreview: N\n      }),\n      ref: $\n    }, (o == null ? void 0 : o.length) === 0 ? /*#__PURE__*/c.createElement(\"div\", {\n      style: {\n        padding: 20,\n        textAlign: \"center\"\n      }\n    }, f(\"NoConfiguration\")) : /*#__PURE__*/c.createElement(\"div\", null, T(o)));\n  };\nfunction ie(n) {\n  return {\n    imgList: n.annotation.imgList,\n    tagConfigList: n.annotation.tagConfigList,\n    imgIndex: n.annotation.imgIndex\n  };\n}\nvar de = X(ie)(ce);\nexport { de as default, C as expandIconFuc };","map":null,"metadata":{},"sourceType":"module"}