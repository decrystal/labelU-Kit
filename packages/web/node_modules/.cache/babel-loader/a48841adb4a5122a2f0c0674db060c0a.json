{"ast":null,"code":"import _get from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _regeneratorRuntime from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _assertThisInitialized from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _toArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport _classCallCheck from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _slicedToArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _defineProperty from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _Pe, _zs, _Ws, _js;\n/*!\n* sense-annotation v0.0.8\n* (c) 2020-2023\n* Released under the Apache-2.0 License.\n*/\nimport { polygon as kt, difference as zi, union as Vi } from \"@turf/turf\";\nimport B, { isNumber as Ot, cloneDeep as Wi, isObject as ji } from \"lodash\";\nimport { i18n as _t } from \"@label-u/utils\";\nimport Le from \"color-rgba\";\nvar Xi = 320;\nvar Mt;\n(function (s) {\n  s.PointCloud = \"pointCloudTool\";\n})(Mt || (Mt = {}));\nvar bt;\n(function (s) {\n  s.VideoTextTool = \"videoTextTool\", s.VideoTagTool = \"videoTagTool\", s.VideoClipTool = \"videoClipTool\";\n})(bt || (bt = {}));\nvar Kt;\n(function (s) {\n  s[s.Rect = 0] = \"Rect\", s[s.Tag = 1] = \"Tag\";\n})(Kt || (Kt = {}));\nvar P;\n(function (s) {\n  s.Rect = \"rectTool\", s.Tag = \"tagTool\", s.Point = \"pointTool\", s.PointMarker = \"pointMarkerTool\", s.Segmentation = \"segmentationTool\", s.Filter = \"filterTool\", s.Text = \"textTool\", s.Polygon = \"polygonTool\", s.Line = \"lineTool\", s.LineMarker = \"lineMarkerTool\", s.Empty = \"emptyTool\", s.FolderTag = \"folderTagTool\", s.RectTrack = \"rectTrackTool\", s.Face = \"faceTool\", s.ClientAttribute = \"clientAttributeTool\", s.OCRRelation = \"OCRRelationTool\";\n})(P || (P = {}));\nvar Et;\n(function (s) {\n  s.Check = \"check\";\n})(Et || (Et = {}));\nvar Yt;\n(function (s) {\n  s[s.nothing = 0] = \"nothing\", s[s.RectBG = 1] = \"RectBG\", s[s.showOrder = 2] = \"showOrder\";\n})(Yt || (Yt = {}));\nvar Pe = (_Pe = {}, _defineProperty(_Pe, P.Rect, \"\\u62C9\\u6846\"), _defineProperty(_Pe, P.Tag, \"\\u6807\\u7B7E\\u5206\\u7C7B\"), _defineProperty(_Pe, P.Point, \"\\u6807\\u70B9\"), _defineProperty(_Pe, P.PointMarker, \"\\u5217\\u8868\\u6807\\u70B9\"), _defineProperty(_Pe, P.Segmentation, \"\\u524D\\u666F\\u5206\\u5272\"), _defineProperty(_Pe, P.Filter, \"\\u7B5B\\u9009\"), _defineProperty(_Pe, P.Text, \"\\u6587\\u672C\\u63CF\\u8FF0\"), _defineProperty(_Pe, P.Polygon, \"\\u591A\\u8FB9\\u5F62\"), _defineProperty(_Pe, P.Line, \"\\u6807\\u7EBF\"), _defineProperty(_Pe, P.LineMarker, \"\\u5217\\u8868\\u7EBF\\u6761\"), _defineProperty(_Pe, P.FolderTag, \"\\u6587\\u4EF6\\u5939\\u6807\\u7B7E\"), _defineProperty(_Pe, P.RectTrack, \"\\u62C9\\u6846\\u8DDF\\u8E2A\"), _defineProperty(_Pe, P.Face, \"\\u4EBA\\u8138106\\u5DE5\\u5177\"), _defineProperty(_Pe, P.ClientAttribute, \"\\u5BA2\\u6237\\u7AEF\\u5C5E\\u6027\\u5DE5\\u5177\"), _defineProperty(_Pe, P.OCRRelation, \"OCR\\u5173\\u8054\\u5173\\u7CFB\\u5DE5\\u5177\"), _defineProperty(_Pe, bt.VideoTextTool, \"\\u89C6\\u9891\\u6587\\u672C\"), _defineProperty(_Pe, bt.VideoTagTool, \"\\u89C6\\u9891\\u6807\\u7B7E\"), _defineProperty(_Pe, bt.VideoClipTool, \"\\u89C6\\u9891\\u622A\\u53D6\"), _defineProperty(_Pe, Mt.PointCloud, \"\\u70B9\\u4E91\"), _Pe);\nvar Gt;\n(function (s) {\n  s[s.noDepend = 1] = \"noDepend\", s[s.dependOrigin = 2] = \"dependOrigin\", s[s.dependShape = 3] = \"dependShape\", s[s.dependLine = 4] = \"dependLine\", s[s.dependPolygon = 5] = \"dependPolygon\", s[s.dependPreShape = 101] = \"dependPreShape\", s[s.dependPreLine = 102] = \"dependPreLine\", s[s.dependPrePolygon = 103] = \"dependPrePolygon\";\n})(Gt || (Gt = {}));\nvar vt;\n(function (s) {\n  s.lc = \"leftClick\", s.rc = \"rightClick\", s.clc = \"ctrlLeftClick\", s.crc = \"ctrlRightClick\";\n})(vt || (vt = {}));\nvar Ki = {\n  leftClick: \"\\u9F20\\u6807\\u5DE6\\u952E\",\n  rightClick: \"\\u9F20\\u6807\\u53F3\\u952E\",\n  ctrlLeftClick: \"ctrl + \\u9F20\\u6807\\u5DE6\\u952E\",\n  ctrlRightClick: \"ctrl + \\u9F20\\u6807\\u53F3\\u952E\"\n};\nvar Jt;\n(function (s) {\n  s[s.Normal = 1] = \"Normal\", s[s.Modify = 2] = \"Modify\";\n})(Jt || (Jt = {}));\nvar R;\n(function (s) {\n  s[s.Line = 0] = \"Line\", s[s.Curve = 1] = \"Curve\";\n})(R || (R = {}));\nvar Nt;\n(function (s) {\n  s[s.SingleColor = 0] = \"SingleColor\", s[s.MultiColor = 1] = \"MultiColor\";\n})(Nt || (Nt = {}));\nvar qt;\n(function (s) {\n  s[s.Form = 1] = \"Form\", s[s.Json = 2] = \"Json\";\n})(qt || (qt = {}));\nvar W;\n(function (s) {\n  s[s.Point = 0] = \"Point\", s[s.Line = 1] = \"Line\", s[s.Plane = 2] = \"Plane\";\n})(W || (W = {}));\nvar Qt;\n(function (s) {\n  s[s.None = 0] = \"None\", s[s.Drawing = 1] = \"Drawing\", s[s.Edit = 2] = \"Edit\";\n})(Qt || (Qt = {}));\nvar te;\n(function (s) {\n  s[s.Backward = 0] = \"Backward\", s[s.Forward = 1] = \"Forward\", s[s.JumpSkip = 2] = \"JumpSkip\", s[s.None = 3] = \"None\";\n})(te || (te = {}));\nvar ee;\n(function (s) {\n  s[s.Wait = 0] = \"Wait\", s[s.Pass = 1] = \"Pass\", s[s.Fail = 2] = \"Fail\", s[s.Loading = 3] = \"Loading\";\n})(ee || (ee = {}));\nvar K;\n(function (s) {\n  s[s.AnyString = 0] = \"AnyString\", s[s.Order = 1] = \"Order\", s[s.EnglishOnly = 2] = \"EnglishOnly\", s[s.NumberOnly = 3] = \"NumberOnly\", s[s.CustomFormat = 4] = \"CustomFormat\";\n})(K || (K = {}));\nvar Yi = {\n    0: \"\\u4EFB\\u610F\\u5B57\\u7B26\",\n    1: \"\\u5E8F\\u53F7\",\n    2: \"\\u4EC5\\u82F1\\u6587\",\n    3: \"\\u4EC5\\u6570\\u5B57\"\n  },\n  ie = 1e3,\n  Ce = 16,\n  De = 300,\n  yt = \"normal normal 500 14px Arial\";\nvar se;\n(function (s) {\n  s[s.ImgList = 1e3] = \"ImgList\", s[s.TrackPrediction = 1001] = \"TrackPrediction\", s[s.ImgSearch = 1002] = \"ImgSearch\";\n})(se || (se = {}));\nvar Y = 16,\n  xt = 10;\nvar Q;\n(function (s) {\n  s[s.Normal = 0] = \"Normal\", s[s.Rect = 1] = \"Rect\";\n})(Q || (Q = {}));\nvar Gi = Object.freeze({\n    __proto__: null,\n    editStepWidth: Xi,\n    get EPointCloudName() {\n      return Mt;\n    },\n    get EVideoToolName() {\n      return bt;\n    },\n    get EToolType() {\n      return Kt;\n    },\n    get EToolName() {\n      return P;\n    },\n    get ECheckModel() {\n      return Et;\n    },\n    get ERectPattern() {\n      return Yt;\n    },\n    TOOL_NAME: Pe,\n    get EDependPattern() {\n      return Gt;\n    },\n    get EFilterToolOperation() {\n      return vt;\n    },\n    OPERATION_LIST: Ki,\n    get EAnnotationMode() {\n      return Jt;\n    },\n    get ELineTypes() {\n      return R;\n    },\n    get ELineColor() {\n      return Nt;\n    },\n    get ESelectedType() {\n      return qt;\n    },\n    get EDragTarget() {\n      return W;\n    },\n    get EDrawPointPattern() {\n      return Qt;\n    },\n    get EPageOperator() {\n      return te;\n    },\n    get EAuditStatus() {\n      return ee;\n    },\n    get ETextType() {\n      return K;\n    },\n    TEXT_TYPE: Yi,\n    TEXT_ATTRIBUTE_MAX_LENGTH: ie,\n    TEXT_ATTRIBUTE_LINE_HEIGHT: Ce,\n    DEFAULT_TEXT_MAX_WIDTH: De,\n    DEFAULT_FONT: yt,\n    get EThumbnailOption() {\n      return se;\n    },\n    SEGMENT_NUMBER: Y,\n    edgeAdsorptionScope: xt,\n    get EPolygonPattern() {\n      return Q;\n    }\n  }),\n  Ji = Object.defineProperty,\n  qi = Object.defineProperties,\n  Qi = Object.getOwnPropertyDescriptors,\n  _e = Object.getOwnPropertySymbols,\n  ts = Object.prototype.hasOwnProperty,\n  es = Object.prototype.propertyIsEnumerable,\n  Ae = function Ae(s, t, e) {\n    return t in s ? Ji(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  is = function is(s, t) {\n    for (var e in t || (t = {})) ts.call(t, e) && Ae(s, e, t[e]);\n    if (_e) {\n      var _iterator = _createForOfIteratorHelper(_e(t)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var e = _step.value;\n          es.call(t, e) && Ae(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return s;\n  },\n  ss = function ss(s, t) {\n    return qi(s, Qi(t));\n  };\nfunction re(s) {\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .5;\n  var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n  var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 16;\n  if (s.length < 4) return s;\n  var r = [],\n    n = s.slice(0);\n  var o, a, l, h, c, g, d, u, f, v, b, p, y;\n  for (e ? (n.unshift(s[s.length - 1]), n.unshift(s[s.length - 2]), n.unshift(s[s.length - 1]), n.unshift(s[s.length - 2]), n.push(s[0]), n.push(s[1])) : (n.unshift(s[1]), n.unshift(s[0]), n.push(s[s.length - 2]), n.push(s[s.length - 1])), y = 2; y < n.length - 4; y += 2) for (l = (n[y + 2] - n[y - 2]) * t, h = (n[y + 4] - n[y - 0]) * t, c = (n[y + 3] - n[y - 1]) * t, g = (n[y + 5] - n[y + 1]) * t, p = 0; p <= i; p++) b = p / i, d = 2 * Math.pow(b, 3) - 3 * Math.pow(b, 2) + 1, u = -(2 * Math.pow(b, 3)) + 3 * Math.pow(b, 2), f = Math.pow(b, 3) - 2 * Math.pow(b, 2) + b, v = Math.pow(b, 3) - Math.pow(b, 2), o = d * n[y] + u * n[y + 2] + f * l + v * h, a = d * n[y + 1] + u * n[y + 3] + f * c + v * g, r.push(o), r.push(a);\n  var I = [];\n  for (var _ = 0; _ < r.length - 1; _ += 2) I.push({\n    x: r[_],\n    y: r[_ + 1]\n  });\n  if (e) for (var _2 = 0; _2 < i + 1; _2++) {\n    var A = I.shift();\n    I.push(A);\n  }\n  return I;\n}\nvar Ht = function Ht(s) {\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n  return re(s.reduce(function (e, i) {\n    return [].concat(_toConsumableArray(e), [i.x, i.y]);\n  }, []), .5, !1, t);\n};\nfunction Re(s, t) {\n  var _t2, _t3;\n  var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n  var i = 0,\n    r,\n    n,\n    o,\n    a;\n  t = _toConsumableArray(t), e === R.Curve && (t = re(t.reduce(function (h, c) {\n    return [].concat(_toConsumableArray(h), [c.x, c.y]);\n  }, []), .5, !0, Y)), (_t2 = t, _t3 = _slicedToArray(_t2, 1), o = _t3[0]);\n  var l = t.length;\n  for (r = 1; r <= l; r++) a = t[r % l], s.x > Math.min(o.x, a.x) && s.x <= Math.max(o.x, a.x) && s.y <= Math.max(o.y, a.y) && o.x !== a.x && (n = (s.x - o.x) * (a.y - o.y) / (a.x - o.x) + o.y, (o.y === a.y || s.y <= n) && i++), o = a;\n  return i % 2 != 0;\n}\nfunction Te(s) {\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  return s.map(function (e) {\n    return ss(is({}, e), {\n      x: e.x * t,\n      y: e.y * t\n    });\n  });\n}\nvar Se = Math.pow;\nvar mt = /*#__PURE__*/function () {\n  function mt() {\n    _classCallCheck(this, mt);\n  }\n  _createClass(mt, null, [{\n    key: \"add\",\n    value: function add(t, e) {\n      return {\n        x: t.x + e.x,\n        y: t.y + e.y\n      };\n    }\n  }, {\n    key: \"getVector\",\n    value: function getVector(t, e) {\n      return {\n        x: e.x - t.x,\n        y: e.y - t.y\n      };\n    }\n  }, {\n    key: \"len\",\n    value: function len(t) {\n      return Math.sqrt(Se(t.x, 2) + Se(t.y, 2));\n    }\n  }, {\n    key: \"dotProduct\",\n    value: function dotProduct(t, e) {\n      return t.x * e.x + t.y + e.y;\n    }\n  }]);\n  return mt;\n}();\nvar ke = /*#__PURE__*/function () {\n  function ke() {\n    _classCallCheck(this, ke);\n  }\n  _createClass(ke, null, [{\n    key: \"tanAPlusB\",\n    value: function tanAPlusB(t, e) {\n      return (t + e) / (1 - t * e);\n    }\n  }, {\n    key: \"sinAPlusB\",\n    value: function sinAPlusB(t, e, i, r) {\n      return r * t + e * i;\n    }\n  }, {\n    key: \"cosAPlusB\",\n    value: function cosAPlusB(t, e, i, r) {\n      return e * r - t * i;\n    }\n  }]);\n  return ke;\n}();\nvar wt = /*#__PURE__*/function () {\n  function wt() {\n    _classCallCheck(this, wt);\n  }\n  _createClass(wt, null, [{\n    key: \"getRotate\",\n    value: function getRotate(s) {\n      return s + 90 >= 360 ? s + 90 - 360 : s + 90;\n    }\n  }, {\n    key: \"getLineLength\",\n    value: function getLineLength(s, t) {\n      return Math.sqrt(Math.pow(t.y - s.y, 2) + Math.pow(t.x - s.x, 2));\n    }\n  }, {\n    key: \"getTextArea\",\n    value: function getTextArea(s, t) {\n      var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : De;\n      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : yt;\n      var r = arguments.length > 4 ? arguments[4] : undefined;\n      if (typeof t != \"string\") return {\n        width: 0,\n        height: 0\n      };\n      var n = s.getContext(\"2d\");\n      n.font = i;\n      var o = 0;\n      typeof r == \"undefined\" && typeof window != \"undefined\" && (r = s && parseInt(window.getComputedStyle(s).lineHeight, 10) || parseInt(window.getComputedStyle(document.body).lineHeight, 10));\n      var a = 0;\n      typeof window != \"undefined\" && (a = s && parseInt(window.getComputedStyle(s).fontSize, 10) || parseInt(window.getComputedStyle(document.body).fontSize, 10) || 0);\n      var l = t.split(\"\\n\");\n      var h = 0;\n      for (var c = 0; c < l.length; c++) {\n        var g = l[c].split(\"\");\n        var d = \"\";\n        for (var u = 0; u < g.length; u++) {\n          var f = d + g[u],\n            b = n.measureText(f).width;\n          b > e && u > 0 ? (d = g[u], o += r, h = e) : (d = f, b > h && (h = b));\n        }\n        c !== l.length - 1 && (o += r);\n      }\n      return {\n        width: h,\n        height: o + a,\n        lineHeight: r,\n        fontHeight: a\n      };\n    }\n  }, {\n    key: \"getLineCenterPoint\",\n    value: function getLineCenterPoint(s) {\n      var _s2 = _slicedToArray(s, 2),\n        t = _s2[0],\n        e = _s2[1],\n        i = mt.getVector(t, e);\n      return {\n        x: t.x + i.x / 2,\n        y: t.y + i.y / 2\n      };\n    }\n  }, {\n    key: \"getPerpendicularLine\",\n    value: function getPerpendicularLine(s) {\n      if (s.length !== 2) return;\n      var _s3 = _slicedToArray(s, 2),\n        t = _s3[0],\n        e = _s3[1],\n        i = {\n          x: e.x + e.y - t.y,\n          y: e.y - (e.x - t.x)\n        };\n      return [e, i];\n    }\n  }, {\n    key: \"getPerpendicularFootOfLine\",\n    value: function getPerpendicularFootOfLine(s, t) {\n      if (s.length !== 2) return s;\n      var e = this.getPerpendicularLine(s);\n      if (!e) return s;\n      var _e2 = _slicedToArray(e, 2),\n        i = _e2[0],\n        r = _e2[1];\n      return this.getFootOfPerpendicular(t, i, r).footPoint;\n    }\n  }, {\n    key: \"getQuadrangleFromTriangle\",\n    value: function getQuadrangleFromTriangle(s) {\n      if (s.length !== 3) return s;\n      var _s4 = _slicedToArray(s, 3),\n        t = _s4[0],\n        e = _s4[1],\n        i = _s4[2],\n        r = {\n          x: i.x + t.x - e.x,\n          y: i.y + t.y - e.y\n        };\n      return [t, e, i, r];\n    }\n  }, {\n    key: \"getRectPerpendicularOffset\",\n    value: function getRectPerpendicularOffset(s, t, e) {\n      var _e3 = _slicedToArray(e, 2),\n        i = _e3[0],\n        r = _e3[1],\n        n = this.getFootOfPerpendicular(s, i, r).footPoint,\n        o = this.getFootOfPerpendicular(t, i, r).footPoint,\n        a = {\n          x: n.x - o.x,\n          y: n.y - o.y\n        },\n        l = mt.add(t, a);\n      return mt.getVector(s, l);\n    }\n  }, {\n    key: \"getArrayIndex\",\n    value: function getArrayIndex(s, t) {\n      return s < 0 ? t + s : s >= t ? s - t : s;\n    }\n  }, {\n    key: \"getPointListFromPointOffset\",\n    value: function getPointListFromPointOffset(s, t, e) {\n      var i = this.getArrayIndex(t - 1, s.length),\n        r = this.getArrayIndex(t + 1, s.length),\n        n = this.getArrayIndex(t - 2, s.length),\n        o = _toConsumableArray(s);\n      o[t] = mt.add(o[t], e);\n      var a = this.getFootOfPerpendicular(o[t], o[n], o[i]).footPoint,\n        l = this.getFootOfPerpendicular(o[t], o[r], o[n]).footPoint;\n      return o[i] = a, o[r] = l, o;\n    }\n  }, {\n    key: \"getRectCenterPoint\",\n    value: function getRectCenterPoint(s) {\n      var _s5 = _slicedToArray(s, 3),\n        t = _s5[0],\n        e = _s5[2];\n      return {\n        x: (t.x + e.x) / 2,\n        y: (t.y + e.y) / 2\n      };\n    }\n  }, {\n    key: \"rotateRectPointList\",\n    value: function rotateRectPointList() {\n      var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 5;\n      var t = arguments.length > 1 ? arguments[1] : undefined;\n      var e = this.getRectCenterPoint(t),\n        i = Math.PI,\n        r = Math.sin(s * i / 180),\n        n = Math.cos(s * i / 180);\n      return t.map(function (o) {\n        var a = mt.getVector(e, o),\n          l = mt.len(a),\n          h = a.y / l,\n          c = a.x / l;\n        return {\n          x: l * ke.cosAPlusB(h, c, r, n) + e.x,\n          y: l * ke.sinAPlusB(h, c, r, n) + e.y\n        };\n      });\n    }\n  }, {\n    key: \"getRectangleByRightAngle\",\n    value: function getRectangleByRightAngle(s, t) {\n      if (t.length !== 2) return t;\n      var e = wt.getPerpendicularFootOfLine(t, s);\n      return wt.getQuadrangleFromTriangle([].concat(_toConsumableArray(t), [e]));\n    }\n  }]);\n  return wt;\n}();\nvar L = wt;\nL.isInRange = function (s, t) {\n  var e = Math.min.apply(Math, _toConsumableArray(t)),\n    i = Math.max.apply(Math, _toConsumableArray(t)),\n    r = function r(o) {\n      return o <= i && o >= e;\n    };\n  return (Array.isArray(s) ? s : [s]).every(function (o) {\n    return r(o);\n  });\n}, L.withinRange = function (s, t) {\n  var e = Math.min.apply(Math, _toConsumableArray(t)),\n    i = Math.max.apply(Math, _toConsumableArray(t));\n  return s > i ? i : s < e ? e : s;\n}, L.calcViewportBoundaries = function (s) {\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n  var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : Y;\n  var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n  if (!s) return {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0\n  };\n  var r = 20 / i,\n    n = [],\n    o = [];\n  var a = s;\n  t && (a = Ht(s, e)), a.forEach(function (_ref) {\n    var f = _ref.x,\n      v = _ref.y;\n    n.push(f), o.push(v);\n  });\n  var l = Math.min.apply(Math, n),\n    h = Math.max.apply(Math, n),\n    c = Math.min.apply(Math, o),\n    g = Math.max.apply(Math, o);\n  var d = h - l,\n    u = g - c;\n  if (d < r) {\n    var f = (r - d) / 2;\n    l -= f, h += f;\n  }\n  if (u < r) {\n    var _f = (r - u) / 2;\n    c -= _f, g += _f;\n  }\n  return {\n    top: c,\n    bottom: g,\n    left: l,\n    right: h\n  };\n}, L.getFootOfPerpendicular = function (s, t, e) {\n  var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;\n  var r = {\n    x: 0,\n    y: 0\n  };\n  var n = t.x - e.x,\n    o = t.y - e.y;\n  if (Math.abs(n) < 1e-8 && Math.abs(o) < 1e-8) return r = t, r;\n  var a = (s.x - t.x) * (t.x - e.x) + (s.y - t.y) * (t.y - e.y);\n  a /= n * n + o * o, r.x = t.x + a * n, r.y = t.y + a * o;\n  var l = wt.getLineLength(s, r),\n    h = 2,\n    c = Math.min(t.x, e.x),\n    g = Math.max(t.x, e.x),\n    d = Math.min(t.y, e.y),\n    u = Math.max(t.y, e.y),\n    f = !(wt.isInRange(s.x, [c, g]) || wt.isInRange(s.y, [d, u])),\n    v = s.x > g + h || s.x < c - h || s.y > u + h || s.y < d - h;\n  return (i ? f : v) ? {\n    footPoint: r,\n    length: Infinity\n  } : {\n    footPoint: r,\n    length: l\n  };\n};\nvar rs = 61,\n  ns = 40,\n  os = 40,\n  as = 240;\nvar At;\n(function (s) {\n  s[s.ANNOTATION = 1] = \"ANNOTATION\", s[s.QUALITY_INSPECTION = 2] = \"QUALITY_INSPECTION\", s[s.PRE_ANNOTATION = 3] = \"PRE_ANNOTATION\", s[s.MANUAL_CORRECTION = 4] = \"MANUAL_CORRECTION\";\n})(At || (At = {}));\nvar ls = 1e3;\nvar ne;\n(function (s) {\n  s[s.Backward = 0] = \"Backward\", s[s.Forward = 1] = \"Forward\", s[s.JumpSkip = 2] = \"JumpSkip\", s[s.None = 3] = \"None\";\n})(ne || (ne = {}));\nvar O;\n(function (s) {\n  s[s.Start = 0] = \"Start\", s[s.Stop = 1] = \"Stop\", s[s.Wait = 2] = \"Wait\", s[s.Move = 3] = \"Move\";\n})(O || (O = {}));\nvar q;\n(function (s) {\n  s[s.Point = 0] = \"Point\", s[s.Line = 1] = \"Line\", s[s.Plane = 2] = \"Plane\";\n})(q || (q = {}));\nvar G;\n(function (s) {\n  s[s.ascend = 0] = \"ascend\", s[s.descend = 1] = \"descend\";\n})(G || (G = {}));\nvar It;\n(function (s) {\n  s[s.Intelligence = 0] = \"Intelligence\", s[s.Linear = 1] = \"Linear\";\n})(It || (It = {}));\nvar ht;\n(function (s) {\n  s.Zh = \"zh_CN\", s.US = \"en_US\";\n})(ht || (ht = {}));\nvar Rt;\n(function (s) {\n  s[s.Clockwise = 0] = \"Clockwise\", s[s.Anticlockwise = 1] = \"Anticlockwise\";\n})(Rt || (Rt = {}));\nvar Z = {\n    offsetX: -10,\n    offsetY: -10\n  },\n  Bt = {\n    shadowColor: \"rgba(0,0,0,0.6)\",\n    shadowOffsetX: 0,\n    shadowOffsetY: 2,\n    shadowBlur: 4\n  },\n  ot = {\n    x: 8,\n    y: 26\n  };\nvar hs = Object.freeze({\n    __proto__: null,\n    headerHeight: rs,\n    tipsHeight: ns,\n    footerHeight: os,\n    sidebarWidth: as,\n    get EStepType() {\n      return At;\n    },\n    ANNOTATION_MAX_SIZE: ls,\n    get EPageOperator() {\n      return ne;\n    },\n    get EDragStatus() {\n      return O;\n    },\n    get EDragTarget() {\n      return q;\n    },\n    get ESortDirection() {\n      return G;\n    },\n    get EGrowthMode() {\n      return It;\n    },\n    get ELang() {\n      return ht;\n    },\n    get ERotateDirection() {\n      return Rt;\n    },\n    DEFAULT_TEXT_OFFSET: Z,\n    DEFAULT_TEXT_SHADOW: Bt,\n    TEXT_ATTRIBUTE_OFFSET: ot\n  }),\n  cs = Object.defineProperty,\n  ds = Object.defineProperties,\n  us = Object.getOwnPropertyDescriptors,\n  Oe = Object.getOwnPropertySymbols,\n  gs = Object.prototype.hasOwnProperty,\n  fs = Object.prototype.propertyIsEnumerable,\n  Me = function Me(s, t, e) {\n    return t in s ? cs(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  ct = function ct(s, t) {\n    for (var e in t || (t = {})) gs.call(t, e) && Me(s, e, t[e]);\n    if (Oe) {\n      var _iterator2 = _createForOfIteratorHelper(Oe(t)),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var e = _step2.value;\n          fs.call(t, e) && Me(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n    return s;\n  },\n  dt = function dt(s, t) {\n    return ds(s, us(t));\n  };\nvar U = /*#__PURE__*/function () {\n  function U() {\n    _classCallCheck(this, U);\n  }\n  _createClass(U, null, [{\n    key: \"composeResult\",\n    value: function composeResult(t, e, i, r, n) {\n      try {\n        var o = JSON.parse(t),\n          a = x.getCurrentStepInfo(e, r),\n          l = a.dataSourceStep,\n          h = \"step_\".concat(a.step);\n        if (Object.assign(o, n), o[h]) {\n          var c = o[h];\n          return c.result ? (c.result = i, JSON.stringify(o)) : JSON.stringify(dt(ct({}, o), _defineProperty({}, h, dt(ct({}, o[h]), {\n            result: i\n          }))));\n        }\n        return JSON.stringify(dt(ct({}, o), _defineProperty({}, h, {\n          dataSourceStep: l,\n          toolName: a.tool,\n          result: i\n        })));\n      } catch (o) {\n        return t;\n      }\n    }\n  }, {\n    key: \"changeCoordinateByRotate\",\n    value: function changeCoordinateByRotate(t, e, i) {\n      var r = t.x,\n        n = t.y,\n        o = t.width,\n        a = t.height,\n        l = w.changeCoordinateByRotate({\n          x: r,\n          y: n\n        }, e, i);\n      switch (e % 360) {\n        case 90:\n          return dt(ct({}, t), {\n            x: l.x - a,\n            y: l.y,\n            width: a,\n            height: o\n          });\n        case 180:\n          return dt(ct({}, t), {\n            x: l.x - o,\n            y: l.y - a\n          });\n        case 270:\n          return dt(ct({}, t), {\n            x: l.x,\n            y: l.y - o,\n            width: a,\n            height: o\n          });\n        default:\n          return t;\n      }\n    }\n  }, {\n    key: \"translateRect2Points\",\n    value: function translateRect2Points(t) {\n      var e = t.x,\n        i = t.y,\n        r = t.width,\n        n = t.height;\n      return [{\n        x: e,\n        y: i\n      }, {\n        x: e + r,\n        y: i\n      }, {\n        x: e + r,\n        y: i + n\n      }, {\n        x: e,\n        y: i + n\n      }];\n    }\n  }, {\n    key: \"translatePoints2Rect\",\n    value: function translatePoints2Rect(t, e) {\n      if (t.length !== 4) return;\n      var _t$ = t[0],\n        i = _t$.x,\n        r = _t$.y,\n        n = t[1].x - t[0].x,\n        o = t[2].y - t[1].y;\n      return dt(ct({}, e), {\n        x: i,\n        y: r,\n        width: n,\n        height: o\n      });\n    }\n  }, {\n    key: \"getRectPointList\",\n    value: function getRectPointList(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      return [{\n        x: t.x * e,\n        y: t.y * e\n      }, {\n        x: (t.x + t.width) * e,\n        y: t.y * e\n      }, {\n        x: (t.x + t.width) * e,\n        y: (t.y + t.height) * e\n      }, {\n        x: t.x * e,\n        y: (t.y + t.height) * e\n      }];\n    }\n  }, {\n    key: \"getRectEdgeList\",\n    value: function getRectEdgeList(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var i = this.getRectPointList(t, e),\n        r = i.length;\n      return i.map(function (n, o) {\n        return {\n          begin: n,\n          end: i[(o + 1) % r]\n        };\n      });\n    }\n  }, {\n    key: \"isInRect\",\n    value: function isInRect(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n      return t.x >= e.x * r - i && t.x <= (e.x + e.width) * r + i && t.y >= e.y * r - i && t.y <= (e.y + e.height) * r + i;\n    }\n  }, {\n    key: \"getRectUnderZoom\",\n    value: function getRectUnderZoom(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var i = t.x,\n        r = t.y,\n        n = t.width,\n        o = t.height;\n      return dt(ct({}, t), {\n        x: i * e,\n        y: r * e,\n        width: n * e,\n        height: o * e\n      });\n    }\n  }, {\n    key: \"isRectNotInPolygon\",\n    value: function isRectNotInPolygon(t, e) {\n      return this.getRectPointList(t).some(function (r) {\n        return !Re(r, e);\n      });\n    }\n  }]);\n  return U;\n}();\nfunction J() {\n  var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 8;\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 62;\n  var e = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\".split(\"\"),\n    i = [];\n  var r;\n  if (t = t || e.length, s) for (r = 0; r < s; r++) i[r] = e[0 | Math.random() * t];else {\n    var n;\n    for (i[8] = i[13] = i[18] = i[23] = \"-\", i[14] = \"4\", r = 0; r < 36; r++) i[r] || (n = 0 | Math.random() * 16, i[r] = e[r === 19 ? n & 3 | 8 : n]);\n  }\n  return i.join(\"\");\n}\nvar vs = Object.defineProperty,\n  Ee = Object.getOwnPropertySymbols,\n  ps = Object.prototype.hasOwnProperty,\n  bs = Object.prototype.propertyIsEnumerable,\n  Ne = function Ne(s, t, e) {\n    return t in s ? vs(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  He = function He(s, t) {\n    for (var e in t || (t = {})) ps.call(t, e) && Ne(s, e, t[e]);\n    if (Ee) {\n      var _iterator3 = _createForOfIteratorHelper(Ee(t)),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var e = _step3.value;\n          bs.call(t, e) && Ne(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    }\n    return s;\n  };\nvar Lt = /*#__PURE__*/function () {\n  function Lt() {\n    _classCallCheck(this, Lt);\n  }\n  _createClass(Lt, null, [{\n    key: \"getTagKeyName\",\n    value: function getTagKeyName(t, e) {\n      var i, r;\n      if (!!e) return (r = (i = e.find(function (n) {\n        return n.value === t;\n      })) == null ? void 0 : i.key) != null ? r : \"\";\n    }\n  }, {\n    key: \"getTagName\",\n    value: function getTagName(_ref2, i) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n        _ref3$ = _ref3[0],\n        t = _ref3$ === void 0 ? \"\" : _ref3$,\n        _ref3$2 = _ref3[1],\n        e = _ref3$2 === void 0 ? \"\" : _ref3$2;\n      if (!!i) {\n        var _iterator4 = _createForOfIteratorHelper(i),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var r = _step4.value;\n            if (r.value === t) {\n              if (!r.subSelected) return console.error(\"\\u6807\\u7B7E\\u89E3\\u6790\\u9519\\u8BEF\", t, e), \"\";\n              var _iterator5 = _createForOfIteratorHelper(r.subSelected),\n                _step5;\n              try {\n                for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n                  var n = _step5.value;\n                  if (n.value === e) return n.key;\n                }\n              } catch (err) {\n                _iterator5.e(err);\n              } finally {\n                _iterator5.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    }\n  }, {\n    key: \"getTagNameList\",\n    value: function getTagNameList(t, e) {\n      var _this = this;\n      return Object.keys(t).length <= 0 ? [] : Object.entries(t).reduce(function (i, r) {\n        var _r2 = _slicedToArray(r, 2),\n          n = _r2[0],\n          o = _r2[1];\n        if (o && o.length > 0) {\n          var a = o.split(\";\"),\n            l = {\n              keyName: _this.getTagKeyName(n, e),\n              value: a.map(function (h) {\n                return _this.getTagName([n, h], e);\n              })\n            };\n          return [].concat(_toConsumableArray(i), [l]);\n        }\n        return i;\n      }, []).filter(function (i) {\n        return i;\n      });\n    }\n  }, {\n    key: \"getTagnameListWithoutConfig\",\n    value: function getTagnameListWithoutConfig(t) {\n      return Object.keys(t).length <= 0 ? [] : Object.entries(t).reduce(function (e, i) {\n        var _i2 = _slicedToArray(i, 2),\n          r = _i2[0],\n          n = _i2[1],\n          o = n.split(\";\"),\n          a = {\n            keyName: r,\n            value: o\n          };\n        return [].concat(_toConsumableArray(e), [a]);\n      }, []).filter(function (e) {\n        return e;\n      });\n    }\n  }, {\n    key: \"judgeResultIsInInputList\",\n    value: function judgeResultIsInInputList(t, e, i) {\n      return !t || !e || !i ? !1 : i.filter(function (n) {\n        if (n.value === t && n.subSelected) {\n          var o = e == null ? void 0 : e.split(\";\");\n          return (n == null ? void 0 : n.subSelected.filter(function (a) {\n            return o.indexOf(a.value) > -1;\n          }).length) > 0;\n        }\n        return !1;\n      }).length > 0;\n    }\n  }, {\n    key: \"getDefaultResultByConfig\",\n    value: function getDefaultResultByConfig(t) {\n      return t.reduce(function (e, i) {\n        return i.subSelected && i.subSelected.forEach(function (r) {\n          var n;\n          if (r.isDefault) {\n            var o = (n = e[i.value]) != null ? n : \"\";\n            var a = [];\n            o.length > 0 && (a = o.split(\";\")), a.push(r.value), e[i.value] = a.join(\";\");\n          }\n        }), e;\n      }, {});\n    }\n  }, {\n    key: \"getDefaultTagResult\",\n    value: function getDefaultTagResult(t, e) {\n      var i = this.getDefaultResultByConfig(t);\n      return e.length > 0 ? e.map(function (r) {\n        return {\n          id: J(),\n          sourceID: r.id,\n          result: He({}, i)\n        };\n      }) : [{\n        id: J(),\n        sourceID: \"\",\n        result: He({}, i)\n      }];\n    }\n  }]);\n  return Lt;\n}();\nvar Be = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#ccc\"/></g></g></svg>',\n  ys = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#ff2323\"/></g></g></svg>',\n  xs = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#ffe232\"/></g></g></svg>',\n  ms = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#01ff30\"/></g></g></svg>',\n  ws = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#00ffea\"/></g></g></svg>',\n  Is = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#0282fa\"/></g></g></svg>',\n  Ls = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#800cf9\"/></g></g></svg>',\n  Ps = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#ff88f7\"/></g></g></svg>',\n  Cs = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#994217\"/></g></g></svg>',\n  Ds = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#1f0bf9\"/></g></g></svg>',\n  _s = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#3fe\"/></g></g></svg>',\n  As = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#33fe33\"/></g></g></svg>',\n  Rs = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#fdff37\"/></g></g></svg>',\n  Ts = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#f70efa\"/></g></g></svg>',\n  $e = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><defs><clipPath id=\"a\"><path d=\"M0,0H16V-16H0Z\" fill=\"none\"/></clipPath><clipPath id=\"b\"><path d=\"M13.75-2.937H2.25a.5.5,0,0,0-.5.5v.563a.125.125,0,0,0,.125.125h12.25a.125.125,0,0,0,.125-.125v-.562A.5.5,0,0,0,13.75-2.937ZM4.027-4.25a.632.632,0,0,0,.094-.008l2.628-.461a.153.153,0,0,0,.083-.044l6.623-6.623a.156.156,0,0,0,0-.22l-2.6-2.6a.155.155,0,0,0-.111-.045.155.155,0,0,0-.111.045L4.012-7.581a.159.159,0,0,0-.044.083L3.508-4.87a.524.524,0,0,0,.147.466.529.529,0,0,0,.372.155Z\" fill=\"none\"/></clipPath></defs><g transform=\"translate(0 16)\"><g clip-path=\"url(#a)\"><path d=\"M-5-21H21V5H-5Z\" fill=\"rgba(0,0,0,0)\"/></g><g clip-path=\"url(#b)\"><path d=\"M-3.25-19.25h22.5V3.25H-3.25Z\" fill=\"#f33\"/></g></g></svg>';\nvar Fe = Be,\n  Ss = 61,\n  ks = 80,\n  Os = 62,\n  Ms = 20,\n  Es = 55,\n  Ns = 55,\n  Hs = 40,\n  Bs = 80,\n  $s = 240,\n  Fs = 320,\n  Zs = \"rgba(102, 111, 255, 1)\",\n  $t = \"rgba(204, 204, 204, 1)\",\n  pt = [$t, \"rgba(153, 51, 255, 1)\", \"rgba(51, 254, 51, 1)\", \"rgba(255, 51, 255, 1)\", \"rgba(204, 255, 51, 1)\", \"rgba(51, 153, 255, 1)\", \"rgba(255, 153, 51, 1)\", \"rgba(51, 255, 238, 1)\", \"rgba(255, 221, 51, 1)\"],\n  Ft = [Be, Ls, ms, Ps, xs, Cs, Is, ys, ws],\n  Ze = {\n    1: Ds,\n    3: _s,\n    5: As,\n    7: Rs,\n    9: Ts\n  },\n  Us = \"rgba(255, 51, 51, 1)\",\n  zs = (_zs = {}, _defineProperty(_zs, vt.lc, \"rgba(153, 51, 255, 1)\"), _defineProperty(_zs, vt.rc, \"rgba(51, 153, 255, 1)\"), _defineProperty(_zs, vt.clc, \"rgba(46, 230, 46, 1)\"), _defineProperty(_zs, vt.crc, \"rgba(255, 51, 51, 1)\"), _zs);\nvar Vs = Object.freeze({\n    __proto__: null,\n    HEADER_HEIGHT: Ss,\n    TAB_HEIGHT: ks,\n    SEARCH_HEIGHT: Os,\n    PADDING: Ms,\n    TABLE_ROW_HEIGHT: Es,\n    PAGINATION_HEIGHT: Ns,\n    TIPS_HEIGHT: Hs,\n    FOOTER_HEIGHT: Bs,\n    SIDERBAR_WIDTH: $s,\n    EDIT_STEP_WIDTH: Fs,\n    THEME_COLOR: Zs,\n    NULL_COLOR: $t,\n    COLORS_ARRAY: pt,\n    ICON_ARRAY: Ft,\n    BASE_ICON: Ze,\n    INVALID_COLOR: Us,\n    NULL_ICON: Fe,\n    INVALID_ICON: $e,\n    FILTER_TOOL_COLOR: zs\n  }),\n  C;\n(function (s) {\n  s.NoRotateNotice = \"noRotateNotice\", s.RectErrorSizeNotice = \"rectErrorSizeNotice\", s.TextCheckNumberErrorNotice = \"textCheckNumberErrorNotice\", s.TextCheckEnglishErrorNotice = \"textCheckEnglishErrorNotice\", s.TextCheckCustomErrorNotice = \"textCheckCustomErrorNotice\", s.UpperLimitErrorNotice = \"UpperLimitErrorNotice\", s.LowerLimitErrorNotice = \"LowerLimitErrorNotice\", s.InvalidImage = \"InvalidImage\", s.DisableDelete = \"DisableDelete\", s.ClearPartialData = \"ClearPartialData\", s.MarkerFinish = \"MarkerFinish\", s.LowerLimitPoint = \"LowerLimitPoint\", s.NoRotateInDependence = \"noRotateInDependence\", s.UnableToReannotation = \"unableToReannotation\", s.ForbiddenCreationOutsideBoundary = \"ForbiddenCreationOutsideBoundary\", s.SuccessfulEdgeAdsorption = \"SuccessfulEdgeAdsorption\";\n})(C || (C = {}));\nvar Ws = (_Ws = {}, _defineProperty(_Ws, C.NoRotateNotice, \"This Image contains data and cannot be rotated\"), _defineProperty(_Ws, C.RectErrorSizeNotice, \"The drawing frame size is smaller than the minimum drawing size\"), _defineProperty(_Ws, C.TextCheckNumberErrorNotice, \"Please enter in number-only format\"), _defineProperty(_Ws, C.TextCheckEnglishErrorNotice, \"Please enter in English only format\"), _defineProperty(_Ws, C.TextCheckCustomErrorNotice, \"Please enter in the required format\"), _defineProperty(_Ws, C.UpperLimitErrorNotice, \"The number of vertices is not more than\"), _defineProperty(_Ws, C.LowerLimitErrorNotice, \"The number of vertices is not less than\"), _defineProperty(_Ws, C.InvalidImage, \"Invalid image, please skip this image\"), _defineProperty(_Ws, C.DisableDelete, \"Disable delete\"), _defineProperty(_Ws, C.ClearPartialData, \"Clear partial data\"), _defineProperty(_Ws, C.MarkerFinish, \"ListAnnotation is finished\"), _defineProperty(_Ws, C.LowerLimitPoint, \"The maximum number of points has been reached\"), _defineProperty(_Ws, C.NoRotateInDependence, \"Disallow rotation in dependent cases\"), _defineProperty(_Ws, C.UnableToReannotation, \"Unabled to reannotation\"), _defineProperty(_Ws, C.ForbiddenCreationOutsideBoundary, \"Fobid creation outside boundary\"), _defineProperty(_Ws, C.SuccessfulEdgeAdsorption, \"Successful edge adsorption\"), _Ws),\n  js = (_js = {}, _defineProperty(_js, C.NoRotateNotice, \"\\u672C\\u56FE\\u542B\\u6709\\u6570\\u636E\\uFF0C\\u65E0\\u6CD5\\u8FDB\\u884C\\u65CB\\u8F6C\"), _defineProperty(_js, C.RectErrorSizeNotice, \"\\u7ED8\\u5236\\u6846\\u5C3A\\u5BF8\\u5C0F\\u4E8E\\u6700\\u5C0F\\u7ED8\\u5236\\u5C3A\\u5BF8\"), _defineProperty(_js, C.TextCheckNumberErrorNotice, \"\\u8BF7\\u6309\\u4EC5\\u6570\\u5B57\\u7684\\u683C\\u5F0F\\u8F93\\u5165\"), _defineProperty(_js, C.TextCheckEnglishErrorNotice, \"\\u8BF7\\u6309\\u4EC5\\u82F1\\u6587\\u7684\\u683C\\u5F0F\\u8F93\\u5165\"), _defineProperty(_js, C.TextCheckCustomErrorNotice, \"\\u8BF7\\u6309\\u8981\\u6C42\\u7684\\u683C\\u5F0F\\u8F93\\u5165\"), _defineProperty(_js, C.UpperLimitErrorNotice, \"\\u9876\\u70B9\\u6570\\u4E0D\\u591A\\u4E8E\"), _defineProperty(_js, C.LowerLimitErrorNotice, \"\\u9876\\u70B9\\u6570\\u4E0D\\u5C11\\u4E8E\"), _defineProperty(_js, C.InvalidImage, \"\\u65E0\\u6548\\u56FE\\u7247\\uFF0C\\u8BF7\\u8DF3\\u8FC7\\u6B64\\u56FE\"), _defineProperty(_js, C.DisableDelete, \"\\u8BE5\\u6570\\u636E\\u7981\\u6B62\\u5220\\u9664\"), _defineProperty(_js, C.ClearPartialData, \"\\u5B58\\u5728\\u90E8\\u5206\\u6570\\u636E\\u65E0\\u6CD5\\u6E05\\u9664\"), _defineProperty(_js, C.MarkerFinish, \"\\u5217\\u8868\\u6807\\u6CE8\\u5DF2\\u5B8C\\u6210\"), _defineProperty(_js, C.LowerLimitPoint, \"\\u5DF2\\u5230\\u8FBE\\u6807\\u70B9\\u6570\\u91CF\\u4E0A\\u9650\"), _defineProperty(_js, C.NoRotateInDependence, \"\\u4F9D\\u8D56\\u60C5\\u51B5\\u4E0B\\u65E0\\u6CD5\\u8FDB\\u884C\\u65CB\\u8F6C\"), _defineProperty(_js, C.UnableToReannotation, \"\\u65E0\\u6CD5\\u8FDB\\u884C\\u7EED\\u6807\\u64CD\\u4F5C\"), _defineProperty(_js, C.ForbiddenCreationOutsideBoundary, \"\\u8FB9\\u754C\\u5916\\u7981\\u6B62\\u521B\\u5EFA\"), _defineProperty(_js, C.SuccessfulEdgeAdsorption, \"\\u8FB9\\u7F18\\u5438\\u9644\\u6210\\u529F\"), _js);\nvar H = /*#__PURE__*/_createClass(function H() {\n  _classCallCheck(this, H);\n});\nH.getMessagesByLocale = function (s, t) {\n  switch (t) {\n    case ht.US:\n      return Ws[s];\n    case ht.Zh:\n    default:\n      return js[s];\n  }\n};\nvar Xs = Object.defineProperty,\n  Ks = Object.defineProperties,\n  Ys = Object.getOwnPropertyDescriptors,\n  Ue = Object.getOwnPropertySymbols,\n  Gs = Object.prototype.hasOwnProperty,\n  Js = Object.prototype.propertyIsEnumerable,\n  ze = function ze(s, t, e) {\n    return t in s ? Xs(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Ve = function Ve(s, t) {\n    for (var e in t || (t = {})) Gs.call(t, e) && ze(s, e, t[e]);\n    if (Ue) {\n      var _iterator6 = _createForOfIteratorHelper(Ue(t)),\n        _step6;\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var e = _step6.value;\n          Js.call(t, e) && ze(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n    }\n    return s;\n  },\n  We = function We(s, t) {\n    return Ks(s, Ys(t));\n  };\nvar qs = \"^[0-9]+$\",\n  Qs = \"^[A-Za-z]+$\";\nvar T = /*#__PURE__*/function () {\n  function T() {\n    _classCallCheck(this, T);\n  }\n  _createClass(T, null, [{\n    key: \"getAttributeIcon\",\n    value: function getAttributeIcon(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;\n      var r;\n      var n = e.findIndex(function (l) {\n        return l.value === t;\n      });\n      var o = (r = Ft[n % Ft.length]) != null ? r : Fe;\n      i || (o = $e), o = \"\";\n      var a;\n      if (typeof Image != \"undefined\") return a = new Image(), a.src = o, a;\n    }\n  }, {\n    key: \"checkString\",\n    value: function checkString(t, e) {\n      var i = \"\";\n      switch (t) {\n        case K.Order:\n        case K.NumberOnly:\n          i = qs;\n          break;\n        case K.EnglishOnly:\n          i = Qs;\n          break;\n        case K.CustomFormat:\n          i = e;\n          break;\n      }\n      return i;\n    }\n  }, {\n    key: \"checkTextAttibute\",\n    value: function checkTextAttibute(t, e) {\n      if (t === void 0 || t === \"\") return !0;\n      try {\n        return new RegExp(e).test(t);\n      } catch (i) {\n        return !1;\n      }\n    }\n  }, {\n    key: \"getAttributeShowText\",\n    value: function getAttributeShowText(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var i, r;\n      try {\n        var n = e.findIndex(function (o) {\n          return o.value === t;\n        });\n        return (r = (i = e[n]) == null ? void 0 : i.key) != null ? r : t;\n      } catch (n) {\n        return t;\n      }\n    }\n  }, {\n    key: \"getAttributeIndex\",\n    value: function getAttributeIndex(t, e) {\n      try {\n        var i = e.findIndex(function (r) {\n          return r.key === t;\n        });\n        return i >= 8 ? i % 8 : i;\n      } catch (i) {\n        return -1;\n      }\n    }\n  }, {\n    key: \"getAttributeColor\",\n    value: function getAttributeColor(t, e) {\n      try {\n        var i = this.getAttributeIndex(t, e);\n        return i === -1 ? $t : pt[i % pt.length];\n      } catch (i) {\n        return $t;\n      }\n    }\n  }, {\n    key: \"getTextAttribute\",\n    value: function getTextAttribute(t, e) {\n      try {\n        if (e === K.Order) {\n          var i = t.map(function (n) {\n            return parseInt(n.textAttribute, 10);\n          }).filter(function (n) {\n            return Ot(n) && n < Number.MAX_SAFE_INTEGER && n >= 0;\n          });\n          return i.sort(function (n, o) {\n            return n - o;\n          }), \"\".concat((i.pop() || 0) + 1);\n        }\n        return \"\";\n      } catch (i) {\n        return \"\";\n      }\n    }\n  }, {\n    key: \"textChange\",\n    value: function textChange(t, e, i) {\n      return i.map(function (r) {\n        return r.id === e ? We(Ve({}, r), {\n          textAttribute: t\n        }) : r;\n      });\n    }\n  }, {\n    key: \"getErrorNotice\",\n    value: function getErrorNotice(t, e) {\n      switch (t) {\n        case K.Order:\n        case K.NumberOnly:\n          return H.getMessagesByLocale(C.TextCheckNumberErrorNotice, e);\n        case K.EnglishOnly:\n          return H.getMessagesByLocale(C.TextCheckEnglishErrorNotice, e);\n        case K.CustomFormat:\n          return H.getMessagesByLocale(C.TextCheckCustomErrorNotice, e);\n        default:\n          return \"\";\n      }\n    }\n  }, {\n    key: \"textAttributeValidate\",\n    value: function textAttributeValidate(t, e, i) {\n      try {\n        return new RegExp(this.checkString(t, e)).test(i);\n      } catch (r) {}\n    }\n  }, {\n    key: \"checkTextAttribute\",\n    value: function checkTextAttribute(t, e, i, r) {\n      var _this2 = this;\n      var n = !1;\n      return i.forEach(function (o) {\n        (o == null ? void 0 : o.textAttribute) === void 0 || (o == null ? void 0 : o.textAttribute) === \"\" || (r ? o.id === r : !0) && !_this2.textAttributeValidate(t, e, o.textAttribute) && (n = !0);\n      }), !!n;\n    }\n  }, {\n    key: \"changeTextAttributeInLog\",\n    value: function changeTextAttributeInLog(t, e) {\n      return t == null ? void 0 : t.map(function (i) {\n        return i == null ? void 0 : i.map(function (r) {\n          if ((e == null ? void 0 : e.findIndex(function (n) {\n            return (n == null ? void 0 : n.id) === (r == null ? void 0 : r.id);\n          })) > -1) {\n            var n = e == null ? void 0 : e.find(function (o) {\n              return (o == null ? void 0 : o.id) === (r == null ? void 0 : r.id);\n            });\n            return We(Ve({}, r), {\n              textAttribute: n == null ? void 0 : n.textAttribute\n            });\n          }\n          return r;\n        });\n      });\n    }\n  }, {\n    key: \"getTextIconSvg\",\n    value: function getTextIconSvg() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e = arguments.length > 1 ? arguments[1] : undefined;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      var r = arguments.length > 3 ? arguments[3] : undefined;\n      if (i === !0) {\n        var n = (e == null ? void 0 : e.findIndex(function (o) {\n          return (o == null ? void 0 : o.value) === t;\n        })) % pt.length + 1;\n        return Ft[n];\n      }\n      return r;\n    }\n  }, {\n    key: \"getAttributeByKeycode\",\n    value: function getAttributeByKeycode(t, e) {\n      var i;\n      var r;\n      return L.isInRange(t, [48, 57]) && (r = t - 48), L.isInRange(t, [96, 105]) && (r = t - 96), r === 0 ? \"\" : r ? (i = e[r - 1]) == null ? void 0 : i.value : void 0;\n    }\n  }]);\n  return T;\n}();\nvar Zt = /*#__PURE__*/function () {\n  function Zt() {\n    _classCallCheck(this, Zt);\n  }\n  _createClass(Zt, null, [{\n    key: \"deg2rad\",\n    value: function deg2rad(t) {\n      return t * Math.PI / 180;\n    }\n  }, {\n    key: \"rad2deg\",\n    value: function rad2deg(t) {\n      return t * 180 / Math.PI;\n    }\n  }]);\n  return Zt;\n}();\nvar tr = Object.defineProperty,\n  er = Object.defineProperties,\n  ir = Object.getOwnPropertyDescriptors,\n  je = Object.getOwnPropertySymbols,\n  sr = Object.prototype.hasOwnProperty,\n  rr = Object.prototype.propertyIsEnumerable,\n  Xe = function Xe(s, t, e) {\n    return t in s ? tr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  nr = function nr(s, t) {\n    for (var e in t || (t = {})) sr.call(t, e) && Xe(s, e, t[e]);\n    if (je) {\n      var _iterator7 = _createForOfIteratorHelper(je(t)),\n        _step7;\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var e = _step7.value;\n          rr.call(t, e) && Xe(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n    return s;\n  },\n  or = function or(s, t) {\n    return er(s, ir(t));\n  };\nvar ar = 1,\n  lr = {\n    x: 0,\n    y: 0\n  },\n  hr = 0,\n  tt = \"\";\nvar m = /*#__PURE__*/function () {\n  function m() {\n    _classCallCheck(this, m);\n  }\n  _createClass(m, null, [{\n    key: \"drawLine\",\n    value: function drawLine(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var n = t.getContext(\"2d\"),\n        _r$color = r.color,\n        o = _r$color === void 0 ? tt : _r$color,\n        _r$thickness = r.thickness,\n        a = _r$thickness === void 0 ? 1 : _r$thickness,\n        _r$lineCap = r.lineCap,\n        l = _r$lineCap === void 0 ? \"round\" : _r$lineCap;\n      n.save(), n.strokeStyle = o, n.lineWidth = a, n.lineCap = l, n.beginPath(), n.moveTo(e.x, e.y), n.lineTo(i.x + 1, i.y + 1), n.stroke(), n.restore();\n    }\n  }, {\n    key: \"drawRect\",\n    value: function drawRect(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var r = t.getContext(\"2d\"),\n        _i$color = i.color,\n        n = _i$color === void 0 ? tt : _i$color,\n        _i$thickness = i.thickness,\n        o = _i$thickness === void 0 ? 1 : _i$thickness,\n        _i$lineCap = i.lineCap,\n        a = _i$lineCap === void 0 ? \"round\" : _i$lineCap,\n        _i$hiddenText = i.hiddenText,\n        l = _i$hiddenText === void 0 ? !1 : _i$hiddenText,\n        h = i.lineDash,\n        c = i.isShowOrder,\n        g = i.order;\n      if (r.save(), r.strokeStyle = n, r.lineWidth = o, r.lineCap = a, Array.isArray(h) && r.setLineDash(h), r.fillStyle = n, r.strokeRect(e.x, e.y, e.width, e.height), l === !1) {\n        var d = \"\";\n        e.attribute && (d = \"\".concat(d, \"  \").concat(e.attribute)), c && (d = \"\".concat(g).concat(d)), this.drawText(t, {\n          x: e.x,\n          y: e.y - 5\n        }, d);\n      }\n      r.restore();\n    }\n  }, {\n    key: \"drawRectWithFill\",\n    value: function drawRectWithFill(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var r = t.getContext(\"2d\"),\n        _i$color2 = i.color,\n        n = _i$color2 === void 0 ? tt : _i$color2;\n      r.save(), r.fillStyle = n, r.fillRect(e.x, e.y, e.width, e.height), r.restore();\n    }\n  }, {\n    key: \"drawTagByDom\",\n    value: function drawTagByDom(t, e, i) {\n      var r = t;\n      if (!((e == null ? void 0 : e.length) > 0)) return;\n      var n = document.createElement(\"div\");\n      return n.innerHTML = e, n.setAttribute(\"id\", i), r == null || r.appendChild(n), n;\n    }\n  }, {\n    key: \"drawTag\",\n    value: function drawTag(t, e) {\n      var i;\n      var r = t == null ? void 0 : t.parentNode;\n      var n;\n      if (typeof window != \"undefined\" && (n = window.self.document.getElementById(\"tagToolTag\")), n && r && r.contains(n) && (r == null || r.removeChild(n)), !((e == null ? void 0 : e.length) > 0)) return;\n      var o = document.createElement(\"div\");\n      return o.innerHTML = (i = e.reduce(function (a, l) {\n        return \"\".concat(a).concat(l.keyName, \": \").concat(l.value.join(\" \\u3001 \"), \"\\n\");\n      }, \"\")) != null ? i : \"\", o.setAttribute(\"id\", \"tagToolTag\"), r == null || r.appendChild(o), o;\n    }\n  }, {\n    key: \"drawLineWithPointList\",\n    value: function drawLineWithPointList(t, e) {\n      var _this3 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      if (e.length < 2) return;\n      var r = t.getContext(\"2d\"),\n        _i$color3 = i.color,\n        n = _i$color3 === void 0 ? tt : _i$color3,\n        _i$thickness2 = i.thickness,\n        o = _i$thickness2 === void 0 ? 1 : _i$thickness2,\n        _i$lineCap2 = i.lineCap,\n        a = _i$lineCap2 === void 0 ? \"round\" : _i$lineCap2,\n        _i$lineType = i.lineType,\n        l = _i$lineType === void 0 ? R.Line : _i$lineType,\n        h = i.lineDash,\n        c = i.hoverEdgeIndex;\n      r.save(), function () {\n        r.strokeStyle = n, r.lineWidth = o, r.lineCap = a, Array.isArray(h) ? r.setLineDash(h) : r.setLineDash([]);\n      }(), l === R.Curve ? (c !== void 0 && c > -1 && e.push(e[0]), e = D.createSmoothCurvePointsFromPointList(_toConsumableArray(e), Y), c !== void 0 && c > -1 && (e = e.slice((Y + 1) * c, (Y + 1) * (c + 1)))) : c !== void 0 && c > -1 && (e = [].concat(_toConsumableArray(e), [e[0]]), e = e.slice(c, c + 2));\n      var d = [];\n      r.beginPath(), r.moveTo(e[0].x, e[0].y);\n      for (var v = 0; v < e.length - 1; v++) e[v].specialEdge && d.push({\n        i1: v,\n        i2: v + 1\n      }), r.lineTo(e[v + 1].x, e[v + 1].y);\n      r.stroke(), r.save(), r.lineWidth = o * .8, r.lineCap = \"butt\", r.strokeStyle = \"white\", r.setLineDash([3, 3]), d.forEach(function (v) {\n        var b = e[v.i1],\n          p = e[v.i2];\n        r.beginPath(), r.moveTo(b.x, b.y), r.lineTo(p.x, p.y), r.stroke();\n      }), r.restore();\n      var u = 4,\n        f = 2;\n      return e.forEach(function (v) {\n        v.specialPoint && (_this3.drawSpecialPoint(t, v, u + f, n), _this3.drawSpecialPoint(t, v, u, \"white\"));\n      }), r.restore(), e;\n    }\n  }, {\n    key: \"drawCircle\",\n    value: function drawCircle(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var n = t.getContext(\"2d\"),\n        _r$startAngleDeg = r.startAngleDeg,\n        o = _r$startAngleDeg === void 0 ? 0 : _r$startAngleDeg,\n        _r$endAngleDeg = r.endAngleDeg,\n        a = _r$endAngleDeg === void 0 ? 360 : _r$endAngleDeg,\n        _r$thickness2 = r.thickness,\n        l = _r$thickness2 === void 0 ? 1 : _r$thickness2,\n        _r$color2 = r.color,\n        h = _r$color2 === void 0 ? tt : _r$color2,\n        _r$fill = r.fill,\n        c = _r$fill === void 0 ? tt : _r$fill,\n        g = Zt.deg2rad(o),\n        d = Zt.deg2rad(a);\n      n.save(), n.beginPath(), n.strokeStyle = h, n.fillStyle = c, n.lineWidth = l, n.arc(e.x, e.y, i, g, d, !1), n.stroke(), c && n.fill(), n.closePath(), n.restore();\n    }\n  }, {\n    key: \"drawCircleWithFill\",\n    value: function drawCircleWithFill(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var n = t.getContext(\"2d\"),\n        _r$color3 = r.color,\n        o = _r$color3 === void 0 ? tt : _r$color3;\n      n.save();\n      var a = Zt.deg2rad(0),\n        l = Zt.deg2rad(360);\n      n.fillStyle = o, n.beginPath(), n.arc(e.x, e.y, i, a, l, !1), n.fill(), n.restore();\n    }\n  }, {\n    key: \"drawSpecialPoint\",\n    value: function drawSpecialPoint(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 6;\n      var r = arguments.length > 3 ? arguments[3] : undefined;\n      var n = t.getContext(\"2d\"),\n        o = e.x,\n        a = e.y;\n      n.save(), n.beginPath(), n.fillStyle = r;\n      var l = i * 1.5,\n        h = l * Math.sqrt(3) / 2,\n        c = l / 2;\n      n.moveTo(o, a - l), n.lineTo(o - h, a + c), n.lineTo(o + h, a + c), n.closePath(), n.fill(), n.restore();\n    }\n  }, {\n    key: \"drawPolygon\",\n    value: function drawPolygon(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _i$isClose = i.isClose,\n        r = _i$isClose === void 0 ? !1 : _i$isClose,\n        _i$lineType2 = i.lineType,\n        n = _i$lineType2 === void 0 ? R.Line : _i$lineType2;\n      return r === !0 && (e = [].concat(_toConsumableArray(e), [e[0]])), n === R.Curve && (e = D.createSmoothCurvePointsFromPointList(_toConsumableArray(e))), this.drawLineWithPointList(t, e, or(nr({}, i), {\n        lineType: R.Line\n      })), e;\n    }\n  }, {\n    key: \"drawPolygonWithFill\",\n    value: function drawPolygonWithFill(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      if (e.length < 2) return;\n      var r = t.getContext(\"2d\"),\n        _i$color4 = i.color,\n        n = _i$color4 === void 0 ? tt : _i$color4,\n        _i$lineType3 = i.lineType,\n        o = _i$lineType3 === void 0 ? R.Line : _i$lineType3;\n      r.save(), r.fillStyle = n, r.beginPath(), o === R.Curve && (e = D.createSmoothCurvePointsFromPointList([].concat(_toConsumableArray(e), [e[0]])));\n      var _e4 = e,\n        _e5 = _toArray(_e4),\n        a = _e5[0],\n        l = _e5.slice(1);\n      return r.moveTo(a.x, a.y), l.forEach(function (h) {\n        r.lineTo(h.x, h.y);\n      }), r.fill(), r.restore(), e;\n    }\n  }, {\n    key: \"drawPolygonWithFillAndLine\",\n    value: function drawPolygonWithFillAndLine(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var r = i.strokeColor,\n        n = i.fillColor,\n        o = i.thickness,\n        a = i.lineCap,\n        l = i.isClose,\n        h = i.lineType,\n        c = this.drawPolygon(t, e, {\n          color: r,\n          thickness: o,\n          lineCap: a,\n          isClose: l,\n          lineType: h\n        });\n      return this.drawPolygonWithFill(t, e, {\n        color: n,\n        lineType: h\n      }), c;\n    }\n  }, {\n    key: \"drawPolygonWithKeyPoint\",\n    value: function drawPolygonWithKeyPoint(t, e) {\n      var _this4 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _i$pointColor = i.pointColor,\n        r = _i$pointColor === void 0 ? \"white\" : _i$pointColor,\n        n = i.strokeColor,\n        o = this.drawPolygon(t, e, i);\n      return o.forEach(function (a) {\n        _this4.drawCircleWithFill(t, a, 4, {\n          color: n\n        }), _this4.drawCircleWithFill(t, a, 3, {\n          color: r\n        });\n      }), o;\n    }\n  }, {\n    key: \"drawSelectedPolygonWithFillAndLine\",\n    value: function drawSelectedPolygonWithFillAndLine(t, e) {\n      var _this5 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _i$pointColor2 = i.pointColor,\n        r = _i$pointColor2 === void 0 ? \"white\" : _i$pointColor2,\n        n = i.strokeColor,\n        o = this.drawPolygonWithFillAndLine(t, e, i);\n      return o.forEach(function (a) {\n        _this5.drawCircleWithFill(t, a, 4, {\n          color: n\n        }), _this5.drawCircleWithFill(t, a, 3, {\n          color: r\n        });\n      }), o;\n    }\n  }, {\n    key: \"drawText\",\n    value: function drawText(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      if (!i || !e) return;\n      var n = t.getContext(\"2d\"),\n        _r$color4 = r.color,\n        o = _r$color4 === void 0 ? tt : _r$color4,\n        _r$font = r.font,\n        a = _r$font === void 0 ? yt : _r$font,\n        _r$shadowColor = r.shadowColor,\n        l = _r$shadowColor === void 0 ? \"\" : _r$shadowColor,\n        _r$shadowBlur = r.shadowBlur,\n        h = _r$shadowBlur === void 0 ? 0 : _r$shadowBlur,\n        _r$shadowOffsetX = r.shadowOffsetX,\n        c = _r$shadowOffsetX === void 0 ? 0 : _r$shadowOffsetX,\n        _r$shadowOffsetY = r.shadowOffsetY,\n        g = _r$shadowOffsetY === void 0 ? 0 : _r$shadowOffsetY,\n        _r$textMaxWidth = r.textMaxWidth,\n        d = _r$textMaxWidth === void 0 ? 164 : _r$textMaxWidth,\n        _r$offsetX = r.offsetX,\n        u = _r$offsetX === void 0 ? 0 : _r$offsetX,\n        _r$offsetY = r.offsetY,\n        f = _r$offsetY === void 0 ? 0 : _r$offsetY,\n        _r$textAlign = r.textAlign,\n        v = _r$textAlign === void 0 ? \"start\" : _r$textAlign,\n        b = r.lineHeight;\n      n.save(), n.textAlign = v, n.fillStyle = o != null ? o : \"white\", n.font = a, n.shadowColor = l, n.shadowOffsetX = c, n.shadowOffsetY = g, n.shadowBlur = h, this.wrapText(t, \"\".concat(i), e.x + u, e.y + f, d, b), n.restore();\n    }\n  }, {\n    key: \"wrapText\",\n    value: function wrapText(t, e, i, r, n, o) {\n      if (typeof e != \"string\" || typeof i != \"number\" || typeof r != \"number\") return;\n      var a = t.getContext(\"2d\");\n      typeof n == \"undefined\" && (n = t && t.width || 300), typeof o == \"undefined\" && typeof window != \"undefined\" && (o = t && parseInt(window.getComputedStyle(t).lineHeight, 10) || parseInt(window.getComputedStyle(document.body).lineHeight, 10));\n      var l = e.split(\"\\n\");\n      for (var h = 0; h < l.length; h++) {\n        var c = l[h].split(\"\");\n        var g = \"\";\n        for (var d = 0; d < c.length; d++) {\n          var u = g + c[d],\n            v = a.measureText(u).width;\n          n || (n = 300), v > n && d > 0 ? (a.fillText(g, i, r), g = c[d], r += o) : g = u;\n        }\n        a.fillText(g, i, r), r += o;\n      }\n    }\n  }, {\n    key: \"drawArrow\",\n    value: function drawArrow(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var _r$color5 = r.color,\n        n = _r$color5 === void 0 ? tt : _r$color5,\n        _r$thickness3 = r.thickness,\n        o = _r$thickness3 === void 0 ? 1 : _r$thickness3,\n        _r$lineCap2 = r.lineCap,\n        a = _r$lineCap2 === void 0 ? \"round\" : _r$lineCap2,\n        _r$theta = r.theta,\n        l = _r$theta === void 0 ? 30 : _r$theta,\n        _r$headLen = r.headLen,\n        h = _r$headLen === void 0 ? 10 : _r$headLen,\n        c = Math.atan2(e.y - i.y, e.x - i.x) * 180 / Math.PI,\n        g = (c + l) * Math.PI / 180,\n        d = (c - l) * Math.PI / 180,\n        u = h * Math.cos(g),\n        f = h * Math.sin(g),\n        v = h * Math.cos(d),\n        b = h * Math.sin(d);\n      t.save(), t.strokeStyle = n, t.lineWidth = o, t.lineCap = a, t.beginPath(), t.moveTo(i.x + u, i.y + f), t.lineTo(i.x, i.y), t.lineTo(i.x + v, i.y + b), t.stroke(), t.restore();\n    }\n  }, {\n    key: \"drawArrowByCanvas\",\n    value: function drawArrowByCanvas(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var n = t.getContext(\"2d\");\n      this.drawArrow(n, e, i, r);\n    }\n  }]);\n  return m;\n}();\nm.drawImg = function (s, t) {\n  var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var i = s.getContext(\"2d\"),\n    _e$zoom = e.zoom,\n    r = _e$zoom === void 0 ? ar : _e$zoom,\n    _e$currentPos = e.currentPos,\n    n = _e$currentPos === void 0 ? lr : _e$currentPos,\n    _e$rotate = e.rotate,\n    o = _e$rotate === void 0 ? hr : _e$rotate,\n    a = e.imgAttribute;\n  switch (i.save(), o) {\n    case 0:\n      i.translate(n.x, n.y);\n      break;\n    case 90:\n      i.translate(n.x + t.height * r, n.y), i.rotate(90 * Math.PI / 180);\n      break;\n    case 180:\n      i.translate(n.x + t.width * r, n.y + t.height * r), i.rotate(Math.PI);\n      break;\n    case 270:\n      i.translate(n.x, n.y + t.width * r), i.rotate(270 * Math.PI / 180);\n      break;\n    default:\n      i.translate(n.x, n.y);\n      break;\n  }\n  if (a) {\n    var l = a.contrast,\n      h = a.saturation,\n      c = a.brightness;\n    i.filter = \"saturate(\".concat(h + 100, \"%) contrast(\").concat(l + 100, \"%) brightness(\").concat(c + 100, \"%)\");\n  }\n  i.drawImage(t, 0, 0, t.width * r, t.height * r), i.restore();\n};\nvar et = /*#__PURE__*/function () {\n  function et() {\n    _classCallCheck(this, et);\n  }\n  _createClass(et, null, [{\n    key: \"getStrokeAndFill\",\n    value: function getStrokeAndFill(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var _i$isSelected = i.isSelected,\n        r = _i$isSelected === void 0 ? !1 : _i$isSelected,\n        _i$isHover = i.isHover,\n        n = _i$isHover === void 0 ? !1 : _i$isHover;\n      return r ? {\n        stroke: e ? t.validSelected.stroke : t.invalidSelected.stroke,\n        fill: e ? t.validSelected.fill : t.invalidSelected.fill\n      } : n ? {\n        stroke: e ? t.validHover.stroke : t.invalidHover.stroke,\n        fill: e ? t.validHover.fill : t.invalidHover.fill\n      } : {\n        stroke: e ? t.valid.stroke : t.invalid.stroke,\n        fill: e ? t.valid.fill : t.invalid.fill\n      };\n    }\n  }, {\n    key: \"getStyle2String\",\n    value: function getStyle2String(t) {\n      if (!!t) return Object.entries(t).reduce(function (e, i) {\n        return \"\".concat(e, \" \").concat(i[0], \": \").concat(i[1], \";\");\n      }, \"\");\n    }\n  }]);\n  return et;\n}();\nvar at = /*#__PURE__*/function () {\n  function at() {\n    _classCallCheck(this, at);\n  }\n  _createClass(at, null, [{\n    key: \"getMousePositionOnCanvasFromEvent\",\n    value: function getMousePositionOnCanvasFromEvent(t, e) {\n      if (e && t) {\n        var i = e.getBoundingClientRect();\n        return {\n          x: t.clientX - i.left,\n          y: t.clientY - i.top\n        };\n      }\n      return null;\n    }\n  }, {\n    key: \"getClientRect\",\n    value: function getClientRect(t) {\n      if (t) {\n        var e = t.getBoundingClientRect();\n        return {\n          x: e.left,\n          y: e.top,\n          width: e.width,\n          height: e.height\n        };\n      }\n      return null;\n    }\n  }, {\n    key: \"getSize\",\n    value: function getSize(t) {\n      if (t) {\n        var e = t.getBoundingClientRect();\n        return {\n          width: e.width,\n          height: e.height\n        };\n      }\n      return null;\n    }\n  }, {\n    key: \"inViewPort\",\n    value: function inViewPort(t, e) {\n      return t ? L.isInRange(t.x, [e.left, e.right]) && L.isInRange(t.y, [e.top, e.bottom]) : !1;\n    }\n  }]);\n  return at;\n}();\nat.getViewPort = function (s, t, e) {\n  var i = s.width,\n    r = s.height,\n    n = t.x,\n    o = t.y,\n    a = (0 - o) / e,\n    l = (0 - n) / e,\n    h = a + r / e,\n    c = l + i / e;\n  return {\n    top: a,\n    bottom: h,\n    left: l,\n    right: c\n  };\n}, at.getPixelRatio = function (s) {\n  if (!s || !window) return 1;\n  var t = s.backingStorePixelRatio || s.webkitBackingStorePixelRatio || s.mozBackingStorePixelRatio || s.msBackingStorePixelRatio || s.oBackingStorePixelRatio || s.backingStorePixelRatio || 1;\n  var e = 1;\n  return typeof window != \"undefined\" && (e = (window.devicePixelRatio || 1) / t), e;\n};\nvar Ke = {\n    showConfirm: !1,\n    skipWhileNoDependencies: !1,\n    drawOutsideTarget: !1,\n    copyBackwardResult: !1,\n    minWidth: 1,\n    minHeight: 1,\n    isShowOrder: !1,\n    filterData: [\"valid\", \"invalid\"],\n    attributeConfigurable: !1,\n    attributeList: [],\n    textConfigurable: !1,\n    textCheckType: 0,\n    customFormat: \"\"\n  },\n  cr = {\n    showConfirm: !1,\n    skipWhileNoDependencies: !1,\n    inputList: [{\n      key: \"\\u7C7B\\u522B1\",\n      value: \"class1\",\n      isMulti: !1,\n      subSelected: [{\n        key: \"\\u9009\\u98791\",\n        value: \"option1\",\n        isDefault: !1\n      }, {\n        key: \"\\u9009\\u98792\",\n        value: \"option1-2\",\n        isDefault: !1\n      }]\n    }, {\n      key: \"\\u7C7B\\u522B2\",\n      value: \"class-AH\",\n      isMulti: !0,\n      subSelected: [{\n        key: \"\\u9009\\u98792-1\",\n        value: \"option2-1\",\n        isDefault: !1\n      }, {\n        key: \"\\u9009\\u98792-2\",\n        value: \"option2-2\",\n        isDefault: !1\n      }, {\n        key: \"\\u9009\\u98792-3\",\n        value: \"option2-3\",\n        isDefault: !1\n      }]\n    }, {\n      key: \"\\u7C7B\\u522B3\",\n      value: \"class-0P\",\n      isMulti: !1,\n      subSelected: [{\n        key: \"\\u9009\\u98793-1\",\n        value: \"option3-1\",\n        isMulti: !1\n      }, {\n        key: \"\\u9009\\u98793-2\",\n        value: \"option3-2\",\n        isDefault: !1\n      }, {\n        key: \"\\u9009\\u98793-3\",\n        value: \"option3-3\",\n        isDefault: !1\n      }]\n    }]\n  },\n  dr = {\n    lineType: 0,\n    lineColor: 0,\n    edgeAdsorption: !1,\n    outOfTarget: !0,\n    copyBackwardResult: !1,\n    isShowOrder: !1,\n    attributeConfigurable: !1,\n    attributeList: [{\n      key: \"\\u7C7B\\u522B1\",\n      value: \"\\u7C7B\\u522B1\"\n    }, {\n      key: \"\\u7C7B\\u522Bao\",\n      value: \"class-ao\"\n    }, {\n      key: \"\\u7C7B\\u522BM1\",\n      value: \"class-M1\"\n    }, {\n      key: \"\\u7C7B\\u522BCm\",\n      value: \"class-Cm\"\n    }, {\n      key: \"\\u7C7B\\u522Bc3\",\n      value: \"class-c3\"\n    }, {\n      key: \"\\u7C7B\\u522Ba0\",\n      value: \"class-a0\"\n    }, {\n      key: \"\\u7C7B\\u522Bu7\",\n      value: \"class-u7\"\n    }, {\n      key: \"\\u7C7B\\u522BZb\",\n      value: \"class-Zb\"\n    }, {\n      key: \"\\u7C7B\\u522Bzi\",\n      value: \"class-zi\"\n    }],\n    textConfigurable: !1,\n    textCheckType: 2,\n    customFormat: \"\",\n    showConfirm: !1,\n    lowerLimitPointNum: 2,\n    upperLimitPointNum: \"\",\n    preReferenceStep: 0,\n    skipWhileNoDependencies: !1,\n    filterData: [\"valid\", \"invalid\"]\n  },\n  ur = {\n    showConfirm: !1,\n    skipWhileNoDependencies: !1,\n    enableTextRecognition: !1,\n    recognitionMode: \"general\",\n    configList: [{\n      label: \"\\u6587\\u672C\",\n      key: \"text\",\n      required: !1,\n      default: \"\",\n      maxLength: 1e3\n    }],\n    filterData: [\"valid\", \"invalid\"]\n  },\n  gr = {\n    lineType: 0,\n    lineColor: 0,\n    lowerLimitPointNum: 3,\n    edgeAdsorption: !1,\n    drawOutsideTarget: !1,\n    copyBackwardResult: !1,\n    isShowOrder: !1,\n    attributeConfigurable: !1,\n    attributeList: [],\n    textConfigurable: !0,\n    textCheckType: 0,\n    customFormat: \"\"\n  },\n  Ye = function Ye(s) {\n    return s === \"lineTool\" ? dr : s === \"rectTool\" ? Ke : s === \"tagTool\" ? cr : s === \"textTool\" ? ur : s === \"polygonTool\" ? gr : Ke;\n  },\n  Ge = {\n    toolColor: {\n      1: {\n        valid: {\n          stroke: \"rgba(0,0,255,0.50)\",\n          fill: \"rgba(0,0,255,0.40)\"\n        },\n        invalid: {\n          stroke: \"rgba(255,153,102,1.00)\",\n          fill: \"rgba(255,153,102,0.80)\"\n        },\n        validSelected: {\n          stroke: \"rgba(0,15,255,1.00)\",\n          fill: \"rgba(0,15,255,0.80)\"\n        },\n        invalidSelected: {\n          stroke: \"rgba(255,0,0,0.60)\",\n          fill: \"rgba(255,0,0,0.24)\"\n        },\n        validHover: {\n          stroke: \"rgba(0,15,255,0.80)\",\n          fill: \"rgba(0,15,255,0.64)\"\n        },\n        invalidHover: {\n          stroke: \"rgba(255,0,0,0.50)\",\n          fill: \"rgba(255,0,0,0.40)\"\n        }\n      },\n      3: {\n        valid: {\n          stroke: \"rgba(0,255,255,0.50)\",\n          fill: \"rgba(0,255,255,0.40)\"\n        },\n        invalid: {\n          stroke: \"rgba(255,153,102,1.00)\",\n          fill: \"rgba(255,153,102,0.80)\"\n        },\n        validSelected: {\n          stroke: \"rgba(0,212,255,1.00)\",\n          fill: \"rgba(0,212,255,0.80)\"\n        },\n        invalidSelected: {\n          stroke: \"rgba(255,0,0,0.60)\",\n          fill: \"rgba(255,0,0,0.24)\"\n        },\n        validHover: {\n          stroke: \"rgba(0,212,255,0.80)\",\n          fill: \"rgba(0,212,255,0.64)\"\n        },\n        invalidHover: {\n          stroke: \"rgba(255,0,0,0.50)\",\n          fill: \"rgba(255,0,0,0.40)\"\n        }\n      },\n      5: {\n        valid: {\n          stroke: \"rgba(0,255,0,0.50)\",\n          fill: \"rgba(0,255,0,0.40)\"\n        },\n        invalid: {\n          stroke: \"rgba(255,153,102,1.00)\",\n          fill: \"rgba(255,153,102,0.80)\"\n        },\n        validSelected: {\n          stroke: \"rgba(149,255,1.00)\",\n          fill: \"rgba(149,255,0,0.80)\"\n        },\n        invalidSelected: {\n          stroke: \"rgba(255,0,0,0.60)\",\n          fill: \"rgba(255,0,0,0.24)\"\n        },\n        validHover: {\n          stroke: \"rgba(149,255,0,0.80)\",\n          fill: \"rgba(149,255,0,0.64)\"\n        },\n        invalidHover: {\n          stroke: \"rgba(255,0,0,0.50)\",\n          fill: \"rgba(255,0,0,0.40)\"\n        }\n      },\n      7: {\n        valid: {\n          stroke: \"rgba(255,255,0,0.50)\",\n          fill: \"rgba(255,255,0,0.40)\"\n        },\n        invalid: {\n          stroke: \"rgba(255,153,102,1.00)\",\n          fill: \"rgba(255,153,102,0.80)\"\n        },\n        validSelected: {\n          stroke: \"rgba(255,230,102,1.00)\",\n          fill: \"rgba(255,213,0,0.80)\"\n        },\n        invalidSelected: {\n          stroke: \"rgba(255,0,0,0.60)\",\n          fill: \"rgba(255,0,0,0.24)\"\n        },\n        validHover: {\n          stroke: \"rgba(255,230,102,0.80)\",\n          fill: \"rgba(255,230,102,0.64)\"\n        },\n        invalidHover: {\n          stroke: \"rgba(255,0,0,0.50)\",\n          fill: \"rgba(255,0,0,0.40)\"\n        }\n      },\n      9: {\n        valid: {\n          stroke: \"rgba(255,0,255,0.50)\",\n          fill: \"rgba(255,0,255,0.40)\"\n        },\n        invalid: {\n          stroke: \"rgba(255,153,102,1.00)\",\n          fill: \"rgba(255,153,102,0.80)\"\n        },\n        validSelected: {\n          stroke: \"rgba(230,102,255,1.00)\",\n          fill: \"rgba(213,0,255,0.80)\"\n        },\n        invalidSelected: {\n          stroke: \"rgba(255,0,0,0.60)\",\n          fill: \"rgba(255,0,0,0.24)\"\n        },\n        validHover: {\n          stroke: \"rgba(230,102,255,0.80)\",\n          fill: \"rgba(230,102,255,0.64)\"\n        },\n        invalidHover: {\n          stroke: \"rgba(255,0,0,0.50)\",\n          fill: \"rgba(255,0,0,0.40)\"\n        }\n      }\n    },\n    attributeColor: [{\n      valid: {\n        stroke: \"rgba(204,204,204,1.00)\",\n        fill: \"rgba(204,204,204,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(204,204,204,1.00)\",\n        fill: \"rgba(204,204,204,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(204,204,204,1.00)\",\n        fill: \"rgba(204,204,204,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(153,51,255,1.00)\",\n        fill: \"rgba(153,51,255,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(153,51,255,1.00)\",\n        fill: \"rgba(153,51,255,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(153,51,255,1.00)\",\n        fill: \"rgba(153,51,255,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(51,254,51,1.00)\",\n        fill: \"rgba(51,254,51,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(51,254,51,1.00)\",\n        fill: \"rgba(51,254,51,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(51,254,51,1.00)\",\n        fill: \"rgba(51,254,51,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(255,51,255,1.00)\",\n        fill: \"rgba(255,51,255,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(255,51,255,1.00)\",\n        fill: \"rgba(255,51,255,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(255,51,255,1.00)\",\n        fill: \"rgba(255,51,255,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(204,255,51,1.00)\",\n        fill: \"rgba(204,255,51,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(204,255,51,1.00)\",\n        fill: \"rgba(204,255,51,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(204,255,51,1.00)\",\n        fill: \"rgba(204,255,51,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(51,153,255,1.00)\",\n        fill: \"rgba(51,153,255,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(51,153,255,1.00)\",\n        fill: \"rgba(51,153,255,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(51,153,255,1.00)\",\n        fill: \"rgba(51,153,255,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(255,153,51,1.00)\",\n        fill: \"rgba(255,153,51,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(255,153,51,1.00)\",\n        fill: \"rgba(255,153,51,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(255,153,51,1.00)\",\n        fill: \"rgba(255,153,51,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(51,255,238,1.00)\",\n        fill: \"rgba(51,255,238,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(51,255,238,1.00)\",\n        fill: \"rgba(51,255,238,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(51,255,238,1.00)\",\n        fill: \"rgba(51,255,238,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }, {\n      valid: {\n        stroke: \"rgba(255,221,51,1.00)\",\n        fill: \"rgba(255,221,51,0.40)\"\n      },\n      invalid: {\n        stroke: \"rgba(255,153,102,1.00)\",\n        fill: \"rgba(255,153,102,0.40)\"\n      },\n      validSelected: {\n        stroke: \"rgba(255,221,51,1.00)\",\n        fill: \"rgba(255,221,51,0.80)\"\n      },\n      invalidSelected: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      },\n      validHover: {\n        stroke: \"rgba(255,221,51,1.00)\",\n        fill: \"rgba(255,221,51,0.80)\"\n      },\n      invalidHover: {\n        stroke: \"rgba(255,0,0,1.00)\",\n        fill: \"rgba(255,0,0,0.80)\"\n      }\n    }],\n    lineColor: {\n      1: \"rgba(102, 111, 255, 1 )\",\n      3: \"rgba(102, 230, 255, 1)\",\n      5: \"rgba(191, 255, 102, 1)\",\n      7: \"rgba(255, 230, 102, 1)\",\n      9: \"rgba(230, 102, 255, 1)\"\n    },\n    attributeLineColor: [\"rgba(204, 204, 204, 1)\", \"rgba(153, 51, 255, 1)\", \"rgba(51, 254, 51, 1)\", \"rgba(255, 51, 255, 1)\", \"rgba(204, 255, 51, 1)\", \"rgba(51, 153, 255, 1)\", \"rgba(255, 153, 51, 1)\", \"rgba(51, 255, 238, 1)\", \"rgba(255, 221, 51, 1)\"],\n    color: 1,\n    width: 2,\n    opacity: 9\n  };\nvar fr = Object.defineProperty,\n  vr = Object.defineProperties,\n  pr = Object.getOwnPropertyDescriptors,\n  Je = Object.getOwnPropertySymbols,\n  br = Object.prototype.hasOwnProperty,\n  yr = Object.prototype.propertyIsEnumerable,\n  qe = function qe(s, t, e) {\n    return t in s ? fr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Qe = function Qe(s, t) {\n    for (var e in t || (t = {})) br.call(t, e) && qe(s, e, t[e]);\n    if (Je) {\n      var _iterator8 = _createForOfIteratorHelper(Je(t)),\n        _step8;\n      try {\n        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n          var e = _step8.value;\n          yr.call(t, e) && qe(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator8.e(err);\n      } finally {\n        _iterator8.f();\n      }\n    }\n    return s;\n  },\n  ti = function ti(s, t) {\n    return vr(s, pr(t));\n  },\n  ei;\n(function (s) {\n  s[s.Create = 0] = \"Create\", s[s.Active = 1] = \"Active\", s[s.Edit = 1] = \"Edit\", s[s.None = 2] = \"None\";\n})(ei || (ei = {}));\nvar ii;\n(function (s) {\n  s.ActiveArea = \"#B3B8FF\";\n})(ii || (ii = {}));\nvar si = 16,\n  ri = {\n    x: 0,\n    y: 20\n  },\n  xr = 3,\n  z = /*#__PURE__*/function () {\n    function z() {\n      _classCallCheck(this, z);\n    }\n    _createClass(z, null, [{\n      key: \"isInLine\",\n      value: function isInLine(s, t, e) {\n        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 3;\n        var _L$getFootOfPerpendic = L.getFootOfPerpendicular(s, t, e),\n          r = _L$getFootOfPerpendic.length;\n        return r < i;\n      }\n    }]);\n    return z;\n  }();\nvar M = z;\nM.setSpecialEdgeStyle = function (s) {\n  s.lineCap = \"butt\", s.setLineDash([10, 10]);\n}, M.setReferenceCtx = function (s) {\n  s.lineCap = \"butt\", s.setLineDash([6]);\n}, M.calcOptimalIntersection = function (s, t, e, i, r) {\n  var n,\n    o = Infinity,\n    a;\n  if (s.find(function (h, c) {\n    if (c === 0) return;\n    var g = z.isInLine(t.pointA, h, s[c - 1]),\n      d = z.isInLine(t.pointB, h, s[c - 1]);\n    return g && d;\n  })) return {\n    point: e\n  };\n  if (s.forEach(function (h, c) {\n    if (c === 0) return;\n    var g = {\n        pointA: s[c - 1],\n        pointB: h\n      },\n      d = z.lineIntersection(t, g);\n    if (d && t) {\n      var u = d.onLine2,\n        f = d.onLine1,\n        v = d.x,\n        b = d.y,\n        p = z.calcDistance(e, d);\n      if (z.isOnLine(t.pointB.x, t.pointB.y, h.x, h.y, s[c - 1].x, s[c - 1].y)) {\n        if (z.calcDistance(e, d) < i / r) {\n          var _ = t.pointB,\n            _L$getFootOfPerpendic2 = L.getFootOfPerpendicular(_, g.pointA, g.pointB, !0),\n            A = _L$getFootOfPerpendic2.footPoint,\n            E = _L$getFootOfPerpendic2.length;\n          if (E !== void 0) {\n            var N = z.calcDistance(g.pointA, A),\n              k = z.calcDistance(g.pointB, A);\n            a = {\n              point: A,\n              minDistance: E\n            }, E === Infinity && (a.point = N > k ? g.pointB : g.pointA);\n          }\n        }\n        return;\n      }\n      p < o && u && f && (o = p, n = {\n        x: v,\n        y: b\n      });\n    }\n  }), n) return {\n    point: n,\n    minDistance: o\n  };\n  if (a) return a;\n}, M.lineIntersection = function (s, t) {\n  var e = !1,\n    i = !1;\n  var r = z.getAxisDiff(s),\n    n = z.getAxisDiff(t),\n    o = n.y * r.x - n.x * r.y;\n  if (o === 0) return !1;\n  var a = s.pointA.y - t.pointA.y,\n    l = s.pointA.x - t.pointA.x;\n  var h = (t.pointB.x - t.pointA.x) * a - (t.pointB.y - t.pointA.y) * l,\n    c = (s.pointB.x - s.pointA.x) * a - (s.pointB.y - s.pointA.y) * l;\n  a = h / o, l = c / o, a > 0 && a < 1 && (e = !0), l > 0 && l < 1 && (i = !0);\n  var g = s.pointA.x + a * (s.pointB.x - s.pointA.x),\n    d = s.pointA.y + a * (s.pointB.y - s.pointA.y);\n  return {\n    x: g,\n    y: d,\n    onLine1: e,\n    onLine2: i\n  };\n}, M.getAxisDiff = function (s) {\n  return {\n    x: s.pointB.x - s.pointA.x,\n    y: s.pointB.y - s.pointA.y\n  };\n}, M.calcDistance = function (s, t) {\n  return Math.sqrt(Math.pow(Math.abs(s.x - t.x), 2) + Math.pow(Math.abs(s.y - t.y), 2));\n}, M.drawCurveLine = function (s, t, e) {\n  var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;\n  var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n  var n = arguments.length > 5 ? arguments[5] : undefined;\n  var o = Ht(t, si);\n  s.save(), s.lineCap = \"round\", s.lineJoin = \"round\", s.strokeStyle = e.color, i && (s.lineWidth = e.lineWidth), r && z.setReferenceCtx(s), t.forEach(function (a, l) {\n    var h = a == null ? void 0 : a.specialEdge,\n      c = o.splice(0, si + 1);\n    s.save(), s.beginPath(), n === l && (s.lineWidth = 4), c.forEach(function (_ref4, u) {\n      var g = _ref4.x,\n        d = _ref4.y;\n      var f = u > 0 ? \"lineTo\" : \"moveTo\";\n      h && z.setSpecialEdgeStyle(s), s[f](g, d);\n    }), s.stroke(), s.restore();\n  }), s.restore();\n}, M.calcTwoPointDistance = function (s, t) {\n  return Math.sqrt(Math.pow(s.x - t.x, 2) + Math.pow(s.y - t.y, 2));\n}, M.pointOverTarget = function (s, t, e, i, r, n, o, a, l, h) {\n  var c = s;\n  if (!t) return s;\n  if (e === P.Polygon) {\n    var g = z.getPolygonPointList(i, r);\n    if (g.length === 0 || D.isInPolygon(s, g)) return c;\n    var u = g.concat(g[0]).map(function (y) {\n        return l(y);\n      }),\n      f = l(t),\n      v = l(s),\n      b = {\n        pointA: f,\n        pointB: v\n      },\n      p = z.calcOptimalIntersection(u, b, f, o, a);\n    if (p) {\n      var y = h(p == null ? void 0 : p.point);\n      c.x = y.x, c.y = y.y;\n    } else return t;\n    return c;\n  }\n  if (e === P.Rect) {\n    var _g = i.x,\n      d = i.y,\n      _u = i.width,\n      _f2 = i.height;\n    return c.x = L.withinRange(c.x, [_g, _g + _u]), c.y = L.withinRange(c.y, [d, d + _f2]), c;\n  }\n  return c.x = L.withinRange(c.x, [0, n.width]), c.y = L.withinRange(c.y, [0, n.height]), c;\n}, M.getPolygonPointList = function (s, t) {\n  var e = s.pointList,\n    i = t.lineType;\n  return i === R.Line ? e : D.createSmoothCurvePoints(e.reduce(function (r, n) {\n    return [].concat(_toConsumableArray(r), [n.x, n.y]);\n  }, []), .5, !0, 20);\n}, M.isOnLine = function (s, t, e, i, r, n) {\n  return Math.abs(function (a) {\n    return (i - t) / (e - s) * (a - s) + t;\n  }(r) - n) < 1e-6 && r >= s && r <= e;\n}, M.inArea = function (_ref5, _ref6) {\n  var s = _ref5.top,\n    t = _ref5.left,\n    e = _ref5.right,\n    i = _ref5.bottom;\n  var r = _ref6.x,\n    n = _ref6.y;\n  return n >= s && n <= i && r >= t && r <= e;\n}, M.getVHPoint = function (s, t, e, i) {\n  var r = z.getAngle(s, e);\n  return Math.abs(r) < 45 ? ti(Qe({}, t), {\n    y: i.y\n  }) : ti(Qe({}, t), {\n    x: i.x\n  });\n}, M.getAngle = function (s, t) {\n  var e = t.x - s.x,\n    i = t.y - s.y;\n  return 360 * Math.atan(i / e) / (2 * Math.PI);\n};\nvar oe;\n(function (s) {\n  s[s.M = 77] = \"M\", s[s.B = 66] = \"B\", s[s.C = 67] = \"C\", s[s.N = 78] = \"N\", s[s.E = 69] = \"E\", s[s.F = 70] = \"F\", s[s.G = 71] = \"G\", s[s.H = 72] = \"H\", s[s.L = 76] = \"L\", s[s.R = 82] = \"R\", s[s.Z = 90] = \"Z\", s[s.W = 87] = \"W\", s[s.X = 88] = \"X\", s[s.Y = 89] = \"Y\", s[s.S = 83] = \"S\", s[s.Q = 81] = \"Q\", s[s.Delete = 46] = \"Delete\", s[s.F11 = 122] = \"F11\", s[s.Space = 32] = \"Space\", s[s.Esc = 27] = \"Esc\", s[s.Left = 37] = \"Left\", s[s.Up = 38] = \"Up\", s[s.Right = 39] = \"Right\", s[s.Down = 40] = \"Down\", s[s.Enter = 13] = \"Enter\", s[s.Ctrl = 17] = \"Ctrl\", s[s.Alt = 18] = \"Alt\", s[s.Shift = 16] = \"Shift\", s[s.Tab = 9] = \"Tab\", s[s.BackSpace = 8] = \"BackSpace\";\n})(oe || (oe = {}));\nvar S = oe,\n  mr = Object.freeze({\n    __proto__: null,\n    default: S\n  });\nvar ae = /*#__PURE__*/function () {\n  function ae(t) {\n    var _this6 = this;\n    _classCallCheck(this, ae);\n    this.record = [], this.recordIndex = -1, this.minRecordIndex = -1, this.emitHistoryChanged = function () {\n      _this6.historyChanged && (_this6.constructor.name === \"ActionsHistory\" ? !0 : _this6.record.length > 0) && _this6.historyChanged(_this6.undoEnabled, _this6.redoEnabled);\n    }, this.historyChanged = t;\n  }\n  _createClass(ae, [{\n    key: \"undoEnabled\",\n    get: function get() {\n      return this.recordIndex > this.minRecordIndex;\n    }\n  }, {\n    key: \"redoEnabled\",\n    get: function get() {\n      return this.recordIndex < this.record.length - 1;\n    }\n  }, {\n    key: \"pushHistory\",\n    value: function pushHistory(t) {\n      if (this.recordIndex !== this.record.length - 1) {\n        var e = this.record.slice(0, Math.min(this.recordIndex + 1, this.record.length));\n        this.record = e;\n      }\n      this.record.push(B.cloneDeepWith(t)), this.recordIndex += 1, this.emitHistoryChanged();\n    }\n  }, {\n    key: \"updateHistory\",\n    value: function updateHistory(t) {\n      this.record[this.recordIndex] = B.cloneDeep(t);\n    }\n  }, {\n    key: \"applyAttribute\",\n    value: function applyAttribute(t, e, i) {\n      t && this.record.forEach(function (r) {\n        var n = r.find(function (o) {\n          return o.id === t;\n        });\n        n && (n[e] = i);\n      });\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      if (this.undoEnabled) return this.recordIndex -= 1, this.emitHistoryChanged(), B.cloneDeep(this.record[this.recordIndex]) || [];\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      if (this.redoEnabled) return this.recordIndex += 1, this.emitHistoryChanged(), B.cloneDeep(this.record[this.recordIndex]);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.record = [[]], this.recordIndex = 0, this.emitHistoryChanged();\n    }\n  }, {\n    key: \"empty\",\n    value: function empty() {\n      this.record = [], this.recordIndex = -1, this.emitHistoryChanged();\n    }\n  }, {\n    key: \"initRecord\",\n    value: function initRecord(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = t.length > 0 || e;\n      this.record = i ? [B.cloneDeep(t)] : [], this.minRecordIndex = i ? 0 : -1, this.recordIndex = 0;\n    }\n  }]);\n  return ae;\n}();\nvar ni = /*#__PURE__*/function () {\n  function ni(t, e) {\n    var _this7 = this;\n    _classCallCheck(this, ni);\n    this.rcTime = 0, this.mouseDownTime = 0, this.onMouseDown = function () {\n      _this7.mouseDownTime = new Date().getTime();\n    }, this.dom = t, this.isDoubleClick = !1, this.delay = e;\n  }\n  _createClass(ni, [{\n    key: \"getRcTime\",\n    value: function getRcTime() {\n      return this.rcTime;\n    }\n  }, {\n    key: \"getCoord\",\n    value: function getCoord(t) {\n      return {\n        x: t.clientX,\n        y: t.clientY\n      };\n    }\n  }, {\n    key: \"removeEvent\",\n    value: function removeEvent() {\n      !this.dom || (this.dom.removeEventListener(\"mouseup\", this.mouseUp), this.dom.removeEventListener(\"mousemove\", this.mouseMove), this.dom.removeEventListener(\"dblclick\", this.dblclick), this.dom.removeEventListener(\"mousedown\", this.onMouseDown));\n    }\n  }, {\n    key: \"addEvent\",\n    value: function addEvent(t, e, i, r) {\n      var _this8 = this;\n      !this.dom || (this.removeEvent(), this.mouseUp = function (n) {\n        var o = new Date().getTime(),\n          a = r ? r(n) : !0;\n        if (o - _this8.mouseDownTime > _this8.delay || a !== !0) {\n          t(n);\n          return;\n        }\n        if (n.button === 2) if (_this8.rcTime === 0) setTimeout(function () {\n          _this8.rcTime = 0;\n        }, _this8.delay), _this8.rcTime = o;else {\n          o - _this8.rcTime < _this8.delay && (i(n), clearTimeout(_this8.setTimeFun), _this8.cacheFunction = void 0), _this8.rcTime = 0;\n          return;\n        }\n        _this8.setTimeFun && clearTimeout(_this8.setTimeFun), _this8.clickCoord = _this8.getCoord(n), _this8.cacheFunction = function () {\n          return t(n);\n        }, _this8.setTimeFun = setTimeout(function () {\n          if (_this8.isDoubleClick) {\n            _this8.isDoubleClick = !1;\n            return;\n          }\n          _this8.cacheFunction(), _this8.clickCoord = void 0;\n        }, _this8.delay);\n      }, this.mouseMove = function (n) {\n        var o = _this8.getCoord(n);\n        _this8.clickCoord && !w.getIsInScope(o, _this8.clickCoord, 10) && (_this8.cacheFunction && _this8.cacheFunction(), _this8.clickCoord = void 0, _this8.cacheFunction = null, clearTimeout(_this8.setTimeFun));\n      }, this.dblclick = function (n) {\n        _this8.isDoubleClick = !0, _this8.clickCoord = void 0, e(n);\n      }, this.dom.addEventListener(\"mouseup\", this.mouseUp), this.dom.addEventListener(\"mousemove\", this.mouseMove), this.dom.addEventListener(\"dblclick\", this.dblclick), this.dom.addEventListener(\"mousedown\", this.onMouseDown));\n    }\n  }, {\n    key: \"clearRightDblClick\",\n    value: function clearRightDblClick() {\n      this.rcTime = 0;\n    }\n  }]);\n  return ni;\n}();\nvar oi = /*#__PURE__*/function () {\n  function oi() {\n    _classCallCheck(this, oi);\n  }\n  _createClass(oi, null, [{\n    key: \"getInitImgPos\",\n    value: function getInitImgPos(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n      var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n      (i === 90 || i === 270) && (e = {\n        width: e.height,\n        height: e.width\n      });\n      var o = t.width * r / e.width,\n        a = t.height * r / e.height;\n      var l = n ? 1 : Math.min(o, a);\n      var h = {\n          x: (t.width - e.width * l) / 2,\n          y: (t.height - e.height * l) / 2\n        },\n        c = e.width * l,\n        g = e.height * l;\n      return n && (l = 1), {\n        zoom: l,\n        currentPos: h,\n        imgInfo: {\n          width: c,\n          height: g\n        }\n      };\n    }\n  }, {\n    key: \"getBasicRecPos\",\n    value: function getBasicRecPos(t, e, i) {\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : .9;\n      var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n      var o = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;\n      if (e && t) {\n        var a = e.x,\n          l = e.y,\n          h = e.height,\n          c = e.width;\n        var g = i.height / h;\n        c / h > i.width / i.height && (g = i.width / c);\n        var d = o ? 1 : g * r * n,\n          u = {\n            x: i.width / 2,\n            y: i.height / 2\n          },\n          f = {\n            x: (a + c / 2) * d,\n            y: (l + h / 2) * d\n          };\n        return {\n          currentPos: {\n            x: u.x - f.x,\n            y: u.y - f.y\n          },\n          innerZoom: d\n        };\n      }\n      return !1;\n    }\n  }]);\n  return oi;\n}();\nvar wr = /*#__PURE__*/function () {\n  function wr() {\n    _classCallCheck(this, wr);\n  }\n  _createClass(wr, null, [{\n    key: \"renderInvalidPage\",\n    value: function renderInvalidPage(t, e, i) {\n      var r = document.createElement(\"div\");\n      return r.setAttribute(\"style\", \"\\n        position: absolute;\\n        left: 0px;\\n        top: 0px;\\n        width: \".concat(e.width, \"px;\\n        height: \").concat(e.height, \"px;\\n        background: rgba(255, 87, 34, 1);\\n        overflow: hidden;\\n        color: white;\\n        display: flex;\\n        justify-content: center;\\n        align-items: center;\\n        font-size: 30px;\\n        opacity: 0.7;\\n        z-index: 30;\\n      \")), r.innerHTML = H.getMessagesByLocale(C.InvalidImage, i), t.appendChild(r), r;\n    }\n  }]);\n  return wr;\n}();\nvar ut = [1, 5, 10, 20, 30, 50, 80, 100].concat(Array.from({\n  length: 9\n}).map(function (s, t) {\n  return (t + 2) * 100;\n}));\nvar Ut = /*#__PURE__*/_createClass(function Ut() {\n  _classCallCheck(this, Ut);\n});\nUt.zoomChanged = function (s, t) {\n  var e = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : It.Linear;\n  switch (e) {\n    case It.Intelligence:\n      {\n        var i = Math.max.apply(Math, _toConsumableArray(ut)),\n          r = Math.min.apply(Math, _toConsumableArray(ut)),\n          n = ut.slice(0, ut.length).findIndex(function (a, l) {\n            return s >= a && (s < ut[l + 1] || a === i);\n          });\n        var o;\n        if (n === -1) s >= r && s <= i ? o = t ? i : r : o = t ? r : s;else {\n          var a = t ? n + 1 : n - (ut.includes(s) ? 1 : 0);\n          o = ut[L.withinRange(a, [0, ut.length - 1])];\n        }\n        return o;\n      }\n    default:\n      {\n        var _i3 = t ? 2 : 1 / 2;\n        return s * _i3;\n      }\n  }\n}, Ut.wheelChangePos = function (s, t, e, i) {\n  var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  var _r$zoom = r.zoom,\n    n = _r$zoom === void 0 ? 1 : _r$zoom,\n    _r$innerZoom = r.innerZoom,\n    o = _r$innerZoom === void 0 ? 1 : _r$innerZoom,\n    _r$basicZoom = r.basicZoom,\n    a = _r$basicZoom === void 0 ? 1 : _r$basicZoom,\n    _r$zoomMax = r.zoomMax,\n    l = _r$zoomMax === void 0 ? 1e3 : _r$zoomMax,\n    _r$rotate = r.rotate,\n    h = _r$rotate === void 0 ? 0 : _r$rotate,\n    c = i.x,\n    g = i.y,\n    d = parseFloat((n + 1 / 10).toFixed(1)) / 5;\n  if (s && t) {\n    var u = s.width,\n      f = s.height;\n    [90, 270].includes(h) && (u = s.height, f = s.width);\n    var v = u * o,\n      b = f * o,\n      p = t.x - c,\n      y = t.y - g,\n      I = p / v,\n      _ = y / b;\n    var A = n + e * d;\n    A = L.withinRange(A, [a, l]);\n    var E = u * A * I,\n      N = f * A * _,\n      k = c + (p - E),\n      V = g + (y - N);\n    return {\n      zoom: A,\n      currentPos: {\n        x: k,\n        y: V\n      },\n      imgInfo: {\n        width: u * A,\n        height: f * A\n      },\n      ratio: d\n    };\n  }\n  return null;\n};\nvar Ir = /*#__PURE__*/function () {\n  function Ir() {\n    _classCallCheck(this, Ir);\n    this._events = new Map();\n  }\n  _createClass(Ir, [{\n    key: \"on\",\n    value: function on(t, e) {\n      var i = this._events.get(t) || [];\n      i.some(function (r) {\n        return r === e;\n      }) || this._events.set(t, i.concat(e));\n    }\n  }, {\n    key: \"singleOn\",\n    value: function singleOn(t, e) {\n      this._events.set(t, [e]);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(t) {\n      for (var _len = arguments.length, e = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        e[_key - 1] = arguments[_key];\n      }\n      var i = this._events.get(t);\n      i && i.forEach(function (r) {\n        r && r.apply(void 0, e);\n      });\n    }\n  }, {\n    key: \"unbind\",\n    value: function unbind(t, e) {\n      var i = this._events.get(t);\n      i && this._events.set(t, i.filter(function (r) {\n        return r !== e;\n      }));\n    }\n  }, {\n    key: \"unbindAll\",\n    value: function unbindAll(t) {\n      this._events.delete(t);\n    }\n  }]);\n  return Ir;\n}();\nvar Lr = Object.defineProperty,\n  Pr = Object.defineProperties,\n  Cr = Object.getOwnPropertyDescriptors,\n  ai = Object.getOwnPropertySymbols,\n  Dr = Object.prototype.hasOwnProperty,\n  _r = Object.prototype.propertyIsEnumerable,\n  li = function li(s, t, e) {\n    return t in s ? Lr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Pt = function Pt(s, t) {\n    for (var e in t || (t = {})) Dr.call(t, e) && li(s, e, t[e]);\n    if (ai) {\n      var _iterator9 = _createForOfIteratorHelper(ai(t)),\n        _step9;\n      try {\n        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n          var e = _step9.value;\n          _r.call(t, e) && li(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator9.e(err);\n      } finally {\n        _iterator9.f();\n      }\n    }\n    return s;\n  },\n  Ar = function Ar(s, t) {\n    return Pr(s, Cr(t));\n  },\n  le = function le(s, t, e) {\n    return new Promise(function (i, r) {\n      var n = function n(l) {\n          try {\n            a(e.next(l));\n          } catch (h) {\n            r(h);\n          }\n        },\n        o = function o(l) {\n          try {\n            a(e.throw(l));\n          } catch (h) {\n            r(h);\n          }\n        },\n        a = function a(l) {\n          return l.done ? i(l.value) : Promise.resolve(l.value).then(n, o);\n        };\n      a((e = e.apply(s, t)).next());\n    });\n  };\nvar zt = {\n    min: .2,\n    max: 1e3,\n    ratio: .4\n  },\n  he = function he(s) {\n    return Ot(s) && !isNaN(s);\n  },\n  it = /*#__PURE__*/function (_Ir) {\n    _inherits(it, _Ir);\n    var _super = _createSuper(it);\n    function it(s) {\n      var _this9;\n      _classCallCheck(this, it);\n      _this9 = _super.call(this);\n      _this9.isDrag = !1, _this9.isSpaceKey = !1, _this9.innerZoom = 1, _this9.basicZoom = .01, _this9.isSpaceClick = !1, _this9.isDragStart = !1, _this9.startTime = 0, _this9._coordinateCacheKey = \"\", _this9._zoomCacheKey = \"\", _this9.initImgPos = function () {\n        return le(_assertThisInitialized(_this9), null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n          var c, g, d, u, _oi$getInitImgPos, f, v, b, p, y;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!this.imgNode || this.imgNode.width === 0)) {\n                  _context.next = 2;\n                  break;\n                }\n                return _context.abrupt(\"return\");\n              case 2:\n                d = (c = this._imgAttribute) == null ? void 0 : c.zoomRatio, u = (g = this._imgAttribute) == null ? void 0 : g.isOriginalSize, _oi$getInitImgPos = oi.getInitImgPos(this.size, {\n                  width: this.imgNode.width,\n                  height: this.imgNode.height\n                }, this.rotate, d, u), f = _oi$getInitImgPos.currentPos, v = _oi$getInitImgPos.imgInfo, b = _oi$getInitImgPos.zoom, p = it.Cache.get(this._coordinateCacheKey);\n                this.setCurrentPos(p || f), this.currentPosStorage = p || f;\n                y = 0;\n                u ? it.Cache.set(this._zoomCacheKey, 1) : y = it.Cache.get(this._zoomCacheKey), this.imgInfo = v, this.setZoom(y || b), this.innerZoom = y || b, this.renderReady = !0, this.render(), this.renderBasicCanvas(), this.emit(\"dependRender\"), this.emit(\"renderZoom\", b);\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        }));\n      }, _this9.getCurrentPos = function (c) {\n        var _assertThisInitialize = _assertThisInitialized(_this9),\n          g = _assertThisInitialize._firstClickCoordinate,\n          d = _assertThisInitialize.currentPosStorage;\n        try {\n          var u;\n          return g && d ? u = {\n            y: d.y + c.y - g.y,\n            x: d.x + c.x - g.x\n          } : u = {\n            x: 0,\n            y: 0\n          }, u;\n        } catch (u) {\n          return console.error(u), {\n            x: 0,\n            y: 0\n          };\n        }\n      }, _this9.wheelChangePos = function (c, g, d) {\n        var _assertThisInitialize2 = _assertThisInitialized(_this9),\n          u = _assertThisInitialize2.currentPos,\n          f = _assertThisInitialize2.imgNode;\n        if (!f) {\n          console.error(\"unable to load image\");\n          return;\n        }\n        if (_this9.zoom === _this9.basicZoom && g === -1) return;\n        var v = Ut.wheelChangePos(f, c, g, u, {\n          zoom: d || _this9.zoom,\n          innerZoom: _this9.innerZoom,\n          basicZoom: _this9.basicZoom,\n          zoomMax: zt.max,\n          rotate: _this9.rotate\n        });\n        if (!v) return;\n        var b = v.currentPos,\n          p = v.ratio,\n          y = v.zoom,\n          I = v.imgInfo;\n        _this9._isValidCoordinate(b) && it.Cache.set(_this9._coordinateCacheKey, b), he(y) && it.Cache.set(_this9._zoomCacheKey, y), _this9.innerZoom = y, _this9.setZoom(y), _this9.setCurrentPos(b), _this9.currentPosStorage = b, _this9.imgInfo = I, zt.ratio = p, _this9.emit(\"renderZoom\", y, u);\n      }, _this9.zoomChanged = function (c) {\n        var g = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : It.Linear;\n        var d = Ut.zoomChanged(_this9.zoom, c, g);\n        _this9.wheelChangePos(_this9.getGetCenterCoordinate(), d > _this9.zoom ? 1 : -1, d), _this9.render(), _this9.renderBasicCanvas();\n      }, _this9.drawImg = function () {\n        !_this9.imgNode || m.drawImg(_this9.basicCanvas, _this9.imgNode, {\n          zoom: _this9.zoom,\n          currentPos: _this9.currentPos,\n          rotate: _this9.rotate,\n          imgAttribute: _this9._imgAttribute\n        });\n      };\n      var t, e, i, r, n, o, a, l, h;\n      _this9.saveDataEvent = new CustomEvent(\"saveLabelResultToImg\", {}), _this9.renderReady = !1, _this9.container = s.container, _this9.showDefaultCursor = s.showDefaultCursor || !1, _this9.basicCanvas || _this9.initCanvas(s.size), _this9.imgNode = s.imgNode, s.imgNode && s.imgNode.src && (_this9._coordinateCacheKey = \"coordinate::\".concat(s.imgNode.src), _this9._zoomCacheKey = \"zoom::\".concat(s.imgNode.src)), _this9.isImgError = !s.imgNode, _this9.basicImgInfo = {\n        width: (e = (t = s.imgNode) == null ? void 0 : t.width) != null ? e : 0,\n        height: (r = (i = s.imgNode) == null ? void 0 : i.height) != null ? r : 0,\n        valid: !0,\n        rotate: 0\n      }, _this9.forbidOperation = (n = s.forbidOperation) != null ? n : !1, _this9.forbidBasicResultRender = (o = s.forbidBasicResultRender) != null ? o : !1, _this9.size = s.size, _this9.currentPos = {\n        x: 0,\n        y: 0\n      }, _this9.zoom = 1, _this9.coord = {\n        x: -1,\n        y: -1\n      }, _this9.currentPosStorage = {\n        x: 0,\n        y: 0\n      }, _this9.isShowCursor = !1, _this9.isShowOrder = !1, _this9.isShowAttributeText = !0, _this9.style = {\n        strokeColor: pt[4],\n        fillColor: pt[4],\n        strokeWidth: 2 * (window == null ? void 0 : window.devicePixelRatio),\n        opacity: 1\n      }, _this9.attributeLockList = [], _this9.history = new ae(), _this9.style = (a = s.style) != null ? a : {}, _this9._imgAttribute = (l = s.imgAttribute) != null ? l : {}, _this9.isHidden = !1, _this9.dragStatus = O.Wait, _this9.defaultAttribute = (h = s == null ? void 0 : s.defaultAttribute) != null ? h : \"\\u65E0\\u6807\\u7B7E\", _this9.forbidCursorLine = !!s.forbidCursorLine, _this9.lang = ht.Zh, _this9.onMouseDown = _this9.onMouseDown.bind(_assertThisInitialized(_this9)), _this9.onMouseMove = _this9.onMouseMove.bind(_assertThisInitialized(_this9)), _this9.onMouseLeave = _this9.onMouseLeave.bind(_assertThisInitialized(_this9)), _this9.onMouseUp = _this9.onMouseUp.bind(_assertThisInitialized(_this9)), _this9.onKeyDown = _this9.onKeyDown.bind(_assertThisInitialized(_this9)), _this9.onKeyUp = _this9.onKeyUp.bind(_assertThisInitialized(_this9)), _this9.onWheel = _this9.onWheel.bind(_assertThisInitialized(_this9)), _this9.onLeftDblClick = _this9.onLeftDblClick.bind(_assertThisInitialized(_this9)), _this9.onRightDblClick = _this9.onRightDblClick.bind(_assertThisInitialized(_this9)), _this9.onClick = _this9.onClick.bind(_assertThisInitialized(_this9)), _this9.clearImgDrag = _this9.clearImgDrag.bind(_assertThisInitialized(_this9)), _this9.dblClickListener = new ni(_this9.container, 200), _this9.coordUtils = new dn(_assertThisInitialized(_this9)), _this9.coordUtils.setBasicImgInfo(_this9.basicImgInfo);\n      return _this9;\n    }\n    _createClass(it, [{\n      key: \"onContextmenu\",\n      value: function onContextmenu(s) {\n        s.preventDefault();\n      }\n    }, {\n      key: \"ctx\",\n      get: function get() {\n        var s;\n        return this._ctx || ((s = this.canvas) == null ? void 0 : s.getContext(\"2d\"));\n      }\n    }, {\n      key: \"basicCtx\",\n      get: function get() {\n        var s;\n        return (s = this.basicCanvas) == null ? void 0 : s.getContext(\"2d\");\n      }\n    }, {\n      key: \"rotate\",\n      get: function get() {\n        var s, t;\n        return (t = (s = this.basicImgInfo) == null ? void 0 : s.rotate) != null ? t : 0;\n      }\n    }, {\n      key: \"valid\",\n      get: function get() {\n        var s, t;\n        return (t = (s = this.basicImgInfo) == null ? void 0 : s.valid) != null ? t : !0;\n      }\n    }, {\n      key: \"baseIcon\",\n      get: function get() {\n        return Ze[this.style.color];\n      }\n    }, {\n      key: \"defaultCursor\",\n      get: function get() {\n        return this.showDefaultCursor ? \"default\" : \"none\";\n      }\n    }, {\n      key: \"dataList\",\n      get: function get() {\n        return [];\n      }\n    }, {\n      key: \"setPrevResultList\",\n      value: function setPrevResultList(s) {\n        this.prevResultList = s;\n      }\n    }, {\n      key: \"setAllAttributes\",\n      value: function setAllAttributes(s) {\n        this.allAttributes = s;\n      }\n    }, {\n      key: \"hasMarkerConfig\",\n      get: function get() {\n        return this.config.markerConfigurable === !0 && this.config.markerList && this.config.markerList.length > 0;\n      }\n    }, {\n      key: \"setZoom\",\n      value: function setZoom(s) {\n        this.zoom = s, this.coordUtils.setZoomAndCurrentPos(this.zoom, this.currentPos);\n      }\n    }, {\n      key: \"setCurrentPos\",\n      value: function setCurrentPos(s) {\n        this.currentPos = s, this.coordUtils.setZoomAndCurrentPos(this.zoom, this.currentPos);\n      }\n    }, {\n      key: \"setReferenceData\",\n      value: function setReferenceData(s) {\n        this.referenceData = s;\n      }\n    }, {\n      key: \"updatePosition\",\n      value: function updatePosition(s) {\n        var t = s.zoom,\n          e = s.currentPos;\n        this.setZoom(t), this.setCurrentPos(e), this.currentPosStorage = e, this.innerZoom = t, this.renderBasicCanvas(), this.render();\n      }\n    }, {\n      key: \"setLang\",\n      value: function setLang(s) {\n        this.lang = s;\n      }\n    }, {\n      key: \"setShowDefaultCursor\",\n      value: function setShowDefaultCursor(s) {\n        this.showDefaultCursor = s, this.container.style.cursor = this.defaultCursor;\n      }\n    }, {\n      key: \"forbidMouseOperation\",\n      get: function get() {\n        return this.forbidOperation || this.valid === !1;\n      }\n    }, {\n      key: \"pixelRatio\",\n      get: function get() {\n        var s;\n        return at.getPixelRatio((s = this.canvas) == null ? void 0 : s.getContext(\"2d\"));\n      }\n    }, {\n      key: \"init\",\n      value: function init() {\n        return le(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                this.eventUnbinding();\n                _context2.next = 3;\n                return this.initPosition();\n              case 3:\n                this.eventBinding();\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, this);\n        }));\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this.destroyCanvas(), this.eventUnbinding(), this.clearCache();\n      }\n    }, {\n      key: \"clearCache\",\n      value: function clearCache() {\n        it.Cache.clear();\n      }\n    }, {\n      key: \"clearCachedCoordinateAndZoom\",\n      value: function clearCachedCoordinateAndZoom() {\n        it.Cache.delete(this._coordinateCacheKey), it.Cache.delete(this._zoomCacheKey);\n      }\n    }, {\n      key: \"initCanvas\",\n      value: function initCanvas(s) {\n        var t, e;\n        var i = this.pixelRatio,\n          r = this.container.querySelectorAll(\"canvas\");\n        if (r && r.length > 0) this.canvas = r[1], this.basicCanvas = r[0], this.clearExtraDom(this.container);else {\n          var n = document.createElement(\"canvas\");\n          n.width = s.width * i, n.height = s.height * i, n.style.width = \"\".concat(s.width, \"px\"), n.style.height = \"\".concat(s.height, \"px\"), n.style.left = \"0\", n.style.top = \"0\", n.style.zIndex = \"0\";\n          var o = document.createElement(\"canvas\");\n          o.style.position = \"absolute\", o.style.left = \"0\", o.style.top = \"0\", o.style.zIndex = \"10\", o.style.width = \"\".concat(s.width, \"px\"), o.style.height = \"\".concat(s.height, \"px\"), o.width = s.width * i, o.height = s.height * i, this.canvas = o, this.basicCanvas = n, this.container.appendChild(n), this.container.appendChild(o);\n        }\n        this.container.style.cursor = this.defaultCursor, (t = this.ctx) == null || t.scale(i, i), (e = this.basicCtx) == null || e.scale(i, i);\n      }\n    }, {\n      key: \"clearExtraDom\",\n      value: function clearExtraDom(s) {\n        var t = s.childNodes;\n        if (t && t.length > 0) for (var e = 0; e < t.length; e++) t[e].nodeName !== \"CANVAS\" && s.removeChild(t[e]);\n      }\n    }, {\n      key: \"destroyCanvas\",\n      value: function destroyCanvas() {\n        this.canvas && this.container.contains(this.canvas) && this.container.removeChild(this.canvas), this.basicCanvas && this.container.contains(this.basicCanvas) && this.container.removeChild(this.basicCanvas), this.clearInvalidPage(), this.clearImgDrag();\n      }\n    }, {\n      key: \"setStyle\",\n      value: function setStyle(s) {\n        this.style = s, this.render();\n      }\n    }, {\n      key: \"setImgNode\",\n      value: function setImgNode(s) {\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        this.imgNode = s, s && (this._coordinateCacheKey = \"coordinate::\".concat(s.src), this._zoomCacheKey = \"zoom::\".concat(s.src)), this.setBasicImgInfo(Pt({\n          width: s.width,\n          height: s.height,\n          valid: !0,\n          rotate: 0\n        }, t)), this.isImgError === !0 && (this.isImgError = !1, this.emit(\"changeAnnotationShow\")), typeof t.valid == \"boolean\" && this.setValid(t.valid), this.initImgPos();\n      }\n    }, {\n      key: \"setErrorImg\",\n      value: function setErrorImg() {\n        var s = this.isImgError;\n        this.isImgError = !0, this.imgNode = void 0, this._coordinateCacheKey = \"\", this._zoomCacheKey = \"\", this.setBasicImgInfo({\n          width: 0,\n          height: 0,\n          valid: !0,\n          rotate: 0\n        }), s === !1 && this.emit(\"changeAnnotationShow\");\n      }\n    }, {\n      key: \"setBasicImgInfo\",\n      value: function setBasicImgInfo(s) {\n        this.basicImgInfo = s, this.coordUtils.setBasicImgInfo(s);\n      }\n    }, {\n      key: \"setForbidOperation\",\n      value: function setForbidOperation(s) {\n        this.forbidOperation = s, this.render();\n      }\n    }, {\n      key: \"setForbidCursorLine\",\n      value: function setForbidCursorLine(s) {\n        this.forbidCursorLine = s, this.render();\n      }\n    }, {\n      key: \"setIsHidden\",\n      value: function setIsHidden(s) {\n        this.isHidden = s, this.emit(\"hiddenChange\");\n      }\n    }, {\n      key: \"setIsShowOrder\",\n      value: function setIsShowOrder(s) {\n        this.isShowOrder = s, this.render();\n      }\n    }, {\n      key: \"setisShowAttributeText\",\n      value: function setisShowAttributeText(s) {\n        this.isShowAttributeText = s, this.renderBasicCanvas();\n      }\n    }, {\n      key: \"getCoordinate\",\n      value: function getCoordinate(s) {\n        var t = this.canvas.getBoundingClientRect();\n        return {\n          x: s.clientX - t.left,\n          y: s.clientY - t.top\n        };\n      }\n    }, {\n      key: \"getCoordinateUnderZoom\",\n      value: function getCoordinateUnderZoom(s) {\n        var t = this.canvas.getBoundingClientRect();\n        return {\n          x: s.clientX - t.left - this.currentPos.x,\n          y: s.clientY - t.top - this.currentPos.y\n        };\n      }\n    }, {\n      key: \"getGetCenterCoordinate\",\n      value: function getGetCenterCoordinate() {\n        return {\n          x: this.size.width / 2,\n          y: this.size.height / 2\n        };\n      }\n    }, {\n      key: \"initPosition\",\n      value: function initPosition() {\n        return le(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          var s, t, e, i, r, n, o, l, a;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(this.basicResult && this.imgInfo)) {\n                  _context3.next = 13;\n                  break;\n                }\n                s = this.basicResult, t = this.size, e = this.imgNode, i = this._imgAttribute, r = this.imgInfo, n = this.dependToolName;\n                if (!(s && e && n)) {\n                  _context3.next = 11;\n                  break;\n                }\n                o = s;\n                _context3.t0 = n;\n                _context3.next = _context3.t0 === P.Polygon ? 7 : _context3.t0 === P.Line ? 7 : 9;\n                break;\n              case 7:\n                if (s.pointList) {\n                  l = L.calcViewportBoundaries(s.pointList);\n                  o = {\n                    x: l.left,\n                    y: l.top,\n                    width: l.right - l.left,\n                    height: l.bottom - l.top\n                  };\n                }\n                return _context3.abrupt(\"break\", 9);\n              case 9:\n                a = oi.getBasicRecPos(e, o, t, void 0, i == null ? void 0 : i.zoomRatio, i == null ? void 0 : i.isOriginalSize);\n                a && (this.setCurrentPos(a.currentPos), this.currentPosStorage = this.currentPos, this.imgInfo = Ar(Pt({}, r), {\n                  width: r.width / this.innerZoom * a.innerZoom,\n                  height: r.height / this.innerZoom * a.innerZoom\n                }), this.innerZoom = a.innerZoom, this.setZoom(a.innerZoom), this.render(), this.renderBasicCanvas());\n              case 11:\n                _context3.next = 15;\n                break;\n              case 13:\n                _context3.next = 15;\n                return this.initImgPos();\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, this);\n        }));\n      }\n    }, {\n      key: \"undo\",\n      value: function undo() {\n        this.history.undo();\n      }\n    }, {\n      key: \"redo\",\n      value: function redo() {\n        this.history.redo();\n      }\n    }, {\n      key: \"clearCanvas\",\n      value: function clearCanvas() {\n        var s;\n        (s = this.ctx) == null || s.clearRect(0, 0, this.size.width, this.size.height);\n      }\n    }, {\n      key: \"clearBasicCanvas\",\n      value: function clearBasicCanvas() {\n        var s;\n        (s = this.basicCtx) == null || s.clearRect(0, 0, this.size.width, this.size.height);\n      }\n    }, {\n      key: \"eventBinding\",\n      value: function eventBinding() {\n        this.dblClickListener.addEvent(function () {}, this.onLeftDblClick, this.onRightDblClick), this.container.addEventListener(\"mousedown\", this.onMouseDown), this.container.addEventListener(\"mousemove\", this.onMouseMove), this.container.addEventListener(\"mouseup\", this.onMouseUp), this.container.addEventListener(\"mouseleave\", this.onMouseLeave), this.container.addEventListener(\"click\", this.onClick), this.container.addEventListener(\"wheel\", this.onWheel), document.addEventListener(\"keydown\", this.onKeyDown), document.addEventListener(\"keyup\", this.onKeyUp), typeof window != \"undefined\" && window.parent.document.addEventListener(\"contextmenu\", this.onContextmenu, !1);\n      }\n    }, {\n      key: \"eventUnbinding\",\n      value: function eventUnbinding() {\n        this.container.removeEventListener(\"mousedown\", this.onMouseDown), this.container.removeEventListener(\"mousemove\", this.onMouseMove), this.container.removeEventListener(\"mouseup\", this.onMouseUp), this.container.removeEventListener(\"mouseleave\", this.onMouseLeave), this.container.removeEventListener(\"wheel\", this.onWheel), this.container.removeEventListener(\"click\", this.onClick), document.removeEventListener(\"keydown\", this.onKeyDown), document.removeEventListener(\"keyup\", this.onKeyUp), typeof window != \"undefined\" && window.parent.document.removeEventListener(\"contextmenu\", this.onContextmenu, !1), this.dblClickListener.removeEvent();\n      }\n    }, {\n      key: \"clearImgDrag\",\n      value: function clearImgDrag() {\n        this.isDrag = !1, this.isDragStart = !1, this.isSpaceClick = !1, this.startTime = 0, this.container.style.cursor = this.defaultCursor, this.forbidCursorLine = !1;\n      }\n    }, {\n      key: \"onMouseDown\",\n      value: function onMouseDown(s) {\n        if (!this.canvas || this.isImgError) return !0;\n        var t = this.getCoordinate(s);\n        (this.isSpaceKey && s.button === 0 || s.button === 2) && (s.stopPropagation(), this._firstClickCoordinate = t, this.currentPosStorage = this.currentPos, this.isSpaceClick = !0, this.isDragStart = !0, this.startTime = new Date().getTime());\n      }\n    }, {\n      key: \"onMouseMove\",\n      value: function onMouseMove(s) {\n        if (!this.canvas || this.isImgError) return !0;\n        var t = this.getCoordinate(s);\n        this.isShowCursor && (this.coord = t);\n        try {\n          if (!t || !Ot(t == null ? void 0 : t.x) || !Ot(t == null ? void 0 : t.y)) throw new Error(\"coord error\");\n          if (this.coord = t, (this.isSpaceClick || this.isDragStart) && this._firstClickCoordinate) {\n            var e = this.getCurrentPos(t);\n            this.setCurrentPos(e), this.isDrag = !0, this.container.style.cursor = \"grabbing\", this.forbidCursorLine = !0, this.renderBasicCanvas(), this.emit(\"dependRender\"), this.emit(\"dragMove\", {\n              currentPos: e,\n              zoom: this.zoom\n            });\n          }\n          this.render();\n        } catch (e) {\n          console.error(e);\n        }\n      }\n    }, {\n      key: \"onMouseUp\",\n      value: function onMouseUp(s) {\n        if (!this.canvas || this.isImgError) return !0;\n        if (this.container.style.cursor = this.defaultCursor, this.forbidCursorLine = !1, this.isDrag = !1, this.isDragStart = !1, this.isSpaceClick = !1, this.startTime !== 0 && this._firstClickCoordinate) {\n          var t = new Date().getTime(),\n            e = this.getCoordinate(s),\n            i = this.getCurrentPos(e);\n          if (this._isValidCoordinate(i) && it.Cache.set(this._coordinateCacheKey, i), t - this.startTime > 1e3 || this.isSpaceKey === !0 || M.calcTwoPointDistance(e, this._firstClickCoordinate) > 10) return s.stopPropagation(), this.startTime = 0, this.render(), !0;\n        }\n        this.startTime = 0, this.render();\n      }\n    }, {\n      key: \"onMouseLeave\",\n      value: function onMouseLeave() {\n        this.clearImgDrag();\n      }\n    }, {\n      key: \"onClick\",\n      value: function onClick(s) {}\n    }, {\n      key: \"onLeftDblClick\",\n      value: function onLeftDblClick(s) {}\n    }, {\n      key: \"onRightDblClick\",\n      value: function onRightDblClick(s) {\n        this.clearImgDrag();\n      }\n    }, {\n      key: \"onKeyDown\",\n      value: function onKeyDown(s) {\n        switch (s.keyCode === S.Alt && s.preventDefault(), s.keyCode) {\n          case S.Space:\n            this.isSpaceKey = !0;\n            break;\n        }\n        return !0;\n      }\n    }, {\n      key: \"onKeyUp\",\n      value: function onKeyUp(s) {\n        switch (s.keyCode) {\n          case S.Space:\n            this.isSpaceKey = !1;\n            break;\n        }\n      }\n    }, {\n      key: \"onWheel\",\n      value: function onWheel(s) {\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n        if (!this.imgNode || !this.coord) return;\n        s.preventDefault(), s.stopPropagation();\n        var e = this.getCoordinate(s),\n          i = s.deltaY || s.wheelDelta;\n        var r = 0;\n        i > 0 && this.zoom > zt.min && (r = -1), i < 0 && this.zoom < zt.max && (r = 1), this.wheelChangePos(e, r), this.emit(\"dependRender\"), t && this.render(), this.renderBasicCanvas();\n      }\n    }, {\n      key: \"renderCursorLine\",\n      value: function renderCursorLine() {\n        var _this10 = this;\n        var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (t) {\n          return (t = _this10.style.lineColor[0]) != null ? t : \"\";\n        }();\n        if (!this.ctx || this.forbidCursorLine) return;\n        var _this$coord = this.coord,\n          t = _this$coord.x,\n          e = _this$coord.y;\n        m.drawLine(this.canvas, {\n          x: 0,\n          y: e\n        }, {\n          x: 1e4,\n          y: e\n        }, {\n          color: s\n        }), m.drawLine(this.canvas, {\n          x: t,\n          y: 0\n        }, {\n          x: t,\n          y: 1e4\n        }, {\n          color: s\n        }), m.drawCircleWithFill(this.canvas, {\n          x: t,\n          y: e\n        }, 1, {\n          color: \"white\"\n        });\n      }\n    }, {\n      key: \"setSize\",\n      value: function setSize(s) {\n        var t;\n        this.size = s, this.container.contains(this.canvas) && (this.destroyCanvas(), this.initCanvas(s), this.eventUnbinding(), this.init(), ((t = this.basicImgInfo) == null ? void 0 : t.valid) === !1 && this.renderInvalidPage());\n      }\n    }, {\n      key: \"setImgAttribute\",\n      value: function setImgAttribute(s) {\n        var t = this._imgAttribute;\n        if (this._imgAttribute = s, (t == null ? void 0 : t.zoomRatio) !== s.zoomRatio || t.isOriginalSize !== s.isOriginalSize) {\n          this.initImgPos();\n          return;\n        }\n        this.renderBasicCanvas(), this.render();\n      }\n    }, {\n      key: \"clearResult\",\n      value: function clearResult(s) {}\n    }, {\n      key: \"_isValidCoordinate\",\n      value: function _isValidCoordinate(s) {\n        return s ? he(s.x) && he(s.y) : !1;\n      }\n    }, {\n      key: \"setValid\",\n      value: function setValid(s) {\n        this.basicImgInfo.valid = s, s === !1 ? (this.renderInvalidPage(), this.clearResult(!1)) : this.clearInvalidPage();\n      }\n    }, {\n      key: \"setRotate\",\n      value: function setRotate(s) {\n        this.basicImgInfo.rotate = s;\n      }\n    }, {\n      key: \"setBasicResult\",\n      value: function setBasicResult(s) {\n        this.basicResult = s, this.coordUtils.setBasicResult(s), this.initPosition(), this.emit(\"dependRender\");\n      }\n    }, {\n      key: \"setDependName\",\n      value: function setDependName(s, t) {\n        this.dependToolName = s, this.coordUtils.setDependInfo(s, t);\n      }\n    }, {\n      key: \"setAttributeLockList\",\n      value: function setAttributeLockList(s) {\n        this.attributeLockList = s, this.render();\n      }\n    }, {\n      key: \"setConfig\",\n      value: function setConfig(s) {\n        this.config = x.jsonParser(s);\n      }\n    }, {\n      key: \"setDataInjectionAtCreation\",\n      value: function setDataInjectionAtCreation(s) {\n        this.dataInjectionAtCreation = s;\n      }\n    }, {\n      key: \"setRenderEnhance\",\n      value: function setRenderEnhance(s) {\n        this.renderEnhance = s;\n      }\n    }, {\n      key: \"updateRotate\",\n      value: function updateRotate() {\n        if (this.dependToolName) return this.emit(\"messageInfo\", H.getMessagesByLocale(C.NoRotateInDependence, this.lang)), !1;\n        if (this.dataList.length > 0) return this.emit(\"messageInfo\", H.getMessagesByLocale(C.NoRotateNotice, this.lang)), !1;\n        var s = L.getRotate(this.basicImgInfo.rotate);\n        this.basicImgInfo.rotate = s, this.initImgPos(), this.emit(\"updateResult\");\n      }\n    }, {\n      key: \"getColor\",\n      value: function getColor() {\n        var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.config;\n        var e;\n        if ((t == null ? void 0 : t.attributeConfigurable) === !0 && this.style.attributeColor) {\n          var n = T.getAttributeIndex(s, (e = this.allAttributes) != null ? e : []) + 1;\n          return this.style.attributeColor[n];\n        }\n        var _this$style = this.style,\n          i = _this$style.color,\n          r = _this$style.toolColor;\n        return r ? r[i] : Ge.toolColor[\"1\"];\n      }\n    }, {\n      key: \"getLineColor\",\n      value: function getLineColor() {\n        var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n        var t, e;\n        if (((t = this.config) == null ? void 0 : t.attributeConfigurable) === !0) {\n          var n = T.getAttributeIndex(s, (e = this.allAttributes) != null ? e : []) + 1;\n          return this.style.attributeLineColor ? this.style.attributeLineColor[n] : \"\";\n        }\n        var _this$style2 = this.style,\n          i = _this$style2.color,\n          r = _this$style2.lineColor;\n        return i && r ? r[i] : \"\";\n      }\n    }, {\n      key: \"clearInvalidPage\",\n      value: function clearInvalidPage() {\n        this._invalidDOM && this.container && this.container.contains(this._invalidDOM) && (this.container.removeChild(this._invalidDOM), this._invalidDOM = void 0);\n      }\n    }, {\n      key: \"renderInvalidPage\",\n      value: function renderInvalidPage() {\n        !this.container || this._invalidDOM || (this._invalidDOM = wr.renderInvalidPage(this.container, this.size, this.lang));\n      }\n    }, {\n      key: \"renderOtherAnnotation\",\n      value: function renderOtherAnnotation() {\n        var _this11 = this;\n        var s, t, e, i, r, n, o, a, l, h;\n        var c = (t = (s = this.style) == null ? void 0 : s.width) != null ? t : 2;\n        if (this.prevResultList && ((e = this.prevResultList) == null ? void 0 : e.length) > 0) for (var g = 0; g < this.prevResultList.length; g++) {\n          var d = this.prevResultList[g];\n          switch (d.toolName) {\n            case P.Rect:\n              {\n                d.result && d.result.length > 0 && d.result.forEach(function (u) {\n                  if (u.isVisible) {\n                    var f = _this11.getColor(u.attribute),\n                      v = u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke,\n                      b = w.changeRectByZoom(u, _this11.zoom, _this11.currentPos),\n                      y = \"\".concat(Math.round(u.width), \" * \").concat(Math.round(u.height)).length * 7;\n                    if (m.drawRect(_this11.canvas, b, {\n                      isShowOrder: _this11.isShowOrder,\n                      order: u.order,\n                      color: v,\n                      thickness: c\n                    }), _this11.isShowAttributeText) {\n                      var I = 0,\n                        _ = Math.max(20, b.width - y);\n                      m.drawText(_this11.canvas, {\n                        x: b.x,\n                        y: b.y + b.height + 20 + I\n                      }, u.textAttribute, {\n                        color: v,\n                        textMaxWidth: _\n                      });\n                    }\n                  }\n                });\n                break;\n              }\n            case P.Polygon:\n              {\n                d.result.forEach(function (u) {\n                  if (u.isVisible) {\n                    var f = _this11.getColor(u.attribute),\n                      v = w.changePointListByZoom(u.pointList || [], _this11.zoom, _this11.currentPos);\n                    m.drawPolygonWithFillAndLine(_this11.canvas, w.changePointListByZoom(u.pointList, _this11.zoom, _this11.currentPos), {\n                      fillColor: u.valid ? f == null ? void 0 : f.valid.fill : f == null ? void 0 : f.invalid.fill,\n                      strokeColor: u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke,\n                      isClose: !0,\n                      thickness: c\n                    });\n                    var b = u.attribute;\n                    if (_this11.isShowOrder && (b = \"\".concat(u.order, \" \").concat(b)), m.drawText(_this11.canvas, v[0], b, Pt({\n                      color: u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke\n                    }, Z)), _this11.isShowAttributeText) {\n                      var p = v[v.length - 1];\n                      p && p.x && m.drawText(_this11.canvas, {\n                        x: p.x + ot.x,\n                        y: p.y + ot.y\n                      }, u.textAttribute, Pt({\n                        color: u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke\n                      }, Z));\n                    }\n                  }\n                });\n                break;\n              }\n            case P.Line:\n              {\n                d.result.forEach(function (u) {\n                  if (u.isVisible) {\n                    var f = _this11.getColor(u.attribute),\n                      v = w.changePointListByZoom(u.pointList || [], _this11.zoom, _this11.currentPos);\n                    m.drawLineWithPointList(_this11.canvas, w.changePointListByZoom(u.pointList, _this11.zoom, _this11.currentPos), {\n                      color: u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke,\n                      thickness: c\n                    });\n                    var b = u.attribute;\n                    if (_this11.isShowOrder && (b = \"\".concat(u.order, \" \").concat(b)), m.drawText(_this11.canvas, v[0], b, Pt({\n                      color: u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke\n                    }, Z)), _this11.isShowAttributeText) {\n                      var p = _this11.canvas.getContext(\"2d\");\n                      p == null || p.save(), p.font = yt, p.fillStyle = u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke, p.strokeStyle = u.valid ? f == null ? void 0 : f.valid.stroke : f == null ? void 0 : f.invalid.stroke, m.wrapText(_this11.canvas, u.textAttribute, v[1].x - ri.x, v[1].y - ri.y, 200);\n                    }\n                  }\n                });\n                break;\n              }\n            case P.Point:\n              {\n                d.result && d.result.length > 0 && d.result.forEach(function (u) {\n                  if (u.isVisible) {\n                    var _this11$style$width = _this11.style.width,\n                      f = _this11$style$width === void 0 ? 2 : _this11$style$width,\n                      v = w.changePointByZoom(u, _this11.zoom, _this11.currentPos),\n                      b = w.changeRectByZoom(u, _this11.zoom, _this11.currentPos),\n                      p = _this11.getColor(u.attribute);\n                    m.drawCircle(_this11.canvas, b, f, {\n                      startAngleDeg: 0,\n                      endAngleDeg: 360,\n                      thickness: 1,\n                      color: u.valid ? p == null ? void 0 : p.valid.stroke : p == null ? void 0 : p.invalid.stroke,\n                      fill: \"transparent\"\n                    });\n                    var y = u.attribute;\n                    _this11.isShowOrder && (y = \"\".concat(u.order, \"  \").concat(y)), m.drawText(_this11.canvas, {\n                      x: v.x + f / 2 + 4,\n                      y: v.y - f - 4\n                    }, y, {\n                      textAlign: \"center\",\n                      color: u.valid ? p == null ? void 0 : p.valid.stroke : p == null ? void 0 : p.invalid.stroke\n                    }), _this11.isShowAttributeText && m.drawText(_this11.canvas, {\n                      x: v.x + f,\n                      y: v.y + f + 24\n                    }, u.textAttribute, Pt({\n                      color: u.valid ? p == null ? void 0 : p.valid.stroke : p == null ? void 0 : p.invalid.stroke\n                    }, Z));\n                  }\n                });\n                break;\n              }\n            case P.Tag:\n              {\n                if (d.result && d.result.length > 0) {\n                  if (!(((i = d.result) == null ? void 0 : i.length) > 0)) return;\n                  var u = document.createElement(\"div\"),\n                    f = Lt.getTagNameList((r = d == null ? void 0 : d.result[0].result) != null ? r : {}, this.config.tagConfigList);\n                  u.innerHTML = (n = f.reduce(function (b, p) {\n                    return \"\".concat(b).concat(p.keyName, \": \").concat(p.value.join(\" \\u3001 \"), \"\\n\");\n                  }, \"\")) != null ? n : \"\", u.setAttribute(\"id\", \"tagToolTag\"), u.setAttribute(\"style\", \"\\n                  position: absolute;\\n                  top: 0;\\n                  right: 0;\\n                  z-index: 5;\\n                  padding: 0 20px;\\n                  font-size: 15px;\\n                  color: white;\\n                  text-align: right;\\n                  line-height: 32px;\\n                  white-space: pre;\\n                  background: rgba(102, 111, 255, 1);\\n                  opacity: 0.6;\\n                  clear: both;\\n                \");\n                  var v = document.getElementById(\"tagToolTag\");\n                  ((a = (o = this.canvas) == null ? void 0 : o.parentNode) == null ? void 0 : a.contains(v)) || (h = (l = this.canvas) == null ? void 0 : l.parentNode) == null || h.appendChild(u);\n                }\n                break;\n              }\n          }\n        }\n      }\n    }, {\n      key: \"renderBasicCanvas\",\n      value: function renderBasicCanvas() {\n        !this.basicCanvas || (this.clearBasicCanvas(), this.drawImg());\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        !this.canvas || !this.ctx || !this.imgNode || !this.renderReady || (this.clearCanvas(), this.renderOtherAnnotation());\n      }\n    }, {\n      key: \"changeStyle\",\n      value: function changeStyle() {\n        var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.defaultAttribute;\n        this.emit(\"changeStyle\", {\n          attribute: s\n        });\n      }\n    }]);\n    return it;\n  }(Ir);\nvar st = it;\nst.Cache = new Map();\nvar Rr = Object.defineProperty,\n  hi = Object.getOwnPropertySymbols,\n  Tr = Object.prototype.hasOwnProperty,\n  Sr = Object.prototype.propertyIsEnumerable,\n  ci = function ci(s, t, e) {\n    return t in s ? Rr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  di = function di(s, t) {\n    for (var e in t || (t = {})) Tr.call(t, e) && ci(s, e, t[e]);\n    if (hi) {\n      var _iterator10 = _createForOfIteratorHelper(hi(t)),\n        _step10;\n      try {\n        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n          var e = _step10.value;\n          Sr.call(t, e) && ci(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator10.e(err);\n      } finally {\n        _iterator10.f();\n      }\n    }\n    return s;\n  };\nvar ui = {\n    x: 8,\n    y: 26\n  },\n  kr = 2;\nvar Or = /*#__PURE__*/function (_st) {\n  _inherits(Or, _st);\n  var _super2 = _createSuper(Or);\n  function Or(t) {\n    var _this12;\n    _classCallCheck(this, Or);\n    _this12 = _super2.call(this, t);\n    _this12.getHoverRectID = function (e) {\n      var i, r;\n      var n = _this12.getCoordinateUnderZoom(e),\n        o = (r = (i = _this12.resultList.find(function (a) {\n          return a.toolName === P.Rect;\n        })) == null ? void 0 : i.result) != null ? r : [];\n      if (o.length > 0) {\n        var a = o.filter(function (l) {\n          return U.isInRect(n, l, kr, _this12.zoom);\n        });\n        if (a.length === 0) return \"\";\n        if (a.length === 1) return a[0].id;\n        if (a.length > 1) return a.map(function (h) {\n          return {\n            size: h.width * h.height,\n            id: h.id\n          };\n        }).sort(function (h, c) {\n          return h.size - c.size;\n        })[0].id;\n      }\n      return \"\";\n    }, _this12.resultList = [], _this12.hoverID = [], _this12.fillID = [], _this12.render = _this12.render.bind(_assertThisInitialized(_this12)), _this12.drawPolygon = _this12.drawPolygon.bind(_assertThisInitialized(_this12)), _this12.drawRect = _this12.drawRect.bind(_assertThisInitialized(_this12)), _this12.drawTag = _this12.drawTag.bind(_assertThisInitialized(_this12)), _this12.setShowDefaultCursor(!0), _this12.forbidOperation = !0;\n    return _this12;\n  }\n  _createClass(Or, [{\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      var e, i;\n      if (_get(_getPrototypeOf(Or.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return !0;\n      var r = this.mouseHoverID,\n        n = (i = (e = this.resultList.find(function (o) {\n          return o.toolName === P.Rect;\n        })) == null ? void 0 : e.result) != null ? i : [];\n      if (t.button === 0) {\n        var o = [r],\n          a = !0;\n        r && n.find(function (l) {\n          return l.id === r && (l == null ? void 0 : l.isSelected);\n        }) && (a = !1), r || (o = n.map(function (l) {\n          return l.id;\n        }), a = !1), this.emit(\"setSelectedID\", o, a), this.render();\n      }\n    }\n  }, {\n    key: \"updateRotate\",\n    value: function updateRotate() {}\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      if (_get(_getPrototypeOf(Or.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      var e = this.mouseHoverID,\n        i = this.getHoverRectID(t);\n      if (e !== i) {\n        this.mouseHoverID = i;\n        var r = [i];\n        i || (r = []), this.emit(\"setHoverID\", r), this.render();\n      }\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      this.resultList = Wi(t), this.render();\n    }\n  }, {\n    key: \"drawPolygon\",\n    value: function drawPolygon(t, e) {\n      var _this13 = this;\n      t == null || t.forEach(function (i) {\n        var r, n, o, a, l;\n        var h = _this13.getColor(i.attribute, e),\n          c = et.getStrokeAndFill(h, i.valid);\n        var g = (n = (r = _this13.style) == null ? void 0 : r.width) != null ? n : 2;\n        _this13.hoverID.includes(i.id) ? (g = 4, m.drawPolygonWithFillAndLine(_this13.canvas, w.changePointListByZoom(i.pointList, _this13.zoom, _this13.currentPos), {\n          fillColor: c.fill,\n          strokeColor: c.stroke,\n          pointColor: \"white\",\n          thickness: g,\n          lineCap: \"round\",\n          isClose: !0,\n          lineType: e == null ? void 0 : e.lineType\n        })) : m.drawPolygon(_this13.canvas, w.changePointListByZoom(i.pointList, _this13.zoom, _this13.currentPos), {\n          color: c.fill,\n          lineType: (o = _this13.config) == null ? void 0 : o.lineType,\n          thickness: g,\n          isClose: !0\n        });\n        var d = \"\".concat((l = T.getAttributeShowText(i.attribute, (a = e == null ? void 0 : e.attributeList) != null ? a : [])) != null ? l : \"\");\n        (e == null ? void 0 : e.isShowOrder) && (i == null ? void 0 : i.order) > 0 && (d = \"\".concat(i.order, \" \").concat(d)), m.drawText(_this13.canvas, w.changePointByZoom(i.pointList[0], _this13.zoom, _this13.currentPos), d, di({\n          color: c.stroke\n        }, Z));\n        var u = w.changePointListByZoom(i.pointList || [], _this13.zoom, _this13.currentPos),\n          f = u[u.length - 1];\n        m.drawText(_this13.canvas, {\n          x: f.x + ui.x,\n          y: f.y + ui.y\n        }, i == null ? void 0 : i.textAttribute, di({\n          color: c.stroke\n        }, Z));\n      });\n    }\n  }, {\n    key: \"drawRect\",\n    value: function drawRect(t, e) {\n      var _this14 = this;\n      t == null || t.forEach(function (i) {\n        var r = 1;\n        _this14.hoverID.includes(i.id) && (r = 3);\n        var n = _this14.getColor(i.attribute, e),\n          o = w.changeRectByZoom(i, _this14.zoom, _this14.currentPos);\n        m.drawRect(_this14.canvas, o, {\n          color: (i == null ? void 0 : i.valid) ? n.valid.stroke : n.invalid.stroke,\n          thickness: r\n        }), _this14.fillID.includes(i.id) && m.drawRectWithFill(_this14.canvas, o, {\n          color: (i == null ? void 0 : i.valid) ? n.valid.fill : n.invalid.fill\n        });\n      });\n    }\n  }, {\n    key: \"drawTag\",\n    value: function drawTag(t, e) {\n      var i = t.reduce(function (r, n) {\n        return [].concat(_toConsumableArray(r), _toConsumableArray((e == null ? void 0 : e.inputList) ? Lt.getTagNameList(n.result, e.inputList) : Lt.getTagnameListWithoutConfig(n.result)));\n      }, []);\n      m.drawTag(this.canvas, i);\n    }\n  }, {\n    key: \"setHoverID\",\n    value: function setHoverID(t) {\n      this.hoverID = t, this.render();\n    }\n  }, {\n    key: \"setFillID\",\n    value: function setFillID(t) {\n      this.fillID = t, this.render();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this15 = this;\n      var t;\n      _get(_getPrototypeOf(Or.prototype), \"render\", this).call(this), (t = this.resultList) == null || t.forEach(function (e) {\n        switch (e == null ? void 0 : e.toolName) {\n          case P.Rect:\n            _this15.drawRect(e.result, x.jsonParser(e.config));\n            break;\n          case P.Polygon:\n            _this15.drawPolygon(e.result, x.jsonParser(e.config));\n            break;\n          case P.Tag:\n            _this15.drawTag(e.result, x.jsonParser(e.config));\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      return [[], {}];\n    }\n  }]);\n  return Or;\n}(st);\nvar ce = 30,\n  de = 164;\nvar Vt = /*#__PURE__*/function () {\n  function Vt(t) {\n    var _this16 = this;\n    _classCallCheck(this, Vt);\n    this.textKeyDown = function (l) {\n      switch (l.stopPropagation(), l.keyCode) {\n        case S.Enter:\n          _this16.submitTextarea(), _this16.appendToContainer();\n          break;\n      }\n    };\n    var e = t.container,\n      i = t.icon,\n      r = t.color,\n      n = t.getCurrentSelectedData,\n      o = t.updateSelectedTextAttribute,\n      a = t.width || de;\n    this.container = e, this.getCurrentSelectedData = n, this.updateSelectedTextAttribute = o, this._textAttributeDOM = this.initTextAttributeDOM(), this._iconDOM = this.initIconDOM(i), this._textDOM = this.initTextDOM(a, Ce), this._textareaDOM = this.initTextareaDOM(a, r), this.appendToContainer();\n  }\n  _createClass(Vt, [{\n    key: \"isExit\",\n    get: function get() {\n      return this._textAttributeDOM ? this.container.contains(this._textAttributeDOM) : !1;\n    }\n  }, {\n    key: \"isExitTextareaDOM\",\n    get: function get() {\n      return this._textareaDOM ? this.container.contains(this._textareaDOM) : !1;\n    }\n  }, {\n    key: \"updateIcon\",\n    value: function updateIcon(t) {\n      this._iconDOM && (this._iconDOM.innerHTML = t);\n    }\n  }, {\n    key: \"appendToContainer\",\n    value: function appendToContainer() {\n      !this._textAttributeDOM || !this._textDOM || !this._iconDOM || (this.container.appendChild(this._textAttributeDOM), this._textAttributeDOM.appendChild(this._textDOM), this._textAttributeDOM.appendChild(this._iconDOM));\n    }\n  }, {\n    key: \"initTextAttributeDOM\",\n    value: function initTextAttributeDOM() {\n      var t = document.createElement(\"div\");\n      return t.setAttribute(\"id\", \"textArea\"), t;\n    }\n  }, {\n    key: \"initTextDOM\",\n    value: function initTextDOM(t, e) {\n      var i = document.createElement(\"span\");\n      return i.setAttribute(\"style\", \"\\n        width: \".concat(Math.max(t, ce), \"px;\\n        line-height: \").concat(e, \"px;\\n        word-break: break-all;\\n        white-space: pre-line;\\n        font-style: italic;\\n      \")), i;\n    }\n  }, {\n    key: \"initIconDOM\",\n    value: function initIconDOM(t) {\n      var _this17 = this;\n      var e = document.createElement(\"div\");\n      return e.setAttribute(\"id\", \"annotation_text\"), e.innerHTML = t, e.addEventListener(\"mouseup\", function (i) {\n        i.stopPropagation(), _this17.renderTextarea();\n      }), e.addEventListener(\"mousedown\", function (i) {\n        i.stopPropagation();\n      }), e.addEventListener(\"contextmenu\", function (i) {\n        i.stopPropagation();\n      }), e.setAttribute(\"style\", \"\\n        position: absolute;\\n        left: -20px;\\n        top: 4px;\\n        cursor: pointer;\\n        z-index: 10\\n      \"), e;\n    }\n  }, {\n    key: \"initTextareaDOM\",\n    value: function initTextareaDOM(t, e) {\n      var i = document.createElement(\"textarea\");\n      return i.addEventListener(\"click\", function (r) {\n        r.stopPropagation();\n      }), i.addEventListener(\"mouseup\", function (r) {\n        r.stopPropagation();\n      }), i.setAttribute(\"style\", \"\\n      background-color: transparent;\\n      border-radius: 5px;\\n      border-color: \".concat(e, \";\\n      outline: none;\\n      resize: none;\\n      width: \").concat(Math.max(t, 30), \"px;\\n      \")), i.setAttribute(\"maxLength\", \"\".concat(ie)), i;\n    }\n  }, {\n    key: \"removeTextDOM\",\n    value: function removeTextDOM() {\n      !this._textAttributeDOM || this._textDOM && this._textAttributeDOM.removeChild(this._textDOM);\n    }\n  }, {\n    key: \"removeIconDOM\",\n    value: function removeIconDOM() {\n      !this._textAttributeDOM || this._iconDOM && this._textAttributeDOM.removeChild(this._iconDOM);\n    }\n  }, {\n    key: \"removeTextareaDOM\",\n    value: function removeTextareaDOM() {\n      var t, e;\n      this._textareaDOM && this._textAttributeDOM && ((t = this._textAttributeDOM) == null ? void 0 : t.contains(this._textareaDOM)) && ((e = this._textAttributeDOM) == null || e.removeChild(this._textareaDOM));\n    }\n  }, {\n    key: \"submitTextarea\",\n    value: function submitTextarea() {\n      var t;\n      this._textareaDOM && (this.updateSelectedTextAttribute((t = this._textareaDOM) == null ? void 0 : t.value), this.removeTextareaDOM(), this.clearTextAttribute());\n    }\n  }, {\n    key: \"clearTextAttribute\",\n    value: function clearTextAttribute() {\n      this._textAttributeDOM && this.container.contains(this._textAttributeDOM) && this.container.removeChild(this._textAttributeDOM);\n    }\n  }, {\n    key: \"renderTextarea\",\n    value: function renderTextarea() {\n      if (!this._textAttributeDOM || !this._textareaDOM) return;\n      var t = this.getCurrentSelectedData();\n      if (!t) return;\n      var _t$width = t.width,\n        e = _t$width === void 0 ? de : _t$width,\n        i = t.textAttribute,\n        r = t.color;\n      this._textareaDOM.value = \"\".concat(i), this._textareaDOM.setAttribute(\"style\", \"\\n      background-color: rgba(0,0,0,0.4);\\n      border-radius: 5px;\\n      border-color: \".concat(r, \";\\n      outline: none;\\n      resize: none;\\n      font-style: italic;\\n      font-weight: 900;\\n      text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.6);\\n      width: \").concat(Math.max(e, ce), \"px;\\n      \")), this._textareaDOM.setAttribute(\"maxLength\", \"\".concat(ie)), this._textAttributeDOM.appendChild(this._textareaDOM), this.removeIconDOM(), this.removeTextDOM(), this._textareaDOM.focus(), this._textareaDOM.addEventListener(\"keydown\", this.textKeyDown);\n    }\n  }, {\n    key: \"update\",\n    value: function update(t, e) {\n      var i;\n      var r = e.left,\n        n = e.top,\n        o = e.color,\n        _e$width = e.width,\n        a = _e$width === void 0 ? de : _e$width,\n        l = Math.max(a, ce);\n      (i = this._textAttributeDOM) == null || i.setAttribute(\"style\", \"\\n        position: absolute; \\n        width: \".concat(l, \"px;\\n        font-size: 14px; \\n        left:\").concat(r, \"px; \\n        top: \").concat(n, \"px; \\n        color: \").concat(o, \";\\n      \")), this._textDOM && (this._textDOM.innerHTML = \"\".concat(t)), this._textareaDOM && (this._textareaDOM.style.width = \"\".concat(l, \"px\"), this._textareaDOM.style.borderColor = \"\".concat(o));\n    }\n  }, {\n    key: \"changeSelected\",\n    value: function changeSelected() {\n      this.isExitTextareaDOM && this.submitTextarea();\n    }\n  }]);\n  return Vt;\n}();\nvar Mr = Object.defineProperty,\n  Er = Object.defineProperties,\n  Nr = Object.getOwnPropertyDescriptors,\n  gi = Object.getOwnPropertySymbols,\n  Hr = Object.prototype.hasOwnProperty,\n  Br = Object.prototype.propertyIsEnumerable,\n  fi = function fi(s, t, e) {\n    return t in s ? Mr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  j = function j(s, t) {\n    for (var e in t || (t = {})) Hr.call(t, e) && fi(s, e, t[e]);\n    if (gi) {\n      var _iterator11 = _createForOfIteratorHelper(gi(t)),\n        _step11;\n      try {\n        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n          var e = _step11.value;\n          Br.call(t, e) && fi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator11.e(err);\n      } finally {\n        _iterator11.f();\n      }\n    }\n    return s;\n  },\n  rt = function rt(s, t) {\n    return Er(s, Nr(t));\n  };\nvar vi = 164;\nvar pi = /*#__PURE__*/function (_st2) {\n  _inherits(pi, _st2);\n  var _super3 = _createSuper(pi);\n  function pi(t) {\n    var _this18;\n    _classCallCheck(this, pi);\n    _this18 = _super3.call(this, t);\n    _this18.isAllowDouble = function (e) {\n      var _assertThisInitialize3 = _assertThisInitialized(_this18),\n        i = _assertThisInitialize3.selectedID,\n        r = _this18.getHoverID(e);\n      return !!(i && i === r);\n    }, _this18.textChange = function (e) {\n      _this18.config.textConfigurable === !1 || !_this18.selectedID || (_this18.setPolygonList(T.textChange(e, _this18.selectedID, _this18.polygonList)), _this18.emit(\"selectedChange\"), _this18.render());\n    }, _this18.config = x.jsonParser(t.config), _this18.drawingPointList = [], _this18.polygonList = [], _this18.hoverPointIndex = -1, _this18.hoverEdgeIndex = -1, _this18.drawingHistory = new ae(), _this18.isCtrl = !1, _this18.isAlt = !1, _this18.isCombined = !1, _this18.pattern = Q.Normal, _this18.getCurrentSelectedData = _this18.getCurrentSelectedData.bind(_assertThisInitialized(_this18)), _this18.updateSelectedTextAttribute = _this18.updateSelectedTextAttribute.bind(_assertThisInitialized(_this18));\n    return _this18;\n  }\n  _createClass(pi, [{\n    key: \"eventBinding\",\n    value: function eventBinding() {\n      _get(_getPrototypeOf(pi.prototype), \"eventBinding\", this).call(this), this.container.removeEventListener(\"mouseup\", this.onMouseUp), this.container.addEventListener(\"mouseup\", this.dragMouseUp), this.dblClickListener.addEvent(this.onMouseUp, this.onLeftDblClick, this.onRightDblClick, this.isAllowDouble);\n    }\n  }, {\n    key: \"eventUnbinding\",\n    value: function eventUnbinding() {\n      _get(_getPrototypeOf(pi.prototype), \"eventUnbinding\", this).call(this), this.container.removeEventListener(\"mouseup\", this.dragMouseUp);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _get(_getPrototypeOf(pi.prototype), \"destroy\", this).call(this), this._textAttributInstance && this._textAttributInstance.clearTextAttribute();\n    }\n  }, {\n    key: \"selectedPolygon\",\n    get: function get() {\n      return D.getPolygonByID(this.polygonList, this.selectedID);\n    }\n  }, {\n    key: \"polygonListUnderZoom\",\n    get: function get() {\n      var _this19 = this;\n      return this.polygonList.map(function (t) {\n        return rt(j({}, t), {\n          pointList: w.changePointListByZoom(t.pointList, _this19.zoom)\n        });\n      });\n    }\n  }, {\n    key: \"selectedText\",\n    get: function get() {\n      var t;\n      return (t = this.selectedPolygon) == null ? void 0 : t.textAttribute;\n    }\n  }, {\n    key: \"dataList\",\n    get: function get() {\n      return this.polygonList;\n    }\n  }, {\n    key: \"setPattern\",\n    value: function setPattern(t) {\n      var e;\n      ((e = this.drawingPointList) == null ? void 0 : e.length) > 0 || (this.pattern = t);\n    }\n  }, {\n    key: \"currentShowList\",\n    get: function get() {\n      var t = [];\n      var _x$getRenderResultLis = x.getRenderResultList(this.polygonList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedID),\n        _x$getRenderResultLis2 = _slicedToArray(_x$getRenderResultLis, 2),\n        e = _x$getRenderResultLis2[0],\n        i = _x$getRenderResultLis2[1];\n      return t = e, this.isHidden && (t = []), i && t.push(i), t;\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      var _x$getRenderResultLis3 = x.getRenderResultList(this.polygonList, x.getSourceID(this.basicResult), []),\n        _x$getRenderResultLis4 = _slicedToArray(_x$getRenderResultLis3, 1),\n        t = _x$getRenderResultLis4[0];\n      return t;\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      this.clearActiveStatus(), this.setPolygonList(t), this.render();\n    }\n  }, {\n    key: \"setPolygonDataByID\",\n    value: function setPolygonDataByID(t, e) {\n      return this.polygonList.map(function (i) {\n        return i.id === e ? j(j({}, i), t) : i;\n      });\n    }\n  }, {\n    key: \"rotatePolygon\",\n    value: function rotatePolygon() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Rt.Clockwise;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.selectedID;\n      if (!i) return;\n      var r = D.getPolygonByID(this.polygonList, i);\n      if (!r) return;\n      var n = D.updatePolygonByRotate(e, t, r == null ? void 0 : r.pointList);\n      this.setPolygonList(this.setPolygonDataByID({\n        pointList: n\n      }, i)), this.render();\n    }\n  }, {\n    key: \"addPointInDrawing\",\n    value: function addPointInDrawing(t) {\n      if (!this.imgInfo) return;\n      var _this$config = this.config,\n        e = _this$config.upperLimitPointNum,\n        i = _this$config.edgeAdsorption;\n      if (e && this.drawingPointList.length >= e) {\n        this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.UpperLimitErrorNotice, this.lang)).concat(e));\n        return;\n      }\n      this.setSelectedID(\"\");\n      var r = this.getCoordinateUnderZoom(t),\n        n = w.changeDrawOutsideTarget(r, {\n          x: 0,\n          y: 0\n        }, this.imgInfo, this.config.drawOutsideTarget, this.basicResult, this.zoom);\n      if (w.returnClosePointIndex(n, w.changePointListByZoom(this.drawingPointList, this.zoom)) === 0) {\n        this.addDrawingPointToPolygonList();\n        return;\n      }\n      var _D$getClosestPoint = D.getClosestPoint(n, this.polygonListUnderZoom, this.config.lineType, xt),\n        a = _D$getClosestPoint.dropFoot,\n        l = w.changePointByZoom(a && t.altKey === !1 && i ? a : n, 1 / this.zoom);\n      if (this.pattern === Q.Rect && this.drawingPointList.length === 2) {\n        var h = L.getRectangleByRightAngle(l, this.drawingPointList);\n        if (this.drawingPointList = h, this.config.drawOutsideTarget === !1 && this.imgInfo && this.isPolygonOutSide(this.drawingPointList)) {\n          this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.ForbiddenCreationOutsideBoundary, this.lang))), this.drawingPointList = [];\n          return;\n        }\n        this.addDrawingPointToPolygonList(!0);\n        return;\n      }\n      this.drawingPointList.push(l), this.drawingPointList.length === 1 ? this.drawingHistory.initRecord(this.drawingPointList) : this.drawingHistory.pushHistory(this.drawingPointList);\n    }\n  }, {\n    key: \"clearResult\",\n    value: function clearResult() {\n      this.setPolygonList([]), this.setSelectedID(void 0), this.render();\n    }\n  }, {\n    key: \"clearPolygonDrag\",\n    value: function clearPolygonDrag() {\n      this.drawingPointList = [], this.dragInfo = void 0, this.dragInfo = void 0, this.dragStatus = O.Wait, this.hoverEdgeIndex = -1, this.hoverPointIndex = -1, this.hoverID = \"\";\n    }\n  }, {\n    key: \"clearActiveStatus\",\n    value: function clearActiveStatus() {\n      this.clearPolygonDrag(), this.setSelectedID(void 0);\n    }\n  }, {\n    key: \"setPolygonList\",\n    value: function setPolygonList(t) {\n      var e = this.polygonList.length;\n      this.polygonList = t, e !== t.length && this.emit(\"updatePageNumber\");\n    }\n  }, {\n    key: \"setSelectedID\",\n    value: function setSelectedID(t) {\n      var e, i;\n      var r = this.selectedID;\n      t !== r && r && ((e = this._textAttributInstance) == null || e.changeSelected()), t || (i = this._textAttributInstance) == null || i.clearTextAttribute(), this.selectedID = t, this.render(), this.emit(\"selectedChange\");\n    }\n  }, {\n    key: \"setDefaultAttribute\",\n    value: function setDefaultAttribute() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e = this.defaultAttribute;\n      if (this.defaultAttribute = t, e !== t) {\n        this.changeStyle(t), this.emit(\"changeAttributeSidebar\");\n        var i = this.selectedID;\n        if (i && (this.selectedPolygon && (this.selectedPolygon.attribute = t), this.history.pushHistory(this.polygonList), this.render()), this._textAttributInstance) {\n          if (this.attributeLockList.length > 0 && !this.attributeLockList.includes(t)) {\n            this._textAttributInstance.clearTextAttribute();\n            return;\n          }\n          this._textAttributInstance.updateIcon(this.getTextIconSvg(t));\n        }\n      }\n    }\n  }, {\n    key: \"setStyle\",\n    value: function setStyle(t) {\n      var e;\n      _get(_getPrototypeOf(pi.prototype), \"setStyle\", this).call(this, t), this._textAttributInstance && this.config.attributeConfigurable === !1 && ((e = this._textAttributInstance) == null || e.updateIcon(this.getTextIconSvg()));\n    }\n  }, {\n    key: \"setPolygonValidAndRender\",\n    value: function setPolygonValidAndRender(t) {\n      if (!t) return;\n      var e = this.polygonList.map(function (i) {\n        return i.id === t ? rt(j({}, i), {\n          valid: !i.valid\n        }) : i;\n      });\n      this.setPolygonList(e), this.history.pushHistory(this.polygonList), this.render(), this.emit(\"updateResult\");\n    }\n  }, {\n    key: \"addDrawingPointToPolygonList\",\n    value: function addDrawingPointToPolygonList(t) {\n      var _this20 = this;\n      var _this$config$lowerLim = this.config.lowerLimitPointNum,\n        e = _this$config$lowerLim === void 0 ? 3 : _this$config$lowerLim;\n      if (e < 3 && (e = 3), this.drawingPointList.length < e) {\n        this.drawingPointList = [], this.editPolygonID = \"\";\n        return;\n      }\n      var i = x.getSourceID(this.basicResult),\n        r = _toConsumableArray(this.polygonList);\n      if (this.editPolygonID) {\n        var n = r.find(function (o) {\n          return o.id === _this20.editPolygonID;\n        });\n        if (!n) return;\n        n.pointList = this.drawingPointList, this.editPolygonID = \"\";\n      } else {\n        var _n2 = J(8, 62);\n        var o = {\n          id: _n2,\n          sourceID: i,\n          valid: !this.isCtrl,\n          isVisible: !0,\n          textAttribute: \"\",\n          pointList: this.drawingPointList,\n          attribute: this.defaultAttribute,\n          order: x.getAllToolsMaxOrder(this.polygonList, this.prevResultList) + 1\n        };\n        if (this.config.textConfigurable) {\n          var a = \"\";\n          a = T.getTextAttribute(this.polygonList.filter(function (l) {\n            return x.isSameSourceID(l.sourceID, i);\n          }), this.config.textCheckType), o = rt(j({}, o), {\n            textAttribute: a\n          });\n        }\n        this.pattern === Q.Rect && t === !0 && (o = rt(j({}, o), {\n          isRect: !0\n        })), r.push(o), this.setSelectedIdAfterAddingDrawing(_n2);\n      }\n      this.setPolygonList(r), this.isCtrl = !1, this.drawingPointList = [], this.history.pushHistory(r);\n    }\n  }, {\n    key: \"setSelectedIdAfterAddingDrawing\",\n    value: function setSelectedIdAfterAddingDrawing(t) {\n      this.drawingPointList.length !== 0 && (this.config.textConfigurable ? this.setSelectedID(t) : this.setSelectedID());\n    }\n  }, {\n    key: \"getHoverID\",\n    value: function getHoverID(t) {\n      var _this21 = this;\n      var e;\n      var i = this.getCoordinateUnderZoom(t),\n        r = this.currentShowList.map(function (n) {\n          return rt(j({}, n), {\n            pointList: w.changePointListByZoom(n.pointList, _this21.zoom)\n          });\n        });\n      return D.getHoverPolygonID(i, r, 10, (e = this.config) == null ? void 0 : e.lineType);\n    }\n  }, {\n    key: \"getHoverEdgeIndex\",\n    value: function getHoverEdgeIndex(t) {\n      var e;\n      if (!this.selectedID) return -1;\n      var i = this.selectedPolygon;\n      if (!i) return -1;\n      var r = this.getCoordinateUnderZoom(t),\n        n = w.changePointListByZoom(i.pointList, this.zoom);\n      return D.getHoverEdgeIndex(r, n, (e = this.config) == null ? void 0 : e.lineType);\n    }\n  }, {\n    key: \"getHoverPointIndex\",\n    value: function getHoverPointIndex(t) {\n      if (!this.selectedID) return -1;\n      var e = this.selectedPolygon;\n      if (!e) return -1;\n      var i = this.getCoordinateUnderZoom(t),\n        r = w.changePointListByZoom(e.pointList, this.zoom);\n      return w.returnClosePointIndex(i, r);\n    }\n  }, {\n    key: \"deletePolygon\",\n    value: function deletePolygon(t) {\n      var e;\n      !t || (this.setPolygonList(this.polygonList.filter(function (i) {\n        return i.id !== t;\n      })), this.history.pushHistory(this.polygonList), (e = this._textAttributInstance) == null || e.clearTextAttribute(), this.emit(\"selectedChange\"), this.render());\n    }\n  }, {\n    key: \"deletePolygonPoint\",\n    value: function deletePolygonPoint(t) {\n      if (!this.selectedID) return;\n      var e = this.selectedPolygon;\n      if (!e) return;\n      var i = this.config.lowerLimitPointNum;\n      if (i < 3 && (i = 3), e.pointList.length <= i) {\n        this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.LowerLimitErrorNotice, this.lang)).concat(i));\n        return;\n      }\n      e == null || e.pointList.splice(t, 1), this.history.pushHistory(this.polygonList), this.render();\n    }\n  }, {\n    key: \"spaceKeydown\",\n    value: function spaceKeydown() {\n      var t, e, i;\n      if (this.selectedID) {\n        if (((t = this.selectedPolygon) == null ? void 0 : t.isRect) === !0) {\n          this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.UnableToReannotation, this.lang)));\n          return;\n        }\n        this.editPolygonID = this.selectedID, this.drawingPointList = (i = (e = this.selectedPolygon) == null ? void 0 : e.pointList) != null ? i : [], this.drawingHistory.empty(), this.drawingHistory.initRecord(this.drawingPointList), this.hoverID = \"\", this.setSelectedID(\"\"), this.render();\n      }\n    }\n  }, {\n    key: \"onTabKeyDown\",\n    value: function onTabKeyDown(t) {\n      if (t.preventDefault(), this.drawingPointList.length > 0) return;\n      var e = G.ascend;\n      t.shiftKey && (e = G.descend);\n      var _x$getRenderResultLis5 = x.getRenderResultList(this.polygonList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedID),\n        _x$getRenderResultLis6 = _slicedToArray(_x$getRenderResultLis5, 2),\n        i = _x$getRenderResultLis6[0],\n        r = _x$getRenderResultLis6[1];\n      var n = _toConsumableArray(i);\n      r && (n = [].concat(_toConsumableArray(n), [r]));\n      var o = at.getViewPort(this.canvas, this.currentPos, this.zoom),\n        a = n.map(function (h) {\n          var c, g, d, u;\n          return rt(j({}, h), {\n            x: (g = (c = h.pointList[0]) == null ? void 0 : c.x) != null ? g : 0,\n            y: (u = (d = h.pointList[0]) == null ? void 0 : d.y) != null ? u : 0\n          });\n        }).filter(function (h) {\n          return at.inViewPort({\n            x: h.x,\n            y: h.y\n          }, o);\n        }),\n        l = x.getNextSelectedRectID(a, e, this.selectedID);\n      if (l) {\n        this.setSelectedID(l.id);\n        var h = this.selectedPolygon;\n        h && this.setDefaultAttribute(h.attribute);\n      }\n      this.render();\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      var e;\n      if (!x.hotkeyFilter(t) || _get(_getPrototypeOf(pi.prototype), \"onKeyDown\", this).call(this, t) === !1) return;\n      var i = t.keyCode;\n      switch (i) {\n        case S.Space:\n          this.spaceKeydown();\n          break;\n        case S.Esc:\n          this.drawingPointList = [], this.editPolygonID = \"\";\n          break;\n        case S.F:\n          this.selectedID && this.setPolygonValidAndRender(this.selectedID);\n          break;\n        case S.Delete:\n          this.deletePolygon(this.selectedID), this.render();\n          break;\n        case S.Ctrl:\n          this.isCtrl = !0;\n          break;\n        case S.Alt:\n          this.isAlt === !1 && (t.preventDefault(), this.isAlt = !0, this.render());\n          break;\n        case S.Tab:\n          {\n            this.onTabKeyDown(t);\n            break;\n          }\n        case S.X:\n          t.altKey && this.segment();\n          break;\n        default:\n          {\n            if (this.config.attributeConfigurable) {\n              var r = T.getAttributeByKeycode(i, (e = this.config) == null ? void 0 : e.attributeList);\n              r !== void 0 && this.setDefaultAttribute(r);\n            }\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"onKeyUp\",\n    value: function onKeyUp(t) {\n      switch (_get(_getPrototypeOf(pi.prototype), \"onKeyUp\", this).call(this, t), t.keyCode) {\n        case S.Ctrl:\n          this.isCtrl = !1;\n          break;\n        case S.Alt:\n          {\n            var e = this.isAlt;\n            this.isAlt = !1, e === !0 && this.render();\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"rightMouseUp\",\n    value: function rightMouseUp() {\n      this.drawingPointList.length > 0 && this.addDrawingPointToPolygonList(), this.setSelectedID(this.hoverID);\n      var t = this.selectedPolygon;\n      t && this.setDefaultAttribute(t.attribute);\n    }\n  }, {\n    key: \"onLeftDblClick\",\n    value: function onLeftDblClick(t) {\n      if (this.hoverEdgeIndex > -1) {\n        var e = this.getCoordinateUnderZoom(t),\n          i = this.selectedPolygon;\n        if (!i) return;\n        var _D$getClosestPoint2 = D.getClosestPoint(e, this.polygonListUnderZoom, this.config.lineType, xt),\n          r = _D$getClosestPoint2.dropFoot;\n        if (!r) return;\n        var n = this.config.upperLimitPointNum;\n        if (n && i.pointList.length >= n) {\n          this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.UpperLimitErrorNotice, this.lang)).concat(n)), this.clearPolygonDrag();\n          return;\n        }\n        i == null || i.pointList.splice(this.hoverEdgeIndex + 1, 0, w.changePointByZoom(r, 1 / this.zoom)), this.setPolygonDataByID(i, this.selectedID), this.history.pushHistory(this.polygonList), this.hoverPointIndex = -1, this.hoverEdgeIndex = -1, this.render();\n      }\n      this.dragInfo = void 0;\n    }\n  }, {\n    key: \"onRightDblClick\",\n    value: function onRightDblClick(t) {\n      this.dragInfo = void 0, this.clearImgDrag();\n      var e = this.getHoverID(t),\n        i = this.getHoverPointIndex(t);\n      if (this.hoverPointIndex > -1 && this.hoverPointIndex === i) {\n        this.deletePolygonPoint(i), this.dragInfo = void 0, this.hoverPointIndex = -1, this.render();\n        return;\n      }\n      this.hoverID === this.selectedID && this.deletePolygon(e), this.render();\n    }\n  }, {\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      if (_get(_getPrototypeOf(pi.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation || t.ctrlKey === !0) return;\n      var e = this.selectedPolygon;\n      if (!e || t.button !== 0 || this.getHoverID(t) !== this.selectedID) return;\n      var r = e.pointList,\n        n = this.getCoordinateUnderZoom(t);\n      var o = [0],\n        a = q.Plane;\n      this.dragStatus = O.Start;\n      var l = this.getHoverPointIndex(t),\n        h = this.getHoverEdgeIndex(t);\n      return l > -1 ? (a = q.Point, o = [l]) : h > -1 && this.hoverEdgeIndex > -1 && (a = q.Line, o = [h, (h + 1) % r.length]), this.dragInfo = {\n        dragStartCoord: n,\n        dragTarget: a,\n        initPointList: r,\n        changePointIndex: o\n      }, !0;\n    }\n  }, {\n    key: \"segment\",\n    value: function segment() {\n      var _this22 = this;\n      var t;\n      if (!this.selectedID || ((t = this.config) == null ? void 0 : t.lineType) !== R.Line) return;\n      var e = D.getPolygonPointList(this.selectedID, this.currentShowList),\n        i = this.currentShowList.filter(function (o) {\n          return o.id !== _this22.selectedID;\n        });\n      if (i.length === 0 || e.length === 0) return;\n      var r = D.getWrapPolygonIndex(e, i);\n      var n = _toConsumableArray(this.polygonList);\n      if (r === -1) {\n        var o = D.segmentPolygonByPolygon(e, i);\n        if (!o) return;\n        var a = o.shift();\n        if (!a) return;\n        var l = \"\",\n          h = !0;\n        var c = x.getSourceID(this.basicResult);\n        var g = \"\";\n        n = this.polygonList.map(function (d) {\n          var u, f;\n          return d.id === _this22.selectedID ? (l = d.attribute, h = (u = d == null ? void 0 : d.valid) != null ? u : !0, g = (f = d == null ? void 0 : d.textAttribute) != null ? f : \"\", rt(j({}, d), {\n            pointList: a\n          })) : d;\n        }), o.length > 0 && o.forEach(function (d, u) {\n          n.push({\n            sourceID: c,\n            id: J(8, 62),\n            pointList: d,\n            valid: h,\n            isVisible: !0,\n            order: x.getAllToolsMaxOrder(_this22.polygonList, _this22.prevResultList) + 1 + u,\n            attribute: l,\n            textAttribute: g\n          });\n        });\n      } else n[r].pointList = D.clipPolygonFromWrapPolygon(e, n[r].pointList), n = n.filter(function (o) {\n        return o.id !== _this22.selectedID;\n      });\n      this.setPolygonList(n), this.history.pushHistory(n), this.render();\n    }\n  }, {\n    key: \"onCombinedExecute\",\n    value: function onCombinedExecute() {\n      if (!this.selectedID) {\n        this.emit(\"messageInfo\", _t.t(\"PolygonsToBeCombinedNeedToBeSelected\"));\n        return;\n      }\n      this.isCombined = !this.isCombined;\n    }\n  }, {\n    key: \"combine\",\n    value: function combine(t) {\n      var _this23 = this;\n      var e;\n      var i = this.getHoverID(t);\n      if (!i || !this.selectedID || this.selectedID === i) return;\n      if (((e = this.config) == null ? void 0 : e.lineType) !== R.Line) {\n        this.emit(\"messageInfo\", _t.t(\"CurveModeDoesNotSupportCutting\"));\n        return;\n      }\n      var r = this.polygonList.find(function (h) {\n          return h.id === _this23.selectedID;\n        }),\n        n = this.currentShowList.find(function (h) {\n          return h.id === i;\n        });\n      if (!n || !r) return;\n      var o = D.combinePolygonWithPolygon(r, n);\n      if (!o) return;\n      var a = o.newPolygon,\n        l = o.unionList;\n      if (l.length === 1 && a) {\n        var h = this.polygonList.filter(function (c) {\n          return !l.includes(c.id);\n        }).map(function (c) {\n          return c.id === _this23.selectedID ? a : c;\n        });\n        this.setPolygonList(h), this.history.pushHistory(h), this.render(), this.emit(\"messageInfo\", _t.t(\"CombineSuccess\"));\n      } else this.emit(\"messageInfo\", _t.t(\"CombiningFailedNotify\"));\n      this.isCombined = !1;\n    }\n  }, {\n    key: \"isPolygonOutSide\",\n    value: function isPolygonOutSide(t) {\n      var _this24 = this;\n      if (this.dependToolName && this.basicCanvas && this.basicResult) {\n        var a = !1;\n        switch (this.dependToolName) {\n          case P.Rect:\n            {\n              a = t.filter(function (l) {\n                return !U.isInRect(l, _this24.basicResult);\n              }).length > 0;\n              break;\n            }\n          case P.Polygon:\n            {\n              a = D.isPointListOutSidePolygon(t, this.basicResult.pointList, this.config.lineType);\n              break;\n            }\n        }\n        return a;\n      }\n      if (!this.imgInfo) return !1;\n      var _L$calcViewportBounda = L.calcViewportBoundaries(w.changePointListByZoom(t, this.zoom)),\n        e = _L$calcViewportBounda.left,\n        i = _L$calcViewportBounda.top,\n        r = _L$calcViewportBounda.right,\n        n = _L$calcViewportBounda.bottom,\n        o = 1e-5;\n      return e < 0 || i < 0 || r > this.imgInfo.width + o || n > this.imgInfo.height + o;\n    }\n  }, {\n    key: \"onDragMove\",\n    value: function onDragMove(t) {\n      var _this25 = this;\n      if (!this.dragInfo || !this.selectedID) return;\n      var e = this.selectedPolygon;\n      var i = e == null ? void 0 : e.pointList;\n      if (!i) return;\n      var _this$dragInfo = this.dragInfo,\n        r = _this$dragInfo.initPointList,\n        n = _this$dragInfo.dragStartCoord,\n        o = _this$dragInfo.dragTarget,\n        a = _this$dragInfo.changePointIndex,\n        l = this.getCoordinateUnderZoom(t);\n      var h = {\n        x: (l.x - n.x) / this.zoom,\n        y: (l.y - n.y) / this.zoom\n      };\n      if (this.pattern === Q.Rect && (e == null ? void 0 : e.isRect) === !0 && a && [q.Line].includes(o)) {\n        var g = L.getArrayIndex(a[0] - 2, 4),\n          d = L.getArrayIndex(a[0] - 1, 4),\n          u = [r[g], r[d]];\n        h = L.getRectPerpendicularOffset(n, l, u);\n      }\n      switch (this.dragStatus = O.Move, o) {\n        case q.Plane:\n          i = i.map(function (g, d) {\n            return rt(j({}, g), {\n              x: r[d].x + h.x,\n              y: r[d].y + h.y\n            });\n          });\n          break;\n        case q.Point:\n        case q.Line:\n          i = i.map(function (g, d) {\n            return a && a.includes(d) ? rt(j({}, g), {\n              x: r[d].x + h.x,\n              y: r[d].y + h.y\n            }) : g;\n          });\n          break;\n      }\n      if (this.pattern === Q.Rect && (e == null ? void 0 : e.isRect) === !0 && o === q.Point && a && (i = L.getPointListFromPointOffset(r, a[0], h)), this.config.drawOutsideTarget === !1 && this.imgInfo && this.isPolygonOutSide(i)) return;\n      var c = this.polygonList.map(function (g) {\n        if (g.id === _this25.selectedID) {\n          var _d = rt(j({}, g), {\n            pointList: i\n          });\n          return g.isRect === !0 && _this25.pattern === Q.Normal && Object.assign(_d, {\n            isRect: !1\n          }), _d;\n        }\n        return g;\n      });\n      this.setPolygonList(c), this.render();\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      if (_get(_getPrototypeOf(pi.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      if (this.selectedID && this.dragInfo) {\n        this.onDragMove(t);\n        return;\n      }\n      var e = -1,\n        i = -1;\n      var r = this.selectedID;\n      if (r && (this.hoverEdgeIndex = -1, this.hoverPointIndex = -1, e = this.getHoverPointIndex(t), e > -1 ? this.hoverPointIndex = e : (i = this.getHoverEdgeIndex(t), this.hoverEdgeIndex = i)), this.drawingPointList.length > 0) return;\n      var n = this.getHoverID(t);\n      this.hoverID !== n && (this.hoverID = n, this.render());\n    }\n  }, {\n    key: \"leftMouseUp\",\n    value: function leftMouseUp(t) {\n      var e = this.getHoverID(t);\n      if (this.drawingPointList.length === 0 && t.ctrlKey === !0 && e) {\n        this.setPolygonValidAndRender(e);\n        return;\n      }\n      this.addPointInDrawing(t);\n    }\n  }, {\n    key: \"onMouseUp\",\n    value: function onMouseUp(t) {\n      if (this.isCombined) {\n        switch (t.button) {\n          case 0:\n            this.combine(t);\n            break;\n          case 2:\n            this.isCombined = !1;\n            break;\n          default:\n            return;\n        }\n        return;\n      }\n      if (!(_get(_getPrototypeOf(pi.prototype), \"onMouseUp\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo)) {\n        if (this.dragInfo && this.dragStatus === O.Move) {\n          this.dragInfo = void 0, this.dragStatus = O.Wait, this.history.pushHistory(this.polygonList), this.emit(\"updateResult\");\n          return;\n        }\n        switch (t.button) {\n          case 0:\n            {\n              this.leftMouseUp(t);\n              break;\n            }\n          case 2:\n            {\n              this.rightMouseUp();\n              break;\n            }\n        }\n        this.render();\n      }\n    }\n  }, {\n    key: \"dragMouseUp\",\n    value: function dragMouseUp() {\n      this.dragStatus === O.Start && (this.dragInfo = void 0, this.dragStatus = O.Wait);\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      var t = this.polygonList;\n      return [t, this.basicImgInfo];\n    }\n  }, {\n    key: \"getTextIconSvg\",\n    value: function getTextIconSvg() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e;\n      return T.getTextIconSvg(t, (e = this.config) == null ? void 0 : e.attributeList, this.config.attributeConfigurable, this.baseIcon);\n    }\n  }, {\n    key: \"getCurrentSelectedData\",\n    value: function getCurrentSelectedData() {\n      var t = this.selectedPolygon;\n      if (!t) return;\n      var e = this.getColor(t.attribute),\n        i = t.valid ? e == null ? void 0 : e.valid.stroke : e == null ? void 0 : e.invalid.stroke;\n      return {\n        width: vi,\n        textAttribute: t.textAttribute,\n        color: i\n      };\n    }\n  }, {\n    key: \"updateSelectedTextAttribute\",\n    value: function updateSelectedTextAttribute(t) {\n      if (this._textAttributInstance && t && this.selectedID) {\n        var e = t;\n        T.textAttributeValidate(this.config.textCheckType, \"\", e) === !1 && (this.emit(\"messageError\", T.getErrorNotice(this.config.textCheckType, this.lang)), e = \"\"), this.setPolygonList(T.textChange(e, this.selectedID, this.polygonList)), this.emit(\"updateTextAttribute\"), this.render();\n      }\n    }\n  }, {\n    key: \"renderTextAttribute\",\n    value: function renderTextAttribute() {\n      var t;\n      var e = this.selectedPolygon;\n      if (!this.ctx || this.config.textConfigurable === !1 || !e) return;\n      var i = e.pointList,\n        r = e.attribute,\n        n = e.valid,\n        o = e.textAttribute,\n        _i4 = i[i.length - 1],\n        a = _i4.x,\n        l = _i4.y,\n        h = vi,\n        c = w.getOffsetCoordinate({\n          x: a,\n          y: l\n        }, this.currentPos, this.zoom),\n        g = this.getColor(r),\n        d = n ? g == null ? void 0 : g.valid.stroke : g == null ? void 0 : g.invalid.stroke;\n      this._textAttributInstance || (this._textAttributInstance = new Vt({\n        width: h,\n        container: this.container,\n        icon: this.getTextIconSvg(r),\n        color: d,\n        getCurrentSelectedData: this.getCurrentSelectedData,\n        updateSelectedTextAttribute: this.updateSelectedTextAttribute\n      })), this._textAttributInstance && !((t = this._textAttributInstance) == null ? void 0 : t.isExit) && this._textAttributInstance.appendToContainer(), this._textAttributInstance.update(\"\".concat(o), {\n        left: c.x,\n        top: c.y,\n        color: d,\n        width: h\n      });\n    }\n  }, {\n    key: \"renderPolygon\",\n    value: function renderPolygon() {\n      var _this26 = this;\n      var t, e, i, r, n, o, a, l, h;\n      if (this.container.dispatchEvent(this.saveDataEvent), this.isHidden === !1 && ((t = this.polygonList) == null || t.forEach(function (d) {\n        var u, f, v, b, p;\n        if (![_this26.selectedID, _this26.editPolygonID].includes(d.id) && d.isVisible) {\n          var y = d.textAttribute,\n            I = d.attribute,\n            _ = _this26.getColor(I),\n            A = et.getStrokeAndFill(_, d.valid),\n            E = w.changePointListByZoom(d.pointList || [], _this26.zoom, _this26.currentPos);\n          m.drawPolygonWithFillAndLine(_this26.canvas, E, {\n            fillColor: A.fill,\n            strokeColor: A.stroke,\n            pointColor: \"white\",\n            thickness: (f = (u = _this26.style) == null ? void 0 : u.width) != null ? f : 2,\n            lineCap: \"round\",\n            isClose: !0,\n            lineType: (v = _this26.config) == null ? void 0 : v.lineType\n          });\n          var N = \"\".concat((p = T.getAttributeShowText(I, (b = _this26.config) == null ? void 0 : b.attributeList)) != null ? p : \"\");\n          if (_this26.isShowOrder && (d == null ? void 0 : d.order) > 0 && (N = \"\".concat(d.order, \" \").concat(N)), m.drawText(_this26.canvas, E[0], N, j({\n            color: A.stroke\n          }, Z)), _this26.isShowAttributeText) {\n            var k = E[E.length - 1];\n            k && k.x && m.drawText(_this26.canvas, {\n              x: k.x + ot.x,\n              y: k.y + ot.y\n            }, y, j({\n              color: A.stroke\n            }, Z));\n          }\n        }\n      })), this.hoverID && this.hoverID !== this.editPolygonID) {\n        var d = this.polygonList.find(function (u) {\n          return u.id === _this26.hoverID && u.id !== _this26.selectedID;\n        });\n        if (d) {\n          var u = \"\";\n          var f = this.getColor(d.attribute);\n          d.valid ? u = f.validHover.fill : u = et.getStrokeAndFill(f, !1, {\n            isHover: !0\n          }).fill, m.drawPolygonWithFill(this.canvas, w.changePointListByZoom(d.pointList, this.zoom, this.currentPos), {\n            color: u,\n            lineType: (e = this.config) == null ? void 0 : e.lineType\n          });\n        }\n      }\n      if (this.selectedID) {\n        var _d2 = this.selectedPolygon;\n        if (_d2) {\n          var _u2 = this.getColor(_d2.attribute),\n            _f3 = et.getStrokeAndFill(_u2, _d2.valid, {\n              isSelected: !0\n            });\n          m.drawSelectedPolygonWithFillAndLine(this.canvas, w.changePointListByZoom(_d2.pointList, this.zoom, this.currentPos), {\n            fillColor: _f3.fill,\n            strokeColor: _f3.stroke,\n            pointColor: \"white\",\n            thickness: 2,\n            lineCap: \"round\",\n            isClose: !0,\n            lineType: (i = this.config) == null ? void 0 : i.lineType\n          });\n          var v = \"\".concat((n = T.getAttributeShowText(_d2.attribute, (r = this.config) == null ? void 0 : r.attributeList)) != null ? n : \"\");\n          this.isShowOrder && (_d2 == null ? void 0 : _d2.order) > 0 && (v = \"\".concat(_d2.order, \" \").concat(v)), m.drawText(this.canvas, w.changePointByZoom(_d2.pointList[0], this.zoom, this.currentPos), v, j({\n            color: _f3.stroke\n          }, Z));\n        }\n      }\n      var c = this.getColor(this.defaultAttribute),\n        g = et.getStrokeAndFill(c, !this.isCtrl);\n      if (((o = this.drawingPointList) == null ? void 0 : o.length) > 0) {\n        var _d3 = _toConsumableArray(this.drawingPointList),\n          _u3 = w.getOriginCoordinateWithOffsetCoordinate(this.coord, this.zoom, this.currentPos);\n        if (this.pattern === Q.Rect && _d3.length === 2) _d3 = L.getRectangleByRightAngle(_u3, _d3);else {\n          if (((a = this.config) == null ? void 0 : a.edgeAdsorption) && this.isAlt === !1) {\n            var _D$getClosestPoint3 = D.getClosestPoint(_u3, this.polygonList, (l = this.config) == null ? void 0 : l.lineType, xt / this.zoom),\n              _f4 = _D$getClosestPoint3.dropFoot;\n            _f4 && (_u3 = _f4);\n          }\n          _d3.push(_u3);\n        }\n        m.drawSelectedPolygonWithFillAndLine(this.canvas, w.changePointListByZoom(_d3, this.zoom, this.currentPos), {\n          fillColor: g.fill,\n          strokeColor: g.stroke,\n          pointColor: \"white\",\n          thickness: 2,\n          lineCap: \"round\",\n          isClose: !1,\n          lineType: this.config.lineType\n        });\n      }\n      if (this.hoverPointIndex > -1 && this.selectedID) {\n        var _d4 = this.selectedPolygon;\n        if (!_d4) return;\n        var _u4 = et.getStrokeAndFill(c, _d4.valid, {\n            isSelected: !0\n          }),\n          _f5 = _d4 == null ? void 0 : _d4.pointList[this.hoverPointIndex];\n        if (_f5) {\n          var _w$changePointByZoom = w.changePointByZoom(_f5, this.zoom, this.currentPos),\n            _v = _w$changePointByZoom.x,\n            b = _w$changePointByZoom.y;\n          m.drawCircleWithFill(this.canvas, {\n            x: _v,\n            y: b\n          }, 5, {\n            color: _u4.fill\n          });\n        }\n      }\n      if (this.hoverEdgeIndex > -1 && this.selectedID) {\n        var _d5 = this.selectedPolygon;\n        if (!_d5) return;\n        var _u5 = et.getStrokeAndFill(c, _d5.valid, {\n          isSelected: !0\n        });\n        m.drawLineWithPointList(this.canvas, w.changePointListByZoom(_d5.pointList, this.zoom, this.currentPos), {\n          color: _u5.stroke,\n          thickness: 10,\n          hoverEdgeIndex: this.hoverEdgeIndex,\n          lineType: (h = this.config) == null ? void 0 : h.lineType\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      !this.ctx || !this.renderReady || (_get(_getPrototypeOf(pi.prototype), \"render\", this).call(this), this.renderPolygon(), this.renderCursorLine(this.getLineColor(this.defaultAttribute)));\n    }\n  }, {\n    key: \"renderCursorLine\",\n    value: function renderCursorLine(t) {\n      if (_get(_getPrototypeOf(pi.prototype), \"renderCursorLine\", this).call(this, t), this.isCombined) {\n        var _this$coord2 = this.coord,\n          e = _this$coord2.x,\n          i = _this$coord2.y,\n          r = 10,\n          n = 186,\n          o = 32;\n        m.drawRectWithFill(this.canvas, {\n          x: e + r,\n          y: i - r * 4 - 1,\n          width: n,\n          height: o\n        }, {\n          color: \"black\"\n        }), m.drawText(this.canvas, {\n          x: e,\n          y: i\n        }, _t.t(\"ClickAnotherPolygon\"), {\n          textAlign: \"center\",\n          color: \"white\",\n          offsetX: n / 2 + r,\n          offsetY: -(o / 2 + r / 2)\n        }), m.drawRect(this.canvas, {\n          x: e - r,\n          y: i - r,\n          width: r * 2,\n          height: r * 2\n        }, {\n          lineDash: [6],\n          color: \"white\"\n        });\n      }\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      if (this.drawingPointList.length > 0) {\n        var e = this.drawingHistory.undo();\n        if (!e) return;\n        this.drawingPointList = e, this.render();\n        return;\n      }\n      var t = this.history.undo();\n      t && (t.length !== this.polygonList.length && this.setSelectedID(\"\"), this.setPolygonList(t), this.render());\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      if (this.drawingPointList.length > 0) {\n        var e = this.drawingHistory.redo();\n        if (!e) return;\n        this.drawingPointList = e, this.render();\n        return;\n      }\n      var t = this.history.redo();\n      t && (t.length !== this.polygonList.length && this.setSelectedID(\"\"), this.setPolygonList(t), this.render());\n    }\n  }]);\n  return pi;\n}(st);\nvar bi = /*#__PURE__*/function (_st3) {\n  _inherits(bi, _st3);\n  var _super4 = _createSuper(bi);\n  function bi(t) {\n    var _this27;\n    _classCallCheck(this, bi);\n    _this27 = _super4.call(this, t);\n    _this27.getInitResultList = function (e, i) {\n      return !(e === 0 || e === void 0) && i.length === 0 ? [] : Lt.getDefaultTagResult(_this27.config.inputList, i);\n    }, _this27.setLabel = function (e, i) {\n      var r, n;\n      if (_this27.isImgError || !_this27.basicResult && _this27.dependToolName) return;\n      var o = _this27.config.inputList;\n      if (!o[e]) return;\n      var a = o[e].subSelected;\n      if (e < o.length && o[e].subSelected && a && i < a.length) {\n        var l = o[e].value;\n        var h = (r = a[i]) == null ? void 0 : r.value;\n        var c = (n = o[e]) == null ? void 0 : n.isMulti,\n          g = _this27.tagResult.filter(function (d) {\n            var u = \"\".concat(d.sourceID);\n            return x.isSameSourceID(u, _this27.sourceID);\n          })[0];\n        if (g) {\n          var d = 0;\n          var u = g.result;\n          g.sourceID === 0 && (g.sourceID = \"0\");\n          for (var f in g.result) if (f === o[e].value) {\n            if (d++, c === !0) {\n              var v = u[f].split(\";\").filter(function (p) {\n                  return p !== \"\";\n                }),\n                b = v.indexOf(h);\n              b === -1 ? v.push(h) : v.splice(b, 1), h = v.join(\";\");\n            }\n            h === \"\" ? Object.keys(u).length === 1 ? _this27.tagResult = _this27.tagResult.filter(function (v) {\n              var b = \"\".concat(v.sourceID);\n              return x.isDifferSourceID(b, _this27.sourceID);\n            }) : Object.keys(u).length > 1 && delete u[f] : u[f] = h;\n          }\n          d === 0 && Object.assign(g.result, _defineProperty({}, l, h));\n        } else _this27.tagResult = [{\n          sourceID: _this27.sourceID,\n          id: J(8, 62),\n          result: _defineProperty({}, l, h)\n        }];\n        _this27.render();\n      }\n    }, _this27.clearResult = function () {\n      var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n      var i = arguments.length > 1 ? arguments[1] : undefined;\n      i ? _this27.tagResult = _this27.tagResult.map(function (r) {\n        return (r == null ? void 0 : r.result[i]) && delete r.result[i], r;\n      }) : _this27.tagResult = [], _this27.render();\n    }, _this27.config = t.config, _this27.tagResult = [], _this27.labelSelectedList = [], _this27.setShowDefaultCursor(!0);\n    return _this27;\n  }\n  _createClass(bi, [{\n    key: \"destroy\",\n    value: function destroy() {\n      this.clearTag(), _get(_getPrototypeOf(bi.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      this.tagResult = t, this.render();\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      return [this.currentTagResult];\n    }\n  }, {\n    key: \"currentTagResult\",\n    get: function get() {\n      var _this28 = this;\n      var t;\n      return (t = this.tagResult.filter(function (e) {\n        var i = \"\".concat(e.sourceID);\n        return x.isSameSourceID(i, _this28.sourceID);\n      })[0]) != null ? t : {};\n    }\n  }, {\n    key: \"sourceID\",\n    get: function get() {\n      return x.getSourceID(this.basicResult);\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      var _this29 = this;\n      if (!x.hotkeyFilter(t)) return;\n      var e = t.keyCode;\n      if (e && (e <= 57 && e >= 49 || e <= 105 && e >= 97)) {\n        if (e > 57 ? e -= 97 : e -= 49, this.config.inputList.length === 1) {\n          this.labelSelectedList = [0, e], this.setLabel(0, e), setTimeout(function () {\n            _this29.labelSelectedList = [], _this29.render();\n          }, 500);\n          return;\n        }\n        this.labelSelectedList.length === 1 ? (this.labelSelectedList = [this.labelSelectedList[0], e], this.setLabel(this.labelSelectedList[0], e), setTimeout(function () {\n          _this29.labelSelectedList = [], _this29.render();\n        }, 500)) : (this.labelSelectedList = [e], this.emit(\"expend\"));\n      }\n    }\n  }, {\n    key: \"clearTag\",\n    value: function clearTag() {\n      var t;\n      var e = (t = this.canvas) == null ? void 0 : t.parentNode,\n        i = window.self.document.getElementById(\"tagToolTag\");\n      i && e && e.contains(i) && (e == null || e.removeChild(i));\n    }\n  }, {\n    key: \"renderTag\",\n    value: function renderTag() {\n      var t, e, i, r, n, o;\n      if (this.clearTag(), !(((t = this.tagResult) == null ? void 0 : t.length) > 0)) return;\n      var a = document.createElement(\"div\"),\n        l = Lt.getTagNameList((i = (e = this.tagResult[0]) == null ? void 0 : e.result) != null ? i : {}, this.config.inputList);\n      a.innerHTML = (r = l.reduce(function (h, c) {\n        return \"\".concat(h).concat(c.keyName, \": \").concat(c.value.join(\" \\u3001 \"), \"\\n\");\n      }, \"\")) != null ? r : \"\", a.setAttribute(\"id\", \"tagToolTag\"), a.setAttribute(\"style\", \"\\n        position: absolute;\\n        top: 0;\\n        right: 0;\\n        z-index: 5;\\n      \\n        padding: 0 20px;\\n      \\n        font-size: 15px;\\n        color: white;\\n        text-align: right;\\n        line-height: 32px;\\n        white-space: pre;\\n      \\n        background: rgba(102, 111, 255, 1);\\n        opacity: 0.6;\\n        clear: both;\\n      \"), (o = (n = this.canvas) == null ? void 0 : n.parentNode) == null || o.appendChild(a);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      this.renderTag(), _get(_getPrototypeOf(bi.prototype), \"render\", this).call(this), this.emit(\"render\");\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      var t = this.tagResult;\n      return this.isImgError && (t = []), [t, this.basicImgInfo];\n    }\n  }]);\n  return bi;\n}(st);\nvar $r = Object.defineProperty,\n  Fr = Object.defineProperties,\n  Zr = Object.getOwnPropertyDescriptors,\n  yi = Object.getOwnPropertySymbols,\n  Ur = Object.prototype.hasOwnProperty,\n  zr = Object.prototype.propertyIsEnumerable,\n  xi = function xi(s, t, e) {\n    return t in s ? $r(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  ue = function ue(s, t) {\n    for (var e in t || (t = {})) Ur.call(t, e) && xi(s, e, t[e]);\n    if (yi) {\n      var _iterator12 = _createForOfIteratorHelper(yi(t)),\n        _step12;\n      try {\n        for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n          var e = _step12.value;\n          zr.call(t, e) && xi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator12.e(err);\n      } finally {\n        _iterator12.f();\n      }\n    }\n    return s;\n  },\n  ge = function ge(s, t) {\n    return Fr(s, Zr(t));\n  },\n  mi;\n(function (s) {\n  s[s.Create = 0] = \"Create\", s[s.Active = 1] = \"Active\", s[s.None = 2] = \"None\";\n})(mi || (mi = {}));\nvar nt = 16,\n  Wt = {\n    x: 0,\n    y: 20\n  },\n  fe = 3,\n  jt = 5,\n  Vr = 2;\nvar wi = /*#__PURE__*/function (_st4) {\n  _inherits(wi, _st4);\n  var _super5 = _createSuper(wi);\n  function wi(t) {\n    var _thisSuper, _thisSuper2, _thisSuper3, _this30;\n    _classCallCheck(this, wi);\n    _this30 = _super5.call(this, t);\n    _this30.drawActivatedLine = function (e, i, r) {\n      var n = B.cloneDeep(_this30.activeLine);\n      if (!n || n.length === 0) return;\n      var o = _this30.isActiveLineValid();\n      var a;\n      var l = _this30.selectedID ? _this30.lineList.find(function (c) {\n        return c.id === _this30.selectedID;\n      }) : void 0;\n      l ? a = l.order : a = x.getAllToolsMaxOrder(_this30.lineList, _this30.prevResultList) + 1;\n      var h = _this30.getLineColorByAttribute({\n        attribute: _this30.defaultAttribute,\n        valid: !!o\n      });\n      n.map(function (c) {\n        return Object.assign(c, _this30.coordUtils.getRenderCoord(c));\n      }), _this30.updateActiveArea(), _this30.drawLine(n, e, h, !0, !0), _this30.drawLineNumber(n[0], a, h, \"\", _this30.defaultAttribute, o), e && _this30.isCreate && _this30.arc(e, fe, h), _this30.cursor && !_this30.selectedPoint && !r && !_this30.isShift && _this30.arc(_this30.cursor, jt, h);\n    }, _this30.drawHoverPoint = function (e) {\n      if (!_this30.isMousedown && e && _this30.isLineSelected) {\n        var i = _this30.getPointList(_this30.activeLine),\n          r = _this30.activeLine.find(function (o) {\n            return M.calcDistance(_this30.coordUtils.getRenderCoord(o), e) <= jt;\n          });\n        var n;\n        !r && _this30.activeLine && (n = _this30.findNearestPoint(i, e)), _this30.hoverPointID = r ? r.id : void 0, _this30.cursor = r || n == null ? void 0 : n.point;\n      }\n    }, _this30.lineList = [], _this30.activeLine = [], _this30.coordsInsideActiveArea = !1, _this30.hoverLineSegmentIndex = -1, _this30.isShift = !1, _this30.isReference = !1, _this30.drawCurveLine = function (e, i, r) {\n      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;\n      var o = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n      var a = arguments.length > 5 ? arguments[5] : undefined;\n      var l = Ht(i, nt);\n      e.save(), e.lineCap = \"round\", e.lineJoin = \"round\", e.strokeStyle = r.color, n && (e.lineWidth = r.lineWidth), o && M.setReferenceCtx(e), i.forEach(function (_ref7, c) {\n        var h = _ref7.specialEdge;\n        var g = l.splice(0, nt + 1);\n        e.save(), e.beginPath(), a === c && (e.lineWidth = 4), g.forEach(function (_ref8, f) {\n          var d = _ref8.x,\n            u = _ref8.y;\n          var v = f > 0 ? \"lineTo\" : \"moveTo\";\n          h && M.setSpecialEdgeStyle(e), e[v](d, u);\n        }), e.stroke(), e.restore();\n      }), e.restore();\n    }, _this30.drawLine = function (e, i, r) {\n      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;\n      var o = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n      var a = i ? e.concat(i) : e,\n        l = {\n          color: r,\n          lineWidth: o ? 1 : _this30.lineStyle.lineWidth\n        };\n      _this30.isCurve ? M.drawCurveLine(_this30.ctx, a, l, !n, _this30.isReference, o ? _this30.hoverLineSegmentIndex : -1) : _this30.drawStraightLine(a, l, o), n && e.forEach(function (h) {\n        var c, g;\n        var d = h.id,\n          u = d && [_this30.hoverPointID, (c = _this30.selectedPoint) == null ? void 0 : c.id].includes(d) ? jt : fe;\n        _this30.arc(h, u, r), [_this30.hoverPointID, (g = _this30.selectedPoint) == null ? void 0 : g.id].includes(d) || _this30.arc(h, Vr, \"white\");\n      });\n    }, _this30.drawStraightLine = function (e, i) {\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      var _assertThisInitialize4 = _assertThisInitialized(_this30),\n        n = _assertThisInitialize4.ctx;\n      n && (n.save(), n.lineCap = \"round\", n.lineJoin = \"round\", n.strokeStyle = i.color, n.lineWidth = i.lineWidth, _this30.isReference && M.setReferenceCtx(n), e.forEach(function (o, a) {\n        if (n.beginPath(), a > 0) {\n          var l = e[a - 1];\n          n.save(), (l == null ? void 0 : l.specialEdge) && M.setSpecialEdgeStyle(n), r && _this30.hoverLineSegmentIndex + 1 === a && (n.lineWidth = 4), n.moveTo(l.x, l.y), n.lineTo(o.x, o.y), n.stroke(), n.restore();\n        }\n      }), n.restore());\n    }, _this30.drawLines = function () {\n      try {\n        var e = B.cloneDeep(_this30.attributeFilteredLines);\n        if (_this30.isHidden) return;\n        _this30.container.dispatchEvent(_this30.saveDataEvent), e.forEach(function (i) {\n          if (i.id !== _this30.selectedID && i.pointList && i.isVisible) {\n            i.pointList.map(function (l) {\n              return Object.assign(l, _this30.coordUtils.getRenderCoord(l));\n            });\n            var r = i.order,\n              n = i.label,\n              o = r,\n              a = i && _this30.getLineColorByAttribute(i);\n            _this30.drawLine(i.pointList, void 0, a, !1), _this30.drawLineNumber(i.pointList[0], o, a, n, i.attribute, i.valid), i.id !== _this30.textEditingID && _this30.isShowAttributeText && _this30.drawLineTextAttribute(i.pointList[1], a, i == null ? void 0 : i.textAttribute);\n          }\n        });\n      } catch (e) {\n        console.error(e, \"\\u7EBF\\u6761\\u5DE5\\u5177\\u6570\\u636E\\u89E3\\u6790\\u9519\\u8BEF\"), _this30.lineList = [], _this30.clearCanvas();\n      }\n    }, _this30.render = function (e) {\n      !_this30.renderReady || (_get((_thisSuper = _assertThisInitialized(_this30), _getPrototypeOf(wi.prototype)), \"render\", _thisSuper).call(_thisSuper), _this30.drawLines(), _this30.drawActivatedLine(e, void 0, !0), _this30.renderCursorLine(_this30.getLineColor(_this30.defaultAttribute)));\n    }, _this30.moveLineInPolygon = function (e, i) {\n      var r;\n      if (!Array.isArray(_this30.activeLine)) return !1;\n      ((r = _this30.activeLine) == null ? void 0 : r.every(function (o) {\n        return _this30.isInBasicPolygon({\n          x: o.x + e,\n          y: o.y + i\n        });\n      })) && (_this30.lineDragging = !0, _this30.moveActiveArea(e, i));\n    }, _this30.moveLineInRectRange = function (e, i, r, n) {\n      if (_this30.activeArea === void 0) return;\n      var _this30$activeArea = _this30.activeArea,\n        o = _this30$activeArea.top,\n        a = _this30$activeArea.left,\n        l = _this30$activeArea.right,\n        h = _this30$activeArea.bottom,\n        c = [a, l].map(function (b) {\n          return B.isNumber(b) ? b + e : 0;\n        }),\n        g = [o, h].map(function (b) {\n          return B.isNumber(b) ? b + i : 0;\n        }),\n        d = a >= 0 && l && L.isInRange(c, r),\n        u = o >= 0 && h && L.isInRange(g, n),\n        f = d ? e : 0,\n        v = u ? i : 0;\n      _this30.lineDragging = !0, _this30.moveActiveArea(f, v);\n    }, _this30.onRightClick = function (e) {\n      if (_this30.cursor = void 0, _this30.isCreate) {\n        if (_this30.isLinePointsNotEnough()) return;\n        _this30.stopLineCreating(!0);\n        return;\n      }\n      _this30.setActiveArea(_this30.getCoordinate(e), !0), _this30.emit(\"contextmenu\");\n    }, _this30.updateSelectedAttributeAfterHistoryChanged = function () {\n      if (_this30.selectedID) {\n        var e = _this30.lineList.find(function (r) {\n            return r.id === _this30.selectedID;\n          }),\n          i = e == null ? void 0 : e.attribute;\n        typeof i == \"string\" && (_this30.defaultAttribute = i, _this30.updateAttribute(i), _this30.render());\n      }\n    }, _this30.onLeftClick = function (e) {\n      var i = _this30.getCoordinate(e),\n        _assertThisInitialize5 = _assertThisInitialized(_this30),\n        r = _assertThisInitialize5.lineDragging;\n      if (_this30.lineDragging = !1, _this30.isSpaceKey) return;\n      if (_this30.isNone && e.ctrlKey) {\n        var o = _this30.findHoverLine(i);\n        o && _this30.setInvalidLine(o.id);\n        return;\n      }\n      if (_this30.isLinePointsExceed()) return;\n      var n = _this30.getNextPoint(e, i);\n      if (_this30.isCreate || _this30.isNone) {\n        _this30.setCreatStatusAndAddPoint(n);\n        return;\n      }\n      if (_this30.isActive) {\n        if (r) return;\n        if (_this30.isMouseCoordOutsideActiveArea()) {\n          _this30.setNoneStatus(!1), _this30.setCreatStatusAndAddPoint(n);\n          return;\n        }\n        if (e.shiftKey) {\n          _this30.updateLineSegmentSpecial(i);\n          return;\n        }\n        if (_this30.coordsInsideActiveArea && e.ctrlKey) {\n          _this30.setInvalidLine(_this30.selectedID);\n          return;\n        }\n        _this30.addLinePointToActiveLine();\n      }\n    }, _this30.onDblclick = function () {}, _this30.onKeyUp = function (e) {\n      if (_get((_thisSuper2 = _assertThisInitialized(_this30), _getPrototypeOf(wi.prototype)), \"onKeyUp\", _thisSuper2).call(_thisSuper2, e), _this30.isShift = !1, _this30.hoverLineSegmentIndex = -1, e.keyCode === S.Esc) {\n        _this30.stopLineCreating(!1);\n        return;\n      }\n      if (_this30.isActive) {\n        if (e.keyCode === S.Delete) {\n          _this30.deleteLine();\n          return;\n        }\n        if (e.keyCode === S.F) {\n          _this30.setInvalidLine(_this30.selectedID);\n          return;\n        }\n        if (e.keyCode === S.Space) {\n          _this30.continueToEdit();\n          return;\n        }\n      }\n      _this30.keyboardEventWhileLineCreating(e);\n    }, _this30.onRightDblClick = function (e) {\n      _get((_thisSuper3 = _assertThisInitialized(_this30), _getPrototypeOf(wi.prototype)), \"onRightDblClick\", _thisSuper3).call(_thisSuper3, e);\n      var i = _this30.getCoordinate(e);\n      if (_this30.isActive) {\n        var r = _this30.findHoveredPoint(i);\n        if (r) {\n          _this30.deleteSelectedLinePoint(r.id);\n          return;\n        }\n        _this30.deleteSelectedLine(i);\n      }\n    }, _this30.setReference = function (e) {\n      _this30.isReference = e;\n    }, _this30.pointsWithinRange = function (e) {\n      return !(_this30.lowerLimitPointNum && e < _this30.lowerLimitPointNum || _this30.upperLimitPointNum && e > _this30.upperLimitPointNum);\n    }, _this30.setLineList = function (e) {\n      var i = e.length !== _this30.lineListLen;\n      _this30.lineList = e, i && _this30.emit(\"updatePageNumber\");\n    }, _this30.textChange = function (e) {\n      _this30.config.textConfigurable === !1 || !_this30.selectedID || (_this30.updateSelectedTextAttribute(e), _this30.emit(\"selectedChange\"));\n    }, _this30.status = 2, _this30.isMousedown = !1, _this30.lineDragging = !1, _this30.isLineValid = !0, _this30.setConfig(t.config), _this30.prevAxis = {\n      x: 0,\n      y: 0\n    }, _this30.textEditingID = \"\", _this30.updateSelectedTextAttribute = _this30.updateSelectedTextAttribute.bind(_assertThisInitialized(_this30)), _this30.getCurrentSelectedData = _this30.getCurrentSelectedData.bind(_assertThisInitialized(_this30)), _this30.actionsHistory = new ae(), _this30.dependToolConfig = {\n      lineType: R.Line\n    };\n    return _this30;\n  }\n  _createClass(wi, [{\n    key: \"isLineSelected\",\n    get: function get() {\n      return this.selectedID && this.activeLine;\n    }\n  }, {\n    key: \"selectedLinePoints\",\n    get: function get() {\n      return this.activeLine ? this.getPointList(this.activeLine) : [];\n    }\n  }, {\n    key: \"isCreate\",\n    get: function get() {\n      return this.status === 0;\n    }\n  }, {\n    key: \"isActive\",\n    get: function get() {\n      return this.status === 1;\n    }\n  }, {\n    key: \"isNone\",\n    get: function get() {\n      return this.status === 2;\n    }\n  }, {\n    key: \"isCurve\",\n    get: function get() {\n      return this.config.lineType === R.Curve;\n    }\n  }, {\n    key: \"isMultipleColor\",\n    get: function get() {\n      return this.config.lineColor === Nt.MultiColor;\n    }\n  }, {\n    key: \"imageSize\",\n    get: function get() {\n      return this.rotate % 180 == 0 ? this.basicImgInfo : {\n        width: this.basicImgInfo.height,\n        height: this.basicImgInfo.width\n      };\n    }\n  }, {\n    key: \"lineListLen\",\n    get: function get() {\n      return this.lineList.length;\n    }\n  }, {\n    key: \"edgeAdsorptionEnabled\",\n    get: function get() {\n      return this.edgeAdsorption && !this.isCurve && this.lineListLen > 0;\n    }\n  }, {\n    key: \"attributeConfigurable\",\n    get: function get() {\n      return this.config.attributeConfigurable;\n    }\n  }, {\n    key: \"isTextConfigurable\",\n    get: function get() {\n      return this.config.textConfigurable;\n    }\n  }, {\n    key: \"isDependPolygon\",\n    get: function get() {\n      return this.dependToolName === P.Polygon;\n    }\n  }, {\n    key: \"isDependRect\",\n    get: function get() {\n      return this.dependToolName === P.Rect;\n    }\n  }, {\n    key: \"isCurrentAttributeLocked\",\n    get: function get() {\n      return this.attributeLockList.includes(this.defaultAttribute);\n    }\n  }, {\n    key: \"attributeFilteredLines\",\n    get: function get() {\n      var _this31 = this;\n      return this.attributeLockList.length > 0 ? this.lineList.filter(function (t) {\n        return _this31.attributeLockList.includes((t == null ? void 0 : t.attribute) || \"\");\n      }) : this.lineList;\n    }\n  }, {\n    key: \"enableOutOfTarget\",\n    get: function get() {\n      var t, e;\n      return (e = (t = this.config.drawOutsideTarget) != null ? t : this.config.enableOutOfTarget) != null ? e : this.config.outOfTarget;\n    }\n  }, {\n    key: \"showOrder\",\n    get: function get() {\n      return this.config.showOrder;\n    }\n  }, {\n    key: \"edgeAdsorption\",\n    get: function get() {\n      return this.config.edgeAdsorption;\n    }\n  }, {\n    key: \"attributeList\",\n    get: function get() {\n      var t;\n      return (t = this.config) == null ? void 0 : t.attributeList;\n    }\n  }, {\n    key: \"lowerLimitPointNum\",\n    get: function get() {\n      return this.config.lowerLimitPointNum;\n    }\n  }, {\n    key: \"upperLimitPointNum\",\n    get: function get() {\n      return this.config.upperLimitPointNum;\n    }\n  }, {\n    key: \"textCheckType\",\n    get: function get() {\n      return this.config.textCheckType;\n    }\n  }, {\n    key: \"customFormat\",\n    get: function get() {\n      return this.config.customFormat;\n    }\n  }, {\n    key: \"dataList\",\n    get: function get() {\n      return this.lineList;\n    }\n  }, {\n    key: \"hasActiveLine\",\n    get: function get() {\n      return this.activeLine && this.activeLine.length > 0;\n    }\n  }, {\n    key: \"viewPortLines\",\n    get: function get() {\n      var t = at.getViewPort(this.canvas, this.currentPos, this.zoom);\n      return this.isHidden ? [] : this.attributeFilteredLines.filter(function (e) {\n        var i;\n        return (i = e == null ? void 0 : e.pointList) == null ? void 0 : i.some(function (r) {\n          return at.inViewPort(r, t);\n        });\n      });\n    }\n  }, {\n    key: \"lineStyle\",\n    get: function get() {\n      return {\n        lineWidth: this.style.width,\n        color: this.getLineColor(this.defaultAttribute),\n        opacity: this.style.opacity\n      };\n    }\n  }, {\n    key: \"selectedText\",\n    get: function get() {\n      var _this32 = this;\n      var t, e;\n      return (e = (t = this.lineList.find(function (i) {\n        return i.id === _this32.selectedID;\n      })) == null ? void 0 : t.textAttribute) != null ? e : \"\";\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      return this.lineList;\n    }\n  }, {\n    key: \"updateStatus\",\n    value: function updateStatus(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      if (t !== this.status) {\n        if (e) {\n          var i = \"\";\n          this.textCheckType === K.Order && this.isTextConfigurable && (i = T.getTextAttribute(this.lineList, this.textCheckType)), this.emit(\"updateText\", i);\n        }\n        this.status = t, this.lineStatusChanged();\n      }\n    }\n  }, {\n    key: \"isInBasicPolygon\",\n    value: function isInBasicPolygon(t) {\n      var e, i;\n      return Re(t, ((e = this.basicResult) == null ? void 0 : e.pointList) || [], (i = this.dependToolConfig) == null ? void 0 : i.lineType);\n    }\n  }, {\n    key: \"getPolygonPointList\",\n    value: function getPolygonPointList() {\n      if (!this.basicResult) return [];\n      var t = this.basicResult.pointList,\n        e = this.dependToolConfig.lineType;\n      return e === R.Curve ? re(t.reduce(function (i, r) {\n        return [].concat(_toConsumableArray(i), [r.x, r.y]);\n      }, []), .5, !0, 20) : t;\n    }\n  }, {\n    key: \"getNextCoordByRenderCoord\",\n    value: function getNextCoordByRenderCoord(t) {\n      return this.getNextCoordByAbsCoord(this.coordUtils.getAbsCoord(t));\n    }\n  }, {\n    key: \"getNextCoordByAbsCoord\",\n    value: function getNextCoordByAbsCoord(t) {\n      var e;\n      var i = (e = this.activeLine) == null ? void 0 : e.slice(-1)[0];\n      return i ? this.coordUtils.getNextCoordByDependTool(t, i) : t;\n    }\n  }, {\n    key: \"pointInLine\",\n    value: function pointInLine(t, e, i) {\n      var _this33 = this;\n      return t.filter(function (r) {\n        return r;\n      }).length < 2 ? !1 : t.some(function (r, n) {\n        if (n === 0) return !1;\n        var o = _this33.coordUtils.getRenderCoord(t[n - 1]),\n          a = _this33.coordUtils.getRenderCoord(r);\n        return M.isInLine(e, o, a, i);\n      });\n    }\n  }, {\n    key: \"arc\",\n    value: function arc(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : fe;\n      var i = arguments.length > 2 ? arguments[2] : undefined;\n      var r, n, o, a, l, h;\n      if (this.ctx) {\n        var c = t.x,\n          g = t.y;\n        (r = this.ctx) == null || r.save(), (n = this.ctx) == null || n.beginPath(), this.ctx.fillStyle = i || this.lineStyle.color, (o = this.ctx) == null || o.arc(c, g, e, 0, 360), (a = this.ctx) == null || a.closePath(), (l = this.ctx) == null || l.fill(), (h = this.ctx) == null || h.restore();\n      }\n    }\n  }, {\n    key: \"renderActiveArea\",\n    value: function renderActiveArea() {\n      if (this.isActive && this.activeArea && this.ctx) {\n        var _this$activeArea = this.activeArea,\n          t = _this$activeArea.top,\n          e = _this$activeArea.left,\n          i = _this$activeArea.right,\n          r = _this$activeArea.bottom,\n          _this$coordUtils$getR = this.coordUtils.getRenderCoord({\n            x: e,\n            y: t\n          }),\n          n = _this$coordUtils$getR.x,\n          o = _this$coordUtils$getR.y;\n        this.ctx.save(), this.ctx.beginPath(), this.ctx.strokeStyle = \"#B3B8FF\", this.ctx.rect(n, o, (i - e) * this.zoom, (r - t) * this.zoom), this.ctx.stroke(), this.ctx.restore();\n      }\n    }\n  }, {\n    key: \"addLinePoint\",\n    value: function addLinePoint(t) {\n      var e, i, r, n;\n      this.arc(t), (e = this.activeLine) == null || e.push(ge(ue({}, t), {\n        id: J()\n      })), ((i = this.activeLine) == null ? void 0 : i.length) === 1 ? (r = this.actionsHistory) == null || r.initRecord(this.activeLine) : (n = this.actionsHistory) == null || n.pushHistory(this.activeLine), this.render();\n    }\n  }, {\n    key: \"setCreatStatusAndAddPoint\",\n    value: function setCreatStatusAndAddPoint(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      this.updateStatus(0, e), this.addLinePoint(t);\n    }\n  }, {\n    key: \"isActiveLineValid\",\n    value: function isActiveLineValid() {\n      var _this34 = this;\n      var t;\n      return this.selectedID ? (t = this.lineList.find(function (e) {\n        return e.id === _this34.selectedID;\n      })) == null ? void 0 : t.valid : this.isLineValid;\n    }\n  }, {\n    key: \"nextOrder\",\n    value: function nextOrder() {\n      return this.lineListLen === 0 ? 1 : this.lineList.slice(-1)[0].order + 1;\n    }\n  }, {\n    key: \"getLineColorByAttribute\",\n    value: function getLineColorByAttribute(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      return et.getStrokeAndFill(this.getColor(t.attribute), t.valid, {\n        isSelected: e\n      }).stroke;\n    }\n  }, {\n    key: \"updateActiveArea\",\n    value: function updateActiveArea() {\n      this.activeArea = this.getActiveArea(), this.renderActiveArea();\n    }\n  }, {\n    key: \"getActiveArea\",\n    value: function getActiveArea() {\n      return this.hasActiveLine ? L.calcViewportBoundaries(this.activeLine, this.isCurve, nt, this.zoom) : void 0;\n    }\n  }, {\n    key: \"drawLineNumber\",\n    value: function drawLineNumber(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var i = arguments.length > 2 ? arguments[2] : undefined;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"\";\n      var n = arguments.length > 4 ? arguments[4] : undefined;\n      var o = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !0;\n      var a, l, h;\n      if ((this.isShowOrder || this.attributeConfigurable) && this.ctx) {\n        var c = this.isShowOrder ? e.toString() : \"\".concat(r);\n        if (this.attributeConfigurable) {\n          var g = n ? (h = (l = (a = this.attributeList) == null ? void 0 : a.find(function (d) {\n            return d.value === n;\n          })) == null ? void 0 : l.key) != null ? h : n : \"\";\n          c = [c, \"\".concat(!o && g ? \"\\u65E0\\u6548\" : \"\").concat(g)].filter(function (d) {\n            return d;\n          }).join(\" \");\n        }\n        this.drawText(t, c, i);\n      }\n    }\n  }, {\n    key: \"drawLineTextAttribute\",\n    value: function drawLineTextAttribute(t, e, i) {\n      if (t && i) return this.drawText(t, i, e, 200);\n    }\n  }, {\n    key: \"drawText\",\n    value: function drawText(t, e, i, r) {\n      var n, o;\n      this.ctx && ((n = this.ctx) == null || n.save(), this.ctx.font = yt, this.ctx.fillStyle = i, this.ctx.strokeStyle = i, r ? m.wrapText(this.canvas, e, t.x - Wt.x, t.y - Wt.y, r) : this.ctx.fillText(e, t.x - Wt.x - 10, t.y - Wt.y + 10), (o = this.ctx) == null || o.restore());\n    }\n  }, {\n    key: \"moveActiveArea\",\n    value: function moveActiveArea(t, e) {\n      this.activeArea && (this.activeArea = Object.assign(this.activeArea, {\n        top: this.activeArea.top + e,\n        bottom: this.activeArea.bottom + e,\n        right: this.activeArea.right + t,\n        left: this.activeArea.left + t\n      })), this.activeLine && (this.activeLine.map(function (i) {\n        return Object.assign(i, {\n          x: i.x + t,\n          y: i.y + e\n        });\n      }), this.updateLines());\n    }\n  }, {\n    key: \"findHoveredPoint\",\n    value: function findHoveredPoint(t) {\n      var _this35 = this;\n      if (!!this.activeLine) return this.activeLine.find(function (e) {\n        var i = _this35.coordUtils.getRenderCoord(e);\n        return M.calcDistance(i, t) <= jt;\n      });\n    }\n  }, {\n    key: \"findHoverLine\",\n    value: function findHoverLine(t) {\n      var _this36 = this;\n      return B.cloneDeep(this.lineList).reverse().find(function (_ref9) {\n        var i = _ref9.pointList;\n        var r = i ? _this36.getPointList(i) : [],\n          n = _this36.getLineWidthScope();\n        return r.some(function (o, a) {\n          if (a === 0) return !1;\n          var l = _this36.coordUtils.getRenderCoord(o),\n            h = _this36.coordUtils.getRenderCoord(r[a - 1]);\n          return M.isInLine(t, l, h, n);\n        });\n      });\n    }\n  }, {\n    key: \"getAdsorptionPoint\",\n    value: function getAdsorptionPoint(t) {\n      var _this37 = this;\n      var e, i, r;\n      return B.cloneDeep(this.lineList).reverse().forEach(function (_ref10) {\n        var n = _ref10.pointList,\n          o = _ref10.id;\n        if (o === _this37.selectedID || !n || (n == null ? void 0 : n.length) < 2) return;\n        var a = _this37.findNearestPoint(n, t);\n        if (a) {\n          if (a.minDistance === 0) {\n            e = a.point;\n            return;\n          }\n          (i === void 0 || a.minDistance < i) && (e = a.point, i = a.minDistance);\n        }\n      }), r || e;\n    }\n  }, {\n    key: \"findNearestPoint\",\n    value: function findNearestPoint(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 7;\n      var r;\n      var n = i;\n      for (var o = 1; o <= t.length - 1; o++) {\n        var a = this.coordUtils.getRenderCoord(t[o]),\n          l = this.coordUtils.getRenderCoord(t[o - 1]),\n          _L$getFootOfPerpendic3 = L.getFootOfPerpendicular(e, a, l),\n          h = _L$getFootOfPerpendic3.length,\n          c = _L$getFootOfPerpendic3.footPoint,\n          g = M.calcTwoPointDistance(a, e),\n          d = M.calcTwoPointDistance(l, e);\n        if (g <= i * 2) {\n          r = a, i = 0;\n          break;\n        }\n        if (d <= i * 2) {\n          r = l, i = 0;\n          break;\n        }\n        h < i && (r = c, i = h);\n      }\n      return r ? {\n        point: r,\n        minDistance: n\n      } : void 0;\n    }\n  }, {\n    key: \"getPointList\",\n    value: function getPointList(t) {\n      return this.isCurve ? Ht(t, nt) : t;\n    }\n  }, {\n    key: \"moveSelectedLine\",\n    value: function moveSelectedLine(t) {\n      var e = (t.x - this.prevAxis.x) / this.zoom,\n        i = (t.y - this.prevAxis.y) / this.zoom;\n      if (this.enableOutOfTarget) {\n        this.lineDragging = !0, this.moveActiveArea(e, i);\n        return;\n      }\n      if (this.isDependPolygon) {\n        this.moveLineInPolygon(e, i);\n        return;\n      }\n      var r = [0, this.imageSize.width],\n        n = [0, this.imageSize.height];\n      if (this.isDependRect) {\n        var _this$basicResult = this.basicResult,\n          o = _this$basicResult.x,\n          a = _this$basicResult.y,\n          l = _this$basicResult.width,\n          h = _this$basicResult.height;\n        r = [o, o + l], n = [a, a + h];\n      }\n      this.moveLineInRectRange(e, i, r, n);\n    }\n  }, {\n    key: \"moveSelectPoint\",\n    value: function moveSelectPoint(t) {\n      if (!this.selectedPoint) return;\n      var e = t.x - this.prevAxis.x,\n        i = t.y - this.prevAxis.y,\n        r = (this.selectedPoint ? this.selectedPoint.x : 0) + e / this.zoom,\n        n = (this.selectedPoint ? this.selectedPoint.y : 0) + i / this.zoom,\n        o = {\n          x: r,\n          y: n\n        };\n      Object.assign(this.selectedPoint, this.getNextCoordByAbsCoord(o)), this.updateLines(), this.render();\n    }\n  }, {\n    key: \"getCoordByConfig\",\n    value: function getCoordByConfig(t, e) {\n      var i;\n      var r = !!t.shiftKey,\n        n = t.altKey;\n      if (((i = this.activeLine) == null ? void 0 : i.length) > 0 && r) {\n        var o = this.activeLine.slice(-1)[0];\n        return M.getVHPoint(o, e, this.coordUtils.getAbsCoord(e), this.coordUtils.getRenderCoord(o));\n      }\n      return this.edgeAdsorptionEnabled && !n ? this.getAdsorptionPoint(e) : e;\n    }\n  }, {\n    key: \"getNextPoint\",\n    value: function getNextPoint(t, e) {\n      var i = this.getCoordByConfig(t, e) || e;\n      return this.enableOutOfTarget ? i : this.getNextCoordByRenderCoord(i);\n    }\n  }, {\n    key: \"lineHover\",\n    value: function lineHover() {\n      this.render();\n    }\n  }, {\n    key: \"mouseMoveHandler\",\n    value: function mouseMoveHandler(t) {\n      var e = this.getCoordinate(t),\n        i = t.which === 1;\n      if (this.isCreate) {\n        this.hasActiveLine && this.renderNextPoint(t, e);\n        return;\n      }\n      if (this.isNone && (this.lineHover(), this.edgeAdsorptionEnabled && !t.altKey)) {\n        var r = this.getAdsorptionPoint(e);\n        r && this.arc(r);\n      }\n      if (this.isActive) {\n        if (this.isMousedown && i) {\n          if (this.selectedPoint) {\n            this.moveSelectPoint(e);\n            return;\n          }\n          if (this.coordsInsideActiveArea) {\n            this.moveSelectedLine(e), this.drawActivatedLine(void 0, void 0, !0);\n            return;\n          }\n        }\n        this.drawHoverPoint(e), this.render();\n      }\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      if (_get(_getPrototypeOf(wi.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      var e = this.getCoordinate(t);\n      this.mouseMoveHandler(t), this.prevAxis = e;\n    }\n  }, {\n    key: \"setActiveAreaByPoint\",\n    value: function setActiveAreaByPoint(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = this.coordUtils.getRenderCoord(t),\n        r = this.findHoverLine(i);\n      if (r) {\n        var n = this.lineList.findIndex(function (l) {\n            return l.id === (r == null ? void 0 : r.id);\n          }),\n          o = L.calcViewportBoundaries((r == null ? void 0 : r.pointList) || [], this.isCurve, nt, this.zoom),\n          a = this.lineList[n];\n        this.updateStatus(1), this.setActiveLine(a.pointList), this.setSelectedLineID(a.id), this.activeArea = o, this.updateLineAttributes(a);\n      } else e && this.setNoneStatus();\n      this.render();\n    }\n  }, {\n    key: \"setActiveArea\",\n    value: function setActiveArea(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = this.findHoverLine(t);\n      if (i) {\n        var r = this.lineList.findIndex(function (a) {\n            return a.id === (i == null ? void 0 : i.id);\n          }),\n          n = L.calcViewportBoundaries((i == null ? void 0 : i.pointList) || [], this.isCurve, nt, this.zoom),\n          o = this.lineList[r];\n        this.updateStatus(1), this.setActiveLine(o.pointList), this.setSelectedLineID(o.id), this.activeArea = n, this.updateLineAttributes(o);\n      } else e && this.setNoneStatus();\n      this.render();\n    }\n  }, {\n    key: \"setActiveLineByID\",\n    value: function setActiveLineByID(t) {\n      var e = this.lineList.find(function (i) {\n        return i.id === t;\n      });\n      if (e) {\n        var i = L.calcViewportBoundaries((e == null ? void 0 : e.pointList) || [], this.isCurve, nt, this.zoom);\n        this.updateStatus(1), this.setActiveLine(e.pointList), this.setSelectedLineID(e.id), this.activeArea = i, this.updateLineAttributes(e);\n      }\n      this.render();\n    }\n  }, {\n    key: \"setActiveLine\",\n    value: function setActiveLine(t) {\n      this.activeLine = t ? B.cloneDeep(t) : void 0;\n    }\n  }, {\n    key: \"historyChanged\",\n    value: function historyChanged(t) {\n      var _this38 = this;\n      var e = \"\".concat(t, \"Enabled\");\n      if (this.isCreate) {\n        if (this.actionsHistory && this.actionsHistory[e]) {\n          var i = this.actionsHistory && this.actionsHistory[t]();\n          this.setActiveLine(i), this.render();\n        }\n        return;\n      }\n      if (this.history && this.history[e]) {\n        var _i5 = this.history[t](),\n          r = _i5 == null ? void 0 : _i5.find(function (n) {\n            return n.id === _this38.selectedID;\n          });\n        this.lineList = _i5, this.selectedID && r ? this.setActiveLine(r == null ? void 0 : r.pointList) : this.setNoneStatus(), this.render();\n      }\n      this.emit(\"dataUpdated\", this.dataList);\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      this.historyChanged(\"undo\"), this.updateSelectedAttributeAfterHistoryChanged();\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      this.historyChanged(\"redo\"), this.updateSelectedAttributeAfterHistoryChanged();\n    }\n  }, {\n    key: \"isCoordInsideTarget\",\n    value: function isCoordInsideTarget(t) {\n      if (this.isDependPolygon) return this.isInBasicPolygon(t);\n      if (this.isDependRect) {\n        var _this$basicResult2 = this.basicResult,\n          e = _this$basicResult2.x,\n          i = _this$basicResult2.y,\n          r = _this$basicResult2.width,\n          n = _this$basicResult2.height,\n          o = [e, e + r],\n          a = [i, i + n];\n        return L.isInRange(t.x, o) && L.isInRange(t.y, a);\n      }\n      return L.isInRange(t.x, [0, this.imageSize.width]) && L.isInRange(t.y, [0, this.imageSize.height]);\n    }\n  }, {\n    key: \"getPointInsertIndex\",\n    value: function getPointInsertIndex(t, e) {\n      var _this39 = this;\n      if (t && this.activeLine) {\n        var i = this.getPointList(this.activeLine);\n        return this.activeLine.length === 2 ? 1 : this.activeLine.findIndex(function (r, n) {\n          if (n > 0) {\n            var o = _this39.activeLine ? _this39.activeLine[n - 1] : void 0,\n              a = _this39.isCurve ? i.slice((n - 1) * (nt + 1), n * (nt + 1)) : [o, r];\n            return _this39.pointInLine(a, t, e || _this39.getLineWidthScope());\n          }\n          return !1;\n        });\n      }\n      return -1;\n    }\n  }, {\n    key: \"getLineWidthScope\",\n    value: function getLineWidthScope() {\n      return this.lineStyle.lineWidth;\n    }\n  }, {\n    key: \"isMouseCoordOutsideActiveArea\",\n    value: function isMouseCoordOutsideActiveArea() {\n      return !this.coordsInsideActiveArea && !this.selectedPoint;\n    }\n  }, {\n    key: \"isLinePointsExceed\",\n    value: function isLinePointsExceed() {\n      return this.isCreate && this.activeLine && this.upperLimitPointNum && ~~this.upperLimitPointNum <= this.activeLine.length;\n    }\n  }, {\n    key: \"isLinePointsNotEnough\",\n    value: function isLinePointsNotEnough() {\n      var t;\n      return this.activeLine && ((t = this.activeLine) == null ? void 0 : t.length) < this.lowerLimitPointNum;\n    }\n  }, {\n    key: \"updateLineSegmentSpecial\",\n    value: function updateLineSegmentSpecial(t) {\n      var e = this.getPointInsertIndex(t, 2) - 1;\n      if (e > -1) {\n        var i = this.activeLine[e];\n        i.specialEdge = !i.specialEdge, this.hoverLineSegmentIndex = -1, this.render();\n      }\n    }\n  }, {\n    key: \"addLinePointToActiveLine\",\n    value: function addLinePointToActiveLine() {\n      var t;\n      var e = this.getPointInsertIndex(this.cursor),\n        i = this.pointsWithinRange(this.activeLine.length + 1);\n      this.cursor && e > -1 && i && (this.activeLine.splice(e, 0, ge(ue({}, this.coordUtils.getAbsCoord(this.cursor)), {\n        id: J()\n      })), this.updateLines(), (t = this.history) == null || t.pushHistory(this.lineList), this.render(), this.cursor = void 0);\n    }\n  }, {\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      if (_get(_getPrototypeOf(wi.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      var e = this.getCoordinate(t);\n      if (this.isMousedown = !0, this.prevAxis = e, t.which === 3) {\n        this.cursor = void 0;\n        return;\n      }\n      this.selectedPoint = this.findHoveredPoint(e), this.coordsInsideActiveArea = this.isActive && this.activeArea ? M.inArea(this.activeArea, this.coordUtils.getAbsCoord(e)) : !1, this.lineDragging = !1;\n    }\n  }, {\n    key: \"lineHasChanged\",\n    value: function lineHasChanged() {\n      var _this40 = this;\n      var t = this.lineList.find(function (e) {\n        return e.id === _this40.selectedID;\n      });\n      return t ? JSON.stringify(t.pointList) !== JSON.stringify(this.activeLine) : !1;\n    }\n  }, {\n    key: \"updateLines\",\n    value: function updateLines() {\n      var _this41 = this;\n      var t = this.lineList.find(function (e) {\n        return e.id === _this41.selectedID;\n      });\n      t && (t.pointList = B.cloneDeep(this.activeLine), this.emit(\"dataUpdated\", this.lineList));\n    }\n  }, {\n    key: \"onMouseUp\",\n    value: function onMouseUp(t) {\n      var _this42 = this;\n      var e = function e() {\n        _this42.isMousedown = !1, _this42.hoverPointID = void 0, _this42.cursor = void 0, _this42.selectedPoint = void 0;\n      };\n      if (this.hoverPointID = void 0, _get(_getPrototypeOf(wi.prototype), \"onMouseUp\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) {\n        e();\n        return;\n      }\n      t.which === 1 && this.onLeftClick(t), t.which === 3 && this.onRightClick(t), e();\n    }\n  }, {\n    key: \"isTextValid\",\n    value: function isTextValid(t) {\n      return T.textAttributeValidate(this.textCheckType, this.customFormat, t);\n    }\n  }, {\n    key: \"createLineData\",\n    value: function createLineData() {\n      var t = J(),\n        e = {\n          pointList: B.cloneDeep(this.activeLine),\n          id: t,\n          valid: this.isLineValid,\n          order: x.getAllToolsMaxOrder(this.lineList, this.prevResultList) + 1,\n          isVisible: !0\n        };\n      return e.attribute = this.defaultAttribute, e;\n    }\n  }, {\n    key: \"stopLineCreating\",\n    value: function stopLineCreating() {\n      var _this43 = this;\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n      var e, i, r, n;\n      var o = this.selectedID ? !0 : !!this.isTextConfigurable;\n      var a;\n      if (t) {\n        if (this.selectedID) {\n          var l = this.lineList.find(function (h) {\n            return h.id === _this43.selectedID;\n          });\n          a = this.selectedID, l && (l.pointList = B.cloneWith(this.activeLine), B.isEqual(l.pointList, (e = this.history) == null ? void 0 : e.pushHistory(this.lineList)) || (i = this.history) == null || i.pushHistory(this.lineList));\n        } else if (this.isCreate && this.activeLine && this.activeLine.length > 1) {\n          var _l = this.createLineData();\n          a = _l.id, this.setLineList([].concat(_toConsumableArray(this.lineList), [_l])), (r = this.history) == null || r.pushHistory(this.lineList);\n        }\n      }\n      o ? this.setActiveStatus(a) : this.setNoneStatus(), (n = this.actionsHistory) == null || n.empty(), this.emit(\"dataUpdated\", this.lineList), this.render();\n    }\n  }, {\n    key: \"setActiveStatus\",\n    value: function setActiveStatus(t) {\n      var e = t ? this.lineList.find(function (i) {\n        return i.id === t;\n      }) : void 0;\n      if (e) {\n        var i = e == null ? void 0 : e.pointList;\n        this.updateStatus(1), this.setActiveLine(i), this.setSelectedLineID(t);\n      } else this.setNoneStatus();\n    }\n  }, {\n    key: \"setNoneStatus\",\n    value: function setNoneStatus() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n      t && this.updateStatus(2), this.activeLine = [], this.setSelectedLineID(void 0), this.activeArea = void 0, this.isLineValid = !0, this.cursor = void 0;\n    }\n  }, {\n    key: \"setKeyDownStatus\",\n    value: function setKeyDownStatus(t, e) {\n      this.isShift = e != null ? e : t.keyCode === S.Shift;\n    }\n  }, {\n    key: \"continueToEdit\",\n    value: function continueToEdit() {\n      var t;\n      this.updateStatus(0), this.cursor = void 0, (t = this.actionsHistory) == null || t.pushHistory(this.activeLine), this.render();\n    }\n  }, {\n    key: \"setInvalidLineOnCreating\",\n    value: function setInvalidLineOnCreating(t) {\n      if (this.selectedID && t.keyCode !== S.Ctrl || !this.isCreate) return;\n      var e = !t.ctrlKey;\n      this.selectedID ? this.setInvalidLine(this.selectedID, e, !1) : this.isLineValid = e;\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      var e;\n      if (_get(_getPrototypeOf(wi.prototype), \"onKeyDown\", this).call(this, t), this.setKeyDownStatus(t), t.keyCode === S.Shift && this.render(), t.keyCode === S.Tab) {\n        t.preventDefault(), this.selectToNextLine(t);\n        return;\n      }\n      if (this.isCreate && this.keyboardEventWhileLineCreating(t), this.config.attributeConfigurable) {\n        var i = T.getAttributeByKeycode(t.keyCode, (e = this.config) == null ? void 0 : e.attributeList);\n        i !== void 0 && this.setDefaultAttribute(i);\n      }\n    }\n  }, {\n    key: \"selectToNextLine\",\n    value: function selectToNextLine(t) {\n      var e = x.getNextSelectedRectIDByEvent(this.viewPortLines.map(function (i) {\n        var r, n, o, a;\n        return ge(ue({}, i), {\n          x: (n = (r = i.pointList[0]) == null ? void 0 : r.x) != null ? n : 0,\n          y: (a = (o = i.pointList[0]) == null ? void 0 : o.y) != null ? a : 0\n        });\n      }), t, this.selectedID);\n      e && this.setActiveLineByID(e.id);\n    }\n  }, {\n    key: \"keyboardEventWhileLineCreating\",\n    value: function keyboardEventWhileLineCreating(t) {\n      !this.isCreate || (t.keyCode === S.Ctrl && this.setInvalidLineOnCreating(t), [S.Shift, S.Alt].includes(t.keyCode) && this.renderNextPoint(t, this.prevAxis));\n    }\n  }, {\n    key: \"renderNextPoint\",\n    value: function renderNextPoint(t, e) {\n      var i = this.coordUtils.getRenderCoord(this.getNextPoint(t, e));\n      this.render(i);\n    }\n  }, {\n    key: \"deleteSelectedLine\",\n    value: function deleteSelectedLine(t) {\n      var e = L.calcViewportBoundaries(this.activeLine, this.isCurve, nt, this.zoom);\n      M.inArea(e, this.coordUtils.getAbsCoord(t)) && this.deleteLine();\n    }\n  }, {\n    key: \"deleteSelectedLinePoint\",\n    value: function deleteSelectedLinePoint(t) {\n      var e;\n      this.pointsWithinRange(this.activeLine.length - 1) && t && (this.setActiveLine(this.activeLine.filter(function (r) {\n        return r.id !== t;\n      })), this.updateLines(), (e = this.history) == null || e.pushHistory(this.lineList)), this.cursor = void 0, this.render();\n    }\n  }, {\n    key: \"deleteLine\",\n    value: function deleteLine() {\n      var _this44 = this;\n      var t;\n      this.lineList = this.lineList.filter(function (e) {\n        return e.id !== _this44.selectedID;\n      }), (t = this.history) == null || t.pushHistory(this.lineList), this.setNoneStatus(), this.emit(\"dataUpdated\", this.lineList), this.render();\n    }\n  }, {\n    key: \"setInvalidLine\",\n    value: function setInvalidLine(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;\n      var r;\n      var n = this.lineList.find(function (o) {\n        return o.id === t;\n      });\n      n && (n.valid = e !== void 0 ? e : !n.valid, (r = this.history) == null || r.pushHistory(this.lineList), i && this.render());\n    }\n  }, {\n    key: \"empty\",\n    value: function empty() {\n      var t, e;\n      this.lineList = [], this.setNoneStatus(), this.selectedPoint = void 0, (t = this.actionsHistory) == null || t.empty(), (e = this.history) == null || e.init(), this.emit(\"dataUpdated\", this.lineList), this.render();\n    }\n  }, {\n    key: \"setAttribute\",\n    value: function setAttribute(t) {\n      var e;\n      this.attributeConfigurable && (this.defaultAttribute = t, this.setLineAttribute(\"attribute\", t), this.selectedID && ((e = this.history) == null || e.pushHistory(this.lineList)));\n    }\n  }, {\n    key: \"setTextAttribute\",\n    value: function setTextAttribute(t) {\n      var e;\n      this.isTextConfigurable && (this.setLineAttribute(\"textAttribute\", t), (e = this.history) == null || e.applyAttribute(this.selectedID, \"textAttribute\", t));\n    }\n  }, {\n    key: \"setLineAttribute\",\n    value: function setLineAttribute(t, e, i) {\n      var r = i || this.selectedID;\n      if (r) {\n        var n = this.lineList.find(function (o) {\n          return o.id === r;\n        });\n        n && (n[t] = e);\n      }\n      this.render();\n    }\n  }, {\n    key: \"updateAttribute\",\n    value: function updateAttribute(t) {\n      this.emit(\"updateAttribute\", t);\n    }\n  }, {\n    key: \"updateLineAttributes\",\n    value: function updateLineAttributes(t) {\n      var e;\n      if (this.attributeConfigurable && t) {\n        var i = (t == null ? void 0 : t.attribute) || \"\";\n        this.defaultAttribute = i, this.updateAttribute(i);\n      }\n      if (this.isTextConfigurable && t) {\n        var _i6 = (t == null ? void 0 : t.textAttribute) || \"\";\n        this.updateTextAttribute(_i6);\n      }\n      (e = this.history) == null || e.updateHistory(this.lineList);\n    }\n  }, {\n    key: \"lineStatusChanged\",\n    value: function lineStatusChanged() {\n      this.emit(\"lineStatusChanged\", {\n        status: this.status,\n        selectedLineID: this.selectedID\n      });\n    }\n  }, {\n    key: \"updateTextAttribute\",\n    value: function updateTextAttribute(t) {\n      var _this45 = this;\n      if (this.selectedID) {\n        var e = this.lineList.find(function (i) {\n          return i.id === _this45.selectedID;\n        });\n        e && (e.textAttribute = t);\n      }\n      this.emit(\"updateText\", t);\n    }\n  }, {\n    key: \"saveData\",\n    value: function saveData() {\n      this.stopLineCreating(), this.setNoneStatus(), this.render();\n    }\n  }, {\n    key: \"setTextEditingID\",\n    value: function setTextEditingID(t) {\n      this.textEditingID = t, this.render();\n    }\n  }, {\n    key: \"setSelectedLineID\",\n    value: function setSelectedLineID(t) {\n      var e, i;\n      if (this.selectedID === t) return;\n      var r = this.selectedID;\n      t !== r && r && ((e = this._textAttributeInstance) == null || e.changeSelected()), t || (i = this._textAttributeInstance) == null || i.clearTextAttribute(), this.selectedID = t, this.emit(\"selectedChange\");\n    }\n  }, {\n    key: \"attributeLockListChange\",\n    value: function attributeLockListChange(t) {\n      this.attributeLockList = t, this.render();\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      this.setNoneStatus(), this.setLineList(t), this.render();\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(t) {\n      _get(_getPrototypeOf(wi.prototype), \"setConfig\", this).call(this, t);\n    }\n  }, {\n    key: \"toggleIsHide\",\n    value: function toggleIsHide() {\n      this.setIsHidden(!this.isHidden), this.render();\n    }\n  }, {\n    key: \"clearCanvas\",\n    value: function clearCanvas() {\n      _get(_getPrototypeOf(wi.prototype), \"clearCanvas\", this).call(this);\n    }\n  }, {\n    key: \"clearResult\",\n    value: function clearResult() {\n      this.setResult([]), this.setSelectedLineID(void 0), this.render();\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      return [this.lineList, this.basicImgInfo];\n    }\n  }, {\n    key: \"setDefaultAttribute\",\n    value: function setDefaultAttribute() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e;\n      this.attributeConfigurable && (this.defaultAttribute = t, this.setLineAttribute(\"attribute\", t), this.selectedID && ((e = this.history) == null || e.pushHistory(this.lineList)), this.emit(\"changeAttributeSidebar\"));\n    }\n  }, {\n    key: \"getCurrentSelectedData\",\n    value: function getCurrentSelectedData() {\n      var _this46 = this;\n      var t, e;\n      var i = this.isActiveLineValid(),\n        r = this.defaultAttribute,\n        n = this.getColor(r),\n        o = i ? n == null ? void 0 : n.valid.stroke : n == null ? void 0 : n.invalid.stroke,\n        a = (e = (t = this.lineList.find(function (l) {\n          return l.id === _this46.selectedID;\n        })) == null ? void 0 : t.textAttribute) != null ? e : \"\";\n      return {\n        color: o,\n        textAttribute: a\n      };\n    }\n  }, {\n    key: \"renderTextAttribute\",\n    value: function renderTextAttribute() {\n      var _this47 = this;\n      var t, e, i, r;\n      if (!this.ctx || !this.activeLine || ((t = this.activeLine) == null ? void 0 : t.length) < 2 || this.isCreate) return;\n      var n = this.isActiveLineValid(),\n        o = this.defaultAttribute,\n        _this$activeLine$ = this.activeLine[1],\n        a = _this$activeLine$.x,\n        l = _this$activeLine$.y,\n        h = this.coordUtils.getRenderCoord({\n          x: a,\n          y: l\n        }),\n        c = this.getColor(o),\n        g = n ? c == null ? void 0 : c.valid.stroke : c == null ? void 0 : c.invalid.stroke,\n        d = (i = (e = this.lineList.find(function (u) {\n          return u.id === _this47.selectedID;\n        })) == null ? void 0 : e.textAttribute) != null ? i : \"\";\n      this._textAttributeInstance || (this._textAttributeInstance = new Vt({\n        container: this.container,\n        icon: this.getTextIconSvg(o),\n        color: g,\n        getCurrentSelectedData: this.getCurrentSelectedData,\n        updateSelectedTextAttribute: this.updateSelectedTextAttribute\n      })), this._textAttributeInstance && !((r = this._textAttributeInstance) == null ? void 0 : r.isExit) && this._textAttributeInstance.appendToContainer(), this._textAttributeInstance.update(\"\".concat(d), {\n        left: h.x,\n        top: h.y,\n        color: g\n      }), this._textAttributeInstance.updateIcon(this.getTextIconSvg(o));\n    }\n  }, {\n    key: \"getTextIconSvg\",\n    value: function getTextIconSvg() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      return T.getTextIconSvg(t, this.config.attributeList, this.config.attributeConfigurable, this.baseIcon);\n    }\n  }, {\n    key: \"updateSelectedTextAttribute\",\n    value: function updateSelectedTextAttribute(t) {\n      if (this._textAttributeInstance && t && this.selectedID) {\n        var e = t;\n        !T.textAttributeValidate(this.config.textCheckType, this.customFormat, e) && (this.emit(\"messageError\", T.getErrorNotice(this.config.textCheckType, this.lang)), e = \"\"), this.setTextAttribute(e), this.emit(\"updateTextAttribute\"), this.render();\n      }\n    }\n  }]);\n  return wi;\n}(st);\nvar ve = /*#__PURE__*/function () {\n  function ve() {\n    _classCallCheck(this, ve);\n  }\n  _createClass(ve, null, [{\n    key: \"getMarkerShowText\",\n    value: function getMarkerShowText(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      return T.getAttributeShowText(t, e);\n    }\n  }]);\n  return ve;\n}();\nvar Wr = Object.defineProperty,\n  jr = Object.defineProperties,\n  Xr = Object.getOwnPropertyDescriptors,\n  Ii = Object.getOwnPropertySymbols,\n  Kr = Object.prototype.hasOwnProperty,\n  Yr = Object.prototype.propertyIsEnumerable,\n  Li = Math.pow,\n  Pi = function Pi(s, t, e) {\n    return t in s ? Wr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Xt = function Xt(s, t) {\n    for (var e in t || (t = {})) Kr.call(t, e) && Pi(s, e, t[e]);\n    if (Ii) {\n      var _iterator13 = _createForOfIteratorHelper(Ii(t)),\n        _step13;\n      try {\n        for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {\n          var e = _step13.value;\n          Yr.call(t, e) && Pi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator13.e(err);\n      } finally {\n        _iterator13.f();\n      }\n    }\n    return s;\n  },\n  pe = function pe(s, t) {\n    return jr(s, Xr(t));\n  };\nvar Ci = 200;\nvar Di = /*#__PURE__*/function (_st5) {\n  _inherits(Di, _st5);\n  var _super6 = _createSuper(Di);\n  function Di(t) {\n    var _this48;\n    _classCallCheck(this, Di);\n    _this48 = _super6.call(this, t);\n    _this48.setMarkerIndex = function (e) {\n      _this48.markerIndex = e;\n    }, _this48.setMarkerIndexAndSelect = function (e) {\n      if (!_this48.config.markerList) return;\n      _this48.markerIndex = e;\n      var i = _this48.config.markerList[e].value,\n        r = _this48.currentPageResult.find(function (n) {\n          return n.label === i;\n        });\n      r && (_this48.setSelectedID(r.id), _this48.config.attributeConfigurable === !0 && _this48.setDefaultAttribute(r.attribute)), _this48.emit(\"markIndexChange\");\n    }, _this48.textChange = function (e) {\n      _this48.config.textConfigurable !== !0 || !_this48.selectedID || (_this48.setPointList(T.textChange(e, _this48.selectedID, _this48.pointList)), _this48.emit(\"selectedChange\"), _this48.render());\n    }, _this48.isMinDistance = function (e) {\n      var i = w.changePointByZoom(e, _this48.zoom);\n      return _this48.pointList.some(function (r) {\n        var n = w.changePointByZoom(r, _this48.zoom);\n        return L.getLineLength(n, i) < .2;\n      });\n    }, _this48.config = x.jsonParser(t.config), _this48.pointList = [], _this48.markerIndex = 0, _this48.setStyle(t.style), _this48.createPoint = _this48.createPoint.bind(_assertThisInitialized(_this48)), _this48.getCurrentSelectedData = _this48.getCurrentSelectedData.bind(_assertThisInitialized(_this48)), _this48.updateSelectedTextAttribute = _this48.updateSelectedTextAttribute.bind(_assertThisInitialized(_this48)), _this48.setSelectedID = _this48.setSelectedID.bind(_assertThisInitialized(_this48));\n    return _this48;\n  }\n  _createClass(Di, [{\n    key: \"dataList\",\n    get: function get() {\n      return this.pointList;\n    }\n  }, {\n    key: \"drawOutsideTarget\",\n    get: function get() {\n      var t;\n      return (t = this.config.drawOutsideTarget) != null ? t : this.config.drawPointOut;\n    }\n  }, {\n    key: \"setNextMarker\",\n    value: function setNextMarker() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.pointList;\n      if (this.hasMarkerConfig) {\n        var e = x.getNextMarker(this.getCurrentPageResult(t), this.config.markerList);\n        e && this.setMarkerIndexAndSelect(e.index);\n      }\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      this.clearActiveStatus(), this.setPointList(t), this.setNextMarker(t), this.render();\n    }\n  }, {\n    key: \"setPointList\",\n    value: function setPointList(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = this.pointList.length;\n      this.pointList = t, i !== t.length && this.emit(\"updatePageNumber\"), e && this.emit(\"updateResult\");\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      this.config = x.jsonParser(t), e === !0 && this.clearResult();\n    }\n  }, {\n    key: \"clearResult\",\n    value: function clearResult() {\n      this.setPointList([]), this.setSelectedID(void 0), this.history.pushHistory([]), this.hoverID = \"\", this.render();\n    }\n  }, {\n    key: \"setDefaultAttribute\",\n    value: function setDefaultAttribute() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e = this.defaultAttribute;\n      if (this.defaultAttribute = t, e !== t) {\n        this.changeStyle(t), this.emit(\"changeAttributeSidebar\");\n        var i = this.selectedID;\n        if (i && (this.pointList.forEach(function (r) {\n          r.id === i && (r.attribute = t);\n        }), this.history.pushHistory(this.pointList), this.render()), this._textAttributInstance) {\n          if (this.attributeLockList.length > 0 && !this.attributeLockList.includes(t)) {\n            this._textAttributInstance.clearTextAttribute();\n            return;\n          }\n          this._textAttributInstance.updateIcon(this.getTextIconSvg(t));\n        }\n      }\n    }\n  }, {\n    key: \"selectedText\",\n    get: function get() {\n      var _this49 = this;\n      var t;\n      return (t = this.pointList.find(function (e) {\n        return e.id === _this49.selectedID;\n      })) == null ? void 0 : t.textAttribute;\n    }\n  }, {\n    key: \"setStyle\",\n    value: function setStyle(t) {\n      var e;\n      _get(_getPrototypeOf(Di.prototype), \"setStyle\", this).call(this, t), this._textAttributInstance && this.config.attributeConfigurable === !1 && ((e = this._textAttributInstance) == null || e.updateIcon(this.getTextIconSvg()));\n    }\n  }, {\n    key: \"setSelectedID\",\n    value: function setSelectedID(t) {\n      var e, i;\n      var r = this.selectedID;\n      t !== r && r && ((e = this._textAttributInstance) == null || e.changeSelected()), t || (i = this._textAttributInstance) == null || i.clearTextAttribute(), this.selectedID = t, this.render(), this.emit(\"selectedChange\");\n    }\n  }, {\n    key: \"getTextIconSvg\",\n    value: function getTextIconSvg() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      var e;\n      return T.getTextIconSvg(t, (e = this.config) == null ? void 0 : e.attributeList, this.config.attributeConfigurable, this.baseIcon);\n    }\n  }, {\n    key: \"clearActiveStatus\",\n    value: function clearActiveStatus() {\n      this.hoverID = void 0, this.dragStatus = O.Wait, this.setSelectedID(void 0);\n    }\n  }, {\n    key: \"setBasicResult\",\n    value: function setBasicResult(t) {\n      _get(_getPrototypeOf(Di.prototype), \"setBasicResult\", this).call(this, t), this.setNextMarker(), this.clearActiveStatus();\n    }\n  }, {\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      if (!(_get(_getPrototypeOf(Di.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation)) {\n        if (t.button === 0 && !this.hoverID) {\n          this.createPoint(t), this.render();\n          return;\n        }\n        return this.hoverID === this.selectedID && t.button === 0 && (this.dragStatus = O.Start), this.render(), !0;\n      }\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      _get(_getPrototypeOf(Di.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo || (this.hoverID = this.getHoverId(), (this.dragStatus === O.Start || this.dragStatus === O.Move) && this.onDragMove(t), this.hoverID && this.render());\n    }\n  }, {\n    key: \"onMouseUp\",\n    value: function onMouseUp(t) {\n      if (_get(_getPrototypeOf(Di.prototype), \"onMouseUp\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return !0;\n      t.button === 2 && this.rightMouseUp(), this.dragStatus === O.Move && this.history.pushHistory(this.pointList), this.dragStatus = O.Wait, this.render();\n    }\n  }, {\n    key: \"onDragMove\",\n    value: function onDragMove(t) {\n      var _this50 = this;\n      var e, i;\n      if (!this.imgInfo) return;\n      this.dragStatus = O.Move;\n      var r = this.getCoordinateUnderZoom(t),\n        n = w.changeDrawOutsideTarget(r, {\n          x: 0,\n          y: 0\n        }, this.imgInfo, this.drawOutsideTarget, this.basicResult, this.zoom),\n        o = this.drawOutsideTarget ? w.getOriginCoordinateWithOffsetCoordinate(this.coord, this.zoom, this.currentPos) : w.changePointByZoom(n, 1 / this.zoom);\n      this.drawOutsideTarget === !1 && this.dependToolName === P.Polygon && ((i = (e = this.basicResult) == null ? void 0 : e.pointList) == null ? void 0 : i.length) > 0 && !D.isInPolygon(o, this.basicResult.pointList) || (this.pointList.forEach(function (a) {\n        a.id === _this50.selectedID && (a.x = o.x, a.y = o.y);\n      }), this.render());\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      var e;\n      if (!x.hotkeyFilter(t) || _get(_getPrototypeOf(Di.prototype), \"onKeyDown\", this).call(this, t) === !1) return;\n      var i = t.keyCode;\n      switch (i) {\n        case S.Delete:\n          this.deletePoint();\n          break;\n        case S.Tab:\n          {\n            this.onTabKeyDown(t);\n            break;\n          }\n        default:\n          {\n            if (this.config.attributeConfigurable) {\n              var r = T.getAttributeByKeycode(i, (e = this.config) == null ? void 0 : e.attributeList);\n              r !== void 0 && this.setDefaultAttribute(r);\n            }\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"createPoint\",\n    value: function createPoint(t) {\n      var e, i, r, n;\n      if (!this.imgInfo) return;\n      var o = this.config.upperLimit;\n      if (o && this.currentPageResult.length >= o && this.pointList.length >= o) {\n        this.emit(\"messageInfo\", \"\".concat(H.getMessagesByLocale(C.LowerLimitPoint, this.lang)));\n        return;\n      }\n      var a = x.getSourceID(this.basicResult),\n        l = this.getCoordinateUnderZoom(t);\n      var h = w.getOriginCoordinateWithOffsetCoordinate(this.coord, this.zoom, this.currentPos);\n      if (this.config.edgeAdsorption && this.referenceData && [P.Polygon, P.Line].includes((e = this.referenceData) == null ? void 0 : e.toolName)) {\n        var u = ((i = this.referenceData) == null ? void 0 : i.toolName) === P.Polygon,\n          _D$getClosestPoint4 = D.getClosestPoint(h, this.referenceData.result, (n = (r = this.referenceData.config) == null ? void 0 : r.lineType) != null ? n : R.Line, xt / this.zoom, {\n            isClose: u\n          }),\n          f = _D$getClosestPoint4.dropFoot,\n          v = _D$getClosestPoint4.hasClosed;\n        f && (h = f), v && this.emit(\"messageSuccess\", \"\".concat(H.getMessagesByLocale(C.SuccessfulEdgeAdsorption, this.lang)));\n      }\n      if (this.drawOutsideTarget === !1) {\n        if (this.dependToolName && this.basicCanvas) {\n          var d = !1;\n          switch (this.dependToolName) {\n            case P.Rect:\n              {\n                d = !U.isInRect(h, this.basicResult);\n                break;\n              }\n            case P.Polygon:\n              {\n                d = !D.isInPolygon(h, this.basicResult.pointList);\n                break;\n              }\n          }\n          if (d) return;\n        }\n        if (l.x < 0 || l.y < 0 || l.x > this.imgInfo.width || l.y > this.imgInfo.height) return;\n      }\n      if (this.isMinDistance(h)) return;\n      var c = pe(Xt({}, h), {\n        isVisible: !0,\n        attribute: this.defaultAttribute,\n        valid: !t.ctrlKey,\n        id: J(8, 62),\n        sourceID: a,\n        textAttribute: \"\",\n        order: x.getAllToolsMaxOrder(this.pointList, this.prevResultList) + 1\n      });\n      if (this.config.textConfigurable) {\n        var _d6 = \"\";\n        _d6 = T.getTextAttribute(this.pointList.filter(function (u) {\n          return x.isSameSourceID(u.sourceID, a);\n        }), this.config.textCheckType), c = pe(Xt({}, c), {\n          textAttribute: _d6\n        });\n      }\n      if (this.hasMarkerConfig) {\n        var _d7 = x.getNextMarker(this.currentPageResult, this.config.markerList, this.markerIndex);\n        if (_d7) c = pe(Xt({}, c), {\n          label: _d7.label\n        }), this.markerIndex = _d7.index, this.emit(\"markIndexChange\");else {\n          this.emit(\"messageInfo\", H.getMessagesByLocale(C.MarkerFinish, this.lang));\n          return;\n        }\n      }\n      this.hoverID = c.id;\n      var g = [].concat(_toConsumableArray(this.pointList), [c]);\n      this.setPointList(g), this.history.pushHistory(g), this.setSelectedID(c.id);\n    }\n  }, {\n    key: \"isInPoint\",\n    value: function isInPoint(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.zoom;\n      return (this.style.width + 2) / i >= Math.sqrt(Li(t.x - e.x, 2) + Li(t.y - e.y, 2));\n    }\n  }, {\n    key: \"getHoverId\",\n    value: function getHoverId() {\n      var _this51 = this;\n      var t;\n      var e = w.getOriginCoordinateWithOffsetCoordinate(this.coord, this.zoom, this.currentPos),\n        i = (t = this.pointList) == null ? void 0 : t.find(function (r) {\n          return _this51.isInPoint(e, r);\n        });\n      return i == null ? void 0 : i.id;\n    }\n  }, {\n    key: \"rightMouseUp\",\n    value: function rightMouseUp() {\n      var _this52 = this;\n      if (this.selectedID === this.hoverID) {\n        var e = this.pointList.filter(function (i) {\n          return i.id !== _this52.selectedID;\n        });\n        this.setPointList(e), this.history.pushHistory(e), this.setSelectedID(\"\"), this.hoverID = \"\";\n        return;\n      }\n      var t = this.pointList.find(function (e) {\n        return e.id === _this52.hoverID;\n      });\n      if (this.setSelectedID(this.hoverID), this.setDefaultAttribute(t == null ? void 0 : t.attribute), (t == null ? void 0 : t.label) && this.hasMarkerConfig) {\n        var _e6 = x.getCurrentMarkerIndex(t.label, this.config.markerList);\n        _e6 >= 0 && (this.setMarkerIndex(_e6), this.emit(\"markIndexChange\"));\n      }\n    }\n  }, {\n    key: \"onTabKeyDown\",\n    value: function onTabKeyDown(t) {\n      if (t.preventDefault(), this.dragStatus === O.Move || this.dragStatus === O.Start) return;\n      var e = G.ascend;\n      t.shiftKey && (e = G.descend);\n      var _x$getRenderResultLis7 = x.getRenderResultList(this.pointList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedID),\n        _x$getRenderResultLis8 = _slicedToArray(_x$getRenderResultLis7, 2),\n        i = _x$getRenderResultLis8[0],\n        r = _x$getRenderResultLis8[1];\n      var n = _toConsumableArray(i);\n      r && (n = [].concat(_toConsumableArray(n), [r]));\n      var o = x.getNextSelectedRectID(n, e, this.selectedID);\n      o && this.setSelectedID(o.id);\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      var _x$getRenderResultLis9 = x.getRenderResultList(this.pointList, x.getSourceID(this.basicResult), []),\n        _x$getRenderResultLis10 = _slicedToArray(_x$getRenderResultLis9, 1),\n        t = _x$getRenderResultLis10[0];\n      return t;\n    }\n  }, {\n    key: \"getCurrentPageResult\",\n    value: function getCurrentPageResult(t) {\n      var _x$getRenderResultLis11 = x.getRenderResultList(t, x.getSourceID(this.basicResult), []),\n        _x$getRenderResultLis12 = _slicedToArray(_x$getRenderResultLis11, 1),\n        e = _x$getRenderResultLis12[0];\n      return e;\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      var t = this.pointList;\n      return [t, this.basicImgInfo];\n    }\n  }, {\n    key: \"deletePoint\",\n    value: function deletePoint() {\n      var _this53 = this;\n      var t;\n      this.selectedID && (this.setPointList(this.pointList.filter(function (e) {\n        return e.id !== _this53.selectedID;\n      })), this.history.pushHistory(this.pointList), (t = this._textAttributInstance) == null || t.clearTextAttribute(), this.emit(\"selectedChange\"), this.render());\n    }\n  }, {\n    key: \"undoAndRedo\",\n    value: function undoAndRedo(t) {\n      var _this54 = this;\n      var e, i;\n      if (this.dragStatus === O.Move || this.dragStatus === O.Start) return;\n      var r = (i = (e = this.history)[t]) == null ? void 0 : i.call(e);\n      (r == null ? void 0 : r.some(function (n) {\n        return n.id === _this54.selectedID;\n      })) || this.setSelectedID(\"\"), r && (this.setPointList(r, !0), this.render());\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      this.undoAndRedo(\"undo\");\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      this.undoAndRedo(\"redo\");\n    }\n  }, {\n    key: \"getCurrentSelectedData\",\n    value: function getCurrentSelectedData() {\n      var _this55 = this;\n      var t;\n      if (!this.selectedID) return;\n      var e = (t = this.pointList) == null ? void 0 : t.find(function (n) {\n          return n.id === _this55.selectedID;\n        }),\n        i = this.getColor(e == null ? void 0 : e.attribute),\n        r = (e == null ? void 0 : e.valid) ? i == null ? void 0 : i.valid.stroke : i == null ? void 0 : i.invalid.stroke;\n      return this.dragStatus = O.Wait, {\n        width: Ci * this.zoom * .6,\n        textAttribute: (e == null ? void 0 : e.textAttribute) || \"\",\n        color: r\n      };\n    }\n  }, {\n    key: \"updateSelectedTextAttribute\",\n    value: function updateSelectedTextAttribute(t) {\n      if (this._textAttributInstance && t && this.selectedID) {\n        var e = t;\n        T.textAttributeValidate(this.config.textCheckType, \"\", e) === !1 && (this.emit(\"messageError\", T.getErrorNotice(this.config.textCheckType, this.lang)), e = \"\"), this.setPointList(T.textChange(e, this.selectedID, this.pointList)), this.emit(\"updateTextAttribute\"), this.render();\n      }\n    }\n  }, {\n    key: \"renderTextAttribute\",\n    value: function renderTextAttribute() {\n      var _this56 = this;\n      var t, e;\n      var i = (t = this.pointList) == null ? void 0 : t.find(function (u) {\n        return u.id === _this56.selectedID;\n      });\n      if (!this.ctx || this.config.textConfigurable !== !0 || !i) return;\n      var r = i.x,\n        n = i.y,\n        o = i.attribute,\n        a = i.valid,\n        l = Ci * this.zoom * .6,\n        h = w.getOffsetCoordinate({\n          x: r,\n          y: n\n        }, this.currentPos, this.zoom),\n        c = this.getColor(o),\n        g = a ? c == null ? void 0 : c.valid.stroke : c == null ? void 0 : c.invalid.stroke,\n        d = 4;\n      this._textAttributInstance || (this._textAttributInstance = new Vt({\n        width: l,\n        container: this.container,\n        icon: this.getTextIconSvg(o),\n        color: g,\n        getCurrentSelectedData: this.getCurrentSelectedData,\n        updateSelectedTextAttribute: this.updateSelectedTextAttribute\n      })), this._textAttributInstance && !((e = this._textAttributInstance) == null ? void 0 : e.isExit) && this._textAttributInstance.appendToContainer(), this._textAttributInstance.update(\"\".concat(i.textAttribute), {\n        left: h.x,\n        top: h.y + d,\n        color: g,\n        width: l\n      });\n    }\n  }, {\n    key: \"renderPoint\",\n    value: function renderPoint(t) {\n      var e;\n      if (!t.isVisible) return;\n      var _t$textAttribute = t.textAttribute,\n        i = _t$textAttribute === void 0 ? \"\" : _t$textAttribute,\n        r = t.attribute,\n        n = t.id === this.selectedID,\n        o = this.getColor(r),\n        a = w.changePointByZoom(t, this.zoom, this.currentPos),\n        _this$style3 = this.style,\n        _this$style3$width = _this$style3.width,\n        l = _this$style3$width === void 0 ? 2 : _this$style3$width,\n        _this$style3$hiddenTe = _this$style3.hiddenText,\n        h = _this$style3$hiddenTe === void 0 ? !1 : _this$style3$hiddenTe,\n        c = et.getStrokeAndFill(o, t.valid, {\n          isSelected: n || t.id === this.hoverID\n        });\n      m.drawCircle(this.canvas, a, l, {\n        startAngleDeg: 0,\n        endAngleDeg: 360,\n        thickness: 1,\n        color: c.stroke,\n        fill: \"transparent\"\n      });\n      var g = \"\";\n      this.isShowOrder && t.order && (t == null ? void 0 : t.order) > 0 && (g = \"\".concat(t.order)), t.label && this.hasMarkerConfig && (g = \"\".concat(x.getAllToolsMaxOrder(this.pointList, this.prevResultList) + 1, \"_\").concat(ve.getMarkerShowText(t.label, this.config.markerList))), t.attribute && (g = \"\".concat(g, \"  \").concat(T.getAttributeShowText(t.attribute, (e = this.config) == null ? void 0 : e.attributeList))), h || m.drawText(this.canvas, {\n        x: a.x + l / 2,\n        y: a.y - l - 4\n      }, g, {\n        textAlign: \"center\",\n        color: c.stroke\n      }), n || !h && this.isShowAttributeText && m.drawText(this.canvas, {\n        x: a.x + l,\n        y: a.y + l + 24\n      }, i, Xt({\n        color: c.stroke\n      }, Z));\n    }\n  }, {\n    key: \"renderPointList\",\n    value: function renderPointList() {\n      var _this57 = this;\n      var _x$getRenderResultLis13 = x.getRenderResultList(this.pointList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedID),\n        _x$getRenderResultLis14 = _slicedToArray(_x$getRenderResultLis13, 2),\n        t = _x$getRenderResultLis14[0],\n        e = _x$getRenderResultLis14[1];\n      this.container.dispatchEvent(this.saveDataEvent), this.isHidden || t.forEach(function (i) {\n        _this57.renderPoint(i);\n      }), e && this.renderPoint(e);\n    }\n  }, {\n    key: \"renderTop\",\n    value: function renderTop() {\n      var t, e, i;\n      var r = this.getLineColor(this.defaultAttribute);\n      if (this.renderCursorLine(r), this.config.edgeAdsorption && this.referenceData) {\n        var n = w.getOriginCoordinateWithOffsetCoordinate(this.coord, this.zoom, this.currentPos);\n        var o = ((t = this.referenceData) == null ? void 0 : t.toolName) === P.Polygon,\n          _D$getClosestPoint5 = D.getClosestPoint(n, this.referenceData.result, (i = (e = this.referenceData.config) == null ? void 0 : e.lineType) != null ? i : R.Line, xt / this.zoom, {\n            isClose: o\n          }),\n          a = _D$getClosestPoint5.dropFoot;\n        a && n !== a && n !== a && (n = a, m.drawCircle(this.canvas, w.changePointByZoom(n, this.zoom, this.currentPos), 5, {\n          color: \"white\",\n          fill: \"white\"\n        }), m.drawCircle(this.canvas, w.changePointByZoom(n, this.zoom, this.currentPos), 3, {\n          fill: r,\n          color: r\n        }));\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      !this.ctx || !this.renderReady || (_get(_getPrototypeOf(Di.prototype), \"render\", this).call(this), this.renderPointList(), this.renderTop());\n    }\n  }]);\n  return Di;\n}(st);\nvar _i = /*#__PURE__*/function (_st6) {\n  _inherits(_i, _st6);\n  var _super7 = _createSuper(_i);\n  function _i(t) {\n    var _this58;\n    _classCallCheck(this, _i);\n    _this58 = _super7.call(this, t);\n    _this58.getSingleResult = function (e) {\n      var i = {};\n      return _this58.config.configList.length > 0 && _this58.config.configList.forEach(function (r) {\n        var n;\n        i[r.key] = (n = r.default) != null ? n : \"\";\n      }), {\n        value: i,\n        id: J(),\n        sourceID: e != null ? e : x.getSourceID()\n      };\n    }, _this58.getInitResultList = function (e, i) {\n      return e > 0 ? i.map(function (r) {\n        return _this58.getSingleResult(r.id);\n      }) : [_this58.getSingleResult()];\n    }, _this58.textList = [], _this58.setShowDefaultCursor(!0), _this58.setConfig(t.config);\n    return _this58;\n  }\n  _createClass(_i, [{\n    key: \"dataList\",\n    get: function get() {\n      return this.textList;\n    }\n  }, {\n    key: \"textValueContainerID\",\n    get: function get() {\n      return \"textValueContainer\";\n    }\n  }, {\n    key: \"textValueContainer\",\n    get: function get() {\n      return document.getElementById(this.textValueContainerID);\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      return this.textList;\n    }\n  }, {\n    key: \"setResult\",\n    value: function setResult(t) {\n      var _this59 = this;\n      var e;\n      this.textList = t, this.toggleTextContainerVisible(!0);\n      var i = (e = this.textList[0]) == null ? void 0 : e.value;\n      i && Object.keys(i).forEach(function (r) {\n        _this59.renderText(r, i[r]);\n      }), this.emit(\"valueUpdated\"), this.toggleTextContainerVisible(!!i);\n    }\n  }, {\n    key: \"updateTextValue\",\n    value: function updateTextValue(t, e) {\n      this.textList[0].value[t] = e, this.renderText(t, e), this.emit(\"valueUpdated\");\n    }\n  }, {\n    key: \"renderText\",\n    value: function renderText(t, e) {\n      var i = document.getElementById(\"textKey\".concat(t));\n      i && (i.innerText = e);\n    }\n  }, {\n    key: \"getTextDomID\",\n    value: function getTextDomID(t) {\n      return \"textKey\".concat(t);\n    }\n  }, {\n    key: \"initTextDisplayContainer\",\n    value: function initTextDisplayContainer() {\n      var _this60 = this;\n      var t = document.createElement(\"div\"),\n        e = {\n          position: \"absolute\",\n          right: \"0\",\n          top: \"0\",\n          \"z-index\": \"20\",\n          \"max-width\": \"20%\",\n          \"font-family\": \"SourceHanSansCN-Regular\",\n          background: \"rgb(102, 230, 255)\",\n          color: \"white\",\n          \"word-break\": \"break-all\",\n          \"line-height\": \"24px\",\n          \"white-space\": \"pre-wrap\",\n          \"max-height\": \"80%\",\n          \"overflow-y\": \"auto\",\n          opacity: \"0.6\"\n        };\n      t.setAttribute(\"style\", Object.keys(e).reduce(function (i, r) {\n        return i += \"\".concat(r, \": \").concat(e[r], \";\"), i;\n      }, \"\")), t.setAttribute(\"id\", this.textValueContainerID), this.config.configList.forEach(function (i) {\n        var r = document.createElement(\"div\"),\n          n = document.createElement(\"div\"),\n          o = document.createElement(\"div\");\n        r.setAttribute(\"style\", \"padding: 8px 16px\"), n.innerText = \"\".concat(i.key, \":\"), o.innerText = \"\", o.setAttribute(\"id\", _this60.getTextDomID(i.key)), r.appendChild(n), r.appendChild(o), t.appendChild(r);\n      }), this.container.appendChild(t);\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      return [this.textList, this.basicImgInfo];\n    }\n  }, {\n    key: \"destroyCanvas\",\n    value: function destroyCanvas() {\n      _get(_getPrototypeOf(_i.prototype), \"destroyCanvas\", this).call(this), this.textValueContainer && this.container.removeChild(this.textValueContainer);\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      _get(_getPrototypeOf(_i.prototype), \"onKeyDown\", this).call(this, t), t.keyCode === S.Z && this.toggleTextContainerVisible();\n    }\n  }, {\n    key: \"toggleTextContainerVisible\",\n    value: function toggleTextContainerVisible(t) {\n      if (this.textValueContainer) {\n        var e = (t !== void 0 ? !t : this.textValueContainer.style.display === \"block\") ? \"none\" : \"block\";\n        this.textValueContainer.style.display = e;\n      }\n    }\n  }]);\n  return _i;\n}(st);\nvar Gr = Object.defineProperty,\n  Jr = Object.defineProperties,\n  qr = Object.getOwnPropertyDescriptors,\n  Ai = Object.getOwnPropertySymbols,\n  Qr = Object.prototype.hasOwnProperty,\n  tn = Object.prototype.propertyIsEnumerable,\n  Ri = function Ri(s, t, e) {\n    return t in s ? Gr(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Ti = function Ti(s, t) {\n    for (var e in t || (t = {})) Qr.call(t, e) && Ri(s, e, t[e]);\n    if (Ai) {\n      var _iterator14 = _createForOfIteratorHelper(Ai(t)),\n        _step14;\n      try {\n        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {\n          var e = _step14.value;\n          tn.call(t, e) && Ri(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator14.e(err);\n      } finally {\n        _iterator14.f();\n      }\n    }\n    return s;\n  },\n  en = function en(s, t) {\n    return Jr(s, qr(t));\n  };\nvar x = /*#__PURE__*/function () {\n  function x() {\n    _classCallCheck(this, x);\n  }\n  _createClass(x, null, [{\n    key: \"getStepInfo\",\n    value: function getStepInfo(t, e) {\n      return e == null ? void 0 : e.filter(function (i) {\n        return i.step === t;\n      })[0];\n    }\n  }, {\n    key: \"getCurrentStepInfo\",\n    value: function getCurrentStepInfo(t, e) {\n      var i = this.getStepInfo(t, e);\n      return i && (i.type === At.QUALITY_INSPECTION || i.type === At.MANUAL_CORRECTION) ? this.getCurrentStepInfo(i.dataSourceStep, e) : i;\n    }\n  }, {\n    key: \"getMaxOrder\",\n    value: function getMaxOrder(t) {\n      var e = 0;\n      return t.forEach(function (i) {\n        i.order && i.order > e && (e = i.order);\n      }), e;\n    }\n  }, {\n    key: \"getAllToolsMaxOrder\",\n    value: function getAllToolsMaxOrder(t, e) {\n      var i = 0;\n      if (t) {\n        var _iterator15 = _createForOfIteratorHelper(t),\n          _step15;\n        try {\n          for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {\n            var r = _step15.value;\n            r.order > i && (i = r.order);\n          }\n        } catch (err) {\n          _iterator15.e(err);\n        } finally {\n          _iterator15.f();\n        }\n      }\n      if (e) {\n        var _iterator16 = _createForOfIteratorHelper(e),\n          _step16;\n        try {\n          for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {\n            var _r3 = _step16.value;\n            if (_r3.toolName && _r3.toolName !== \"tagTool\") {\n              var _iterator17 = _createForOfIteratorHelper(_r3.result),\n                _step17;\n              try {\n                for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {\n                  var n = _step17.value;\n                  n.order > i && (i = n.order);\n                }\n              } catch (err) {\n                _iterator17.e(err);\n              } finally {\n                _iterator17.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator16.e(err);\n        } finally {\n          _iterator16.f();\n        }\n      }\n      return i;\n    }\n  }, {\n    key: \"hotkeyFilter\",\n    value: function hotkeyFilter(t) {\n      var e = t.target || t.srcElement;\n      if (!e) return !0;\n      var i = e.tagName,\n        r = e.type;\n      if (!i || !r) return !0;\n      var n = !0;\n      return (e.isContentEditable || i === \"TEXTAREA\" || (i === \"INPUT\" && r !== \"radio\" || i === \"TEXTAREA\") && !e.readOnly) && (n = !1), n;\n    }\n  }, {\n    key: \"getCurrentOperation\",\n    value: function getCurrentOperation(t) {\n      switch (t) {\n        case P.Rect:\n        case P.RectTrack:\n          return me;\n        case P.Tag:\n          return bi;\n        case P.Polygon:\n          return pi;\n        case Et.Check:\n          return Or;\n        case P.Line:\n          return wi;\n        case P.Point:\n          return Di;\n        case P.Text:\n          return _i;\n        default:\n          throw new Error(\"not match tool\");\n      }\n    }\n  }, {\n    key: \"getNextSelectedRectID\",\n    value: function getNextSelectedRectID(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : G.ascend;\n      var i = arguments.length > 2 ? arguments[2] : undefined;\n      var r = 1;\n      e === G.descend && (r = -1);\n      var n = t.sort(function (l, h) {\n          return l.x - h.x == 0 ? l.y - h.y : r * (l.x - h.x);\n        }),\n        o = n.findIndex(function (l) {\n          return l.id === i;\n        }),\n        a = n.length;\n      return n[(o + 1) % a];\n    }\n  }, {\n    key: \"getNextSelectedRectIDByEvent\",\n    value: function getNextSelectedRectIDByEvent(t, e, i) {\n      var r = e.shiftKey ? G.descend : G.ascend;\n      return this.getNextSelectedRectID(t, r, i);\n    }\n  }, {\n    key: \"getRenderResultList\",\n    value: function getRenderResultList(t, e) {\n      var _this61 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n      var r = arguments.length > 3 ? arguments[3] : undefined;\n      var n;\n      return [t.filter(function (a) {\n        return r && r === (a == null ? void 0 : a.id) ? (n = a, !1) : !(i.length > 0 && !i.includes(a == null ? void 0 : a.attribute) || _this61.isDifferSourceID(a == null ? void 0 : a.sourceID, e));\n      }), n];\n    }\n  }, {\n    key: \"getSourceID\",\n    value: function getSourceID(t) {\n      var e;\n      var i = \"\";\n      return t && (e = t == null ? void 0 : t.id) != null ? e : i;\n    }\n  }, {\n    key: \"findAllLine\",\n    value: function findAllLine(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n      var i = [],\n        r = _toConsumableArray(t);\n      r.length >= 3 && e === !0 && r.push(Ti({}, r[0]));\n      for (var n = 0; n < r.length; n++) r[n + 1] && i.push({\n        point1: r[n],\n        point2: r[n + 1],\n        pointIndex: n\n      });\n      return i;\n    }\n  }, {\n    key: \"translateSourceID\",\n    value: function translateSourceID(t) {\n      return (t === void 0 || t === 0 || t === \"0\") && (t = \"\"), t;\n    }\n  }, {\n    key: \"isDifferSourceID\",\n    value: function isDifferSourceID(t, e) {\n      return t = this.translateSourceID(t), e = this.translateSourceID(e), \"\".concat(t) != \"\".concat(e);\n    }\n  }, {\n    key: \"isSameSourceID\",\n    value: function isSameSourceID(t, e) {\n      return t = this.translateSourceID(t), e = this.translateSourceID(e), \"\".concat(t) == \"\".concat(e);\n    }\n  }, {\n    key: \"getNextMarker\",\n    value: function getNextMarker(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var i = arguments.length > 2 ? arguments[2] : undefined;\n      if ((e == null ? void 0 : e.length) === 0) return;\n      var r = e.map(function (n, o) {\n        return en(Ti({}, n), {\n          index: o\n        });\n      });\n      if (typeof i == \"number\" && i > 0) {\n        var n = e[i];\n        if (n && t.every(function (o) {\n          return o.label !== n.value;\n        })) return {\n          label: n.value,\n          index: i\n        };\n        r = [].concat(_toConsumableArray(r.slice(i, e.length)), _toConsumableArray(r.slice(0, i)));\n      }\n      var _loop = function _loop(n) {\n        if (!t.some(function (o) {\n          return o.label === r[n].value;\n        })) return {\n          v: {\n            label: r[n].value,\n            index: r[n].index\n          }\n        };\n      };\n      for (var _n3 = 0; _n3 < r.length; _n3++) {\n        var _ret = _loop(_n3);\n        if (typeof _ret === \"object\") return _ret.v;\n      }\n    }\n  }, {\n    key: \"getCurrentMarkerIndex\",\n    value: function getCurrentMarkerIndex(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      return e.findIndex(function (i) {\n        return t === i.value;\n      });\n    }\n  }]);\n  return x;\n}();\nx.jsonParser = function (s) {\n  var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  try {\n    return typeof s == \"string\" ? JSON.parse(s) : ji(s) ? s : t;\n  } catch (e) {\n    return t;\n  }\n};\nvar sn = Object.defineProperty,\n  Si = Object.getOwnPropertySymbols,\n  rn = Object.prototype.hasOwnProperty,\n  nn = Object.prototype.propertyIsEnumerable,\n  ki = function ki(s, t, e) {\n    return t in s ? sn(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  be = function be(s, t) {\n    for (var e in t || (t = {})) rn.call(t, e) && ki(s, e, t[e]);\n    if (Si) {\n      var _iterator18 = _createForOfIteratorHelper(Si(t)),\n        _step18;\n      try {\n        for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {\n          var e = _step18.value;\n          nn.call(t, e) && ki(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator18.e(err);\n      } finally {\n        _iterator18.f();\n      }\n    }\n    return s;\n  };\nvar D = /*#__PURE__*/function () {\n  function D() {\n    _classCallCheck(this, D);\n  }\n  _createClass(D, null, [{\n    key: \"getHoverPolygonID\",\n    value: function getHoverPolygonID(t, e) {\n      var _this62 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : R.Line;\n      var n = \"\",\n        o = Infinity;\n      var a = w.axisArea(t, i);\n      return e.forEach(function (l) {\n        l.pointList && a.forEach(function (h) {\n          var c = _this62.calcPolygonSize(l.pointList);\n          _this62.isInPolygon(h, l.pointList, r) && c < o && (n = l.id, o = c);\n        });\n      }), n;\n    }\n  }, {\n    key: \"calcPolygonSize\",\n    value: function calcPolygonSize() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      if ((t == null ? void 0 : t.length) <= 2) return 0;\n      var e = t.length,\n        i = t.reduce(function (r, n, o, a) {\n          var l = a[(o + 1) % e];\n          return r + n.x * l.y - l.x * n.y;\n        }, 0);\n      return Math.abs(i) / 2;\n    }\n  }, {\n    key: \"isInPolygon\",\n    value: function isInPolygon(t, e) {\n      var _e7, _e8;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n      var r = 0,\n        n,\n        o,\n        a,\n        l;\n      e = _toConsumableArray(e), i === R.Curve && (e = this.createSmoothCurvePoints(e.reduce(function (c, g) {\n        return [].concat(_toConsumableArray(c), [g.x, g.y]);\n      }, []), .5, !0, 20)), (_e7 = e, _e8 = _slicedToArray(_e7, 1), a = _e8[0]);\n      var h = e.length;\n      for (n = 1; n <= h; n++) l = e[n % h], t.x > Math.min(a.x, l.x) && t.x <= Math.max(a.x, l.x) && t.y <= Math.max(a.y, l.y) && a.x !== l.x && (o = (t.x - a.x) * (l.y - a.y) / (l.x - a.x) + a.y, (a.y === l.y || t.y <= o) && r++), a = l;\n      return r % 2 != 0;\n    }\n  }, {\n    key: \"createSmoothCurvePointsFromPointList\",\n    value: function createSmoothCurvePointsFromPointList(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Y;\n      return this.createSmoothCurvePoints(t.reduce(function (r, n) {\n        return [].concat(_toConsumableArray(r), [n.x, n.y]);\n      }, []), .5, !1, e).map(function (r, n) {\n        var o;\n        var a = n / (Y + 1),\n          l = Math.floor(a),\n          h = (o = t[l]) != null ? o : {};\n        return be(l === a ? be({}, h) : {\n          specialEdge: h.specialEdge\n        }, r);\n      });\n    }\n  }, {\n    key: \"createSmoothCurvePoints\",\n    value: function createSmoothCurvePoints(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .5;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Y;\n      if (t.length < 4) return t;\n      var n = [],\n        o = t.slice(0);\n      var a, l, h, c, g, d, u, f, v, b, p, y, I;\n      for (i ? (o.unshift(t[t.length - 1]), o.unshift(t[t.length - 2]), o.unshift(t[t.length - 1]), o.unshift(t[t.length - 2]), o.push(t[0]), o.push(t[1])) : (o.unshift(t[1]), o.unshift(t[0]), o.push(t[t.length - 2]), o.push(t[t.length - 1])), I = 2; I < o.length - 4; I += 2) for (h = (o[I + 2] - o[I - 2]) * e, c = (o[I + 4] - o[I - 0]) * e, g = (o[I + 3] - o[I - 1]) * e, d = (o[I + 5] - o[I + 1]) * e, y = 0; y <= r; y++) p = y / r, u = 2 * Math.pow(p, 3) - 3 * Math.pow(p, 2) + 1, f = -(2 * Math.pow(p, 3)) + 3 * Math.pow(p, 2), v = Math.pow(p, 3) - 2 * Math.pow(p, 2) + p, b = Math.pow(p, 3) - Math.pow(p, 2), a = u * o[I] + f * o[I + 2] + v * h + b * c, l = u * o[I + 1] + f * o[I + 3] + v * g + b * d, n.push(a), n.push(l);\n      var _ = [];\n      for (var A = 0; A < n.length - 1; A += 2) _.push({\n        x: n[A],\n        y: n[A + 1]\n      });\n      if (i) for (var _A = 0; _A < r + 1; _A++) {\n        var E = _.shift();\n        _.push(E);\n      }\n      return _;\n    }\n  }, {\n    key: \"getPolygonByID\",\n    value: function getPolygonByID(t, e) {\n      return t.find(function (i) {\n        return i.id === e;\n      });\n    }\n  }, {\n    key: \"getHoverEdgeIndex\",\n    value: function getHoverEdgeIndex(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 3;\n      var n = _toConsumableArray(e);\n      i === R.Curve ? n = this.createSmoothCurvePoints(e.reduce(function (l, h) {\n        return [].concat(_toConsumableArray(l), [h.x, h.y]);\n      }, []), .5, !0, Y) : i === R.Line && n.push(n[0]);\n      var o = -1,\n        a = r;\n      for (var l = 0; l < n.length - 1; l++) {\n        var _L$getFootOfPerpendic4 = L.getFootOfPerpendicular(t, n[l], n[l + 1]),\n          h = _L$getFootOfPerpendic4.length;\n        h < a && (o = l, a = h);\n      }\n      return o === -1 ? -1 : i === R.Curve ? Math.floor(o / Y) : o;\n    }\n  }, {\n    key: \"getClosestPoint\",\n    value: function getClosestPoint(t, e) {\n      var _this63 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 3;\n      var n = arguments.length > 4 ? arguments[4] : undefined;\n      var o;\n      var a = !1;\n      var l = (o = n == null ? void 0 : n.isClose) != null ? o : !0;\n      var h = \"\",\n        c = -1,\n        g = Infinity,\n        d = t;\n      var u = 20;\n      var f = !1;\n      return e.forEach(function (v) {\n        if (!f && !!v.pointList) switch (i) {\n          case R.Line:\n            x.findAllLine(v.pointList, l).forEach(function (p, y) {\n              if (f) return;\n              var _L$getFootOfPerpendic5 = L.getFootOfPerpendicular(t, p.point1, p.point2),\n                I = _L$getFootOfPerpendic5.length,\n                _ = _L$getFootOfPerpendic5.footPoint;\n              var A = L.getLineLength(p.point1, t),\n                E = L.getLineLength(p.point2, t);\n              A < r * 2 && (_ = p.point1, I = A, f = !0), E < r * 2 && (_ = p.point2, I = E, f = !0), I < g && I < r && (h = v.id, c = y, g = I, d = _, a = !0);\n            });\n            break;\n          case R.Curve:\n            {\n              var b = _this63.createSmoothCurvePoints(v.pointList.reduce(function (p, y) {\n                return [].concat(_toConsumableArray(p), [y.x, y.y]);\n              }, []), .5, l, u);\n              for (var p = 0; p < b.length - 1; p++) {\n                var _L$getFootOfPerpendic6 = L.getFootOfPerpendicular(t, b[p], b[p + 1]),\n                  y = _L$getFootOfPerpendic6.length,\n                  I = _L$getFootOfPerpendic6.footPoint;\n                y < g && y < r && (h = v.id, c = Math.floor(p / (u + 1)), g = y, d = I, a = !0);\n              }\n            }\n            break;\n        }\n      }), {\n        dropFoot: d,\n        closestEdgeIndex: c,\n        closestPolygonID: h,\n        hasClosed: a\n      };\n    }\n  }, {\n    key: \"isPointListInPolygon\",\n    value: function isPointListInPolygon(t, e) {\n      var _this64 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n      return t.every(function (r) {\n        return _this64.isInPolygon(r, e, i);\n      });\n    }\n  }, {\n    key: \"isPointListOutSidePolygon\",\n    value: function isPointListOutSidePolygon(t, e) {\n      var _this65 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R.Line;\n      return t.some(function (r) {\n        return !_this65.isInPolygon(r, e, i);\n      });\n    }\n  }, {\n    key: \"getPolygonArea\",\n    value: function getPolygonArea(t) {\n      var e = 0;\n      for (var i = 0, r = t.length; i < r; i++) {\n        var n = t[i].x,\n          o = t[i === t.length - 1 ? 0 : i + 1].y,\n          a = t[i === t.length - 1 ? 0 : i + 1].x,\n          l = t[i].y;\n        e += n * o * .5, e -= a * l * .5;\n      }\n      return Math.abs(e);\n    }\n  }, {\n    key: \"updatePolygonByRotate\",\n    value: function updatePolygonByRotate(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var i = arguments.length > 2 ? arguments[2] : undefined;\n      var r = 1;\n      return t === Rt.Anticlockwise && (r = -1), r *= e, L.rotateRectPointList(r, i);\n    }\n  }, {\n    key: \"deletePolygonLastPoint\",\n    value: function deletePolygonLastPoint(t, e, i, r) {\n      return i === r.length - 1 ? t : [].concat(_toConsumableArray(t), [{\n        x: e[0],\n        y: e[1]\n      }]);\n    }\n  }, {\n    key: \"concatBeginAndEnd\",\n    value: function concatBeginAndEnd(t) {\n      return t.length < 1 ? t : [].concat(_toConsumableArray(t), [t[0]]);\n    }\n  }, {\n    key: \"segmentPolygonByPolygon\",\n    value: function segmentPolygonByPolygon(t, e) {\n      var i, r;\n      try {\n        var n = kt([_toConsumableArray(D.concatBeginAndEnd(t.map(function (a) {\n          return [a.x, a.y];\n        })))]);\n        return e.forEach(function (a) {\n          var l = kt([_toConsumableArray(D.concatBeginAndEnd(a.pointList.map(function (c) {\n              return [c.x, c.y];\n            })))]),\n            h = zi(n, l);\n          h && (n = h);\n        }), ((r = (i = n == null ? void 0 : n.geometry) == null ? void 0 : i.coordinates.map(function (a) {\n          var l;\n          return ((l = n == null ? void 0 : n.geometry) == null ? void 0 : l.type) === \"MultiPolygon\" ? a[0].reduce(D.deletePolygonLastPoint, []) : a.reduce(D.deletePolygonLastPoint, []);\n        })) != null ? r : []).reduce(function (a, l) {\n          var h = l.length,\n            c = l.filter(function (g, d) {\n              var u = (d + 1) % h;\n              return !w.getIsInScope(g, l[u], 1);\n            });\n          return c.length < 3 ? a : [].concat(_toConsumableArray(a), [c]);\n        }, []);\n      } catch (n) {\n        console.error(n);\n      }\n    }\n  }, {\n    key: \"getPolygonPointList\",\n    value: function getPolygonPointList(t, e) {\n      var i = e.find(function (r) {\n        return r.id === t;\n      });\n      return i && i.pointList && i.pointList.length > 0 ? i.pointList : [];\n    }\n  }, {\n    key: \"getWrapPolygonIndex\",\n    value: function getWrapPolygonIndex(t, e) {\n      return e.findIndex(function (i) {\n        return D.isPointListInPolygon(t, i.pointList);\n      });\n    }\n  }, {\n    key: \"clipPolygonFromWrapPolygon\",\n    value: function clipPolygonFromWrapPolygon(t, e) {\n      var i = D.isPolygonClosewise(e),\n        r = D.isPolygonClosewise(t),\n        n = D.getClosePointDistanceFromPolygon(t[0], e),\n        o = e[n];\n      var a = [].concat(_toConsumableArray(e.slice(0, n)), [o], _toConsumableArray(t), [t[0]], _toConsumableArray(e.slice(n, e.length)));\n      return i === r && (a = [].concat(_toConsumableArray(e.slice(0, n)), [o, t[0]], _toConsumableArray(t.reverse()), _toConsumableArray(e.slice(n, e.length)))), a;\n    }\n  }, {\n    key: \"isPolygonClosewise\",\n    value: function isPolygonClosewise(t) {\n      var e = t.length;\n      var i,\n        r,\n        n,\n        o = 0,\n        a;\n      if (e < 3) return 0;\n      for (i = 0; i < e; i++) r = (i + 1) % e, n = (i + 2) % e, a = (t[r].x - t[i].x) * (t[n].y - t[r].y), a -= (t[r].y - t[i].y) * (t[n].x - t[r].x), a < 0 ? o-- : a > 0 && o++;\n      return o > 0 ? 1 : o < 0 ? -1 : 0;\n    }\n  }, {\n    key: \"getClosePointDistanceFromPolygon\",\n    value: function getClosePointDistanceFromPolygon(t, e) {\n      var i = Number.MAX_SAFE_INTEGER,\n        r = -1;\n      return e.forEach(function (n, o) {\n        var a = M.calcDistance(t, n);\n        a < i && (i = a, r = o);\n      }), r;\n    }\n  }, {\n    key: \"combinePolygonWithPolygon\",\n    value: function combinePolygonWithPolygon(t, e) {\n      var i, r;\n      try {\n        var n = kt([_toConsumableArray(D.concatBeginAndEnd(t.pointList.map(function (c) {\n            return [c.x, c.y];\n          })))]),\n          o = kt([_toConsumableArray(D.concatBeginAndEnd(e.pointList.map(function (c) {\n            return [c.x, c.y];\n          })))]),\n          a = Vi(n, o),\n          l = [],\n          h = t;\n        if (((r = (i = a == null ? void 0 : a.geometry) == null ? void 0 : i.coordinates) == null ? void 0 : r.length) === 1) {\n          l.push(e.id);\n          var c = a == null ? void 0 : a.geometry.coordinates.map(function (g) {\n            var d;\n            return ((d = a == null ? void 0 : a.geometry) == null ? void 0 : d.type) === \"MultiPolygon\" ? g[0].reduce(D.deletePolygonLastPoint, []) : g.reduce(D.deletePolygonLastPoint, []);\n          })[0];\n          h.pointList = c;\n        }\n        return {\n          newPolygon: h,\n          unionList: l\n        };\n      } catch (n) {\n        console.error(n);\n      }\n    }\n  }]);\n  return D;\n}();\nvar on = Object.defineProperty,\n  an = Object.defineProperties,\n  ln = Object.getOwnPropertyDescriptors,\n  Oi = Object.getOwnPropertySymbols,\n  hn = Object.prototype.hasOwnProperty,\n  cn = Object.prototype.propertyIsEnumerable,\n  Mi = function Mi(s, t, e) {\n    return t in s ? on(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  ye = function ye(s, t) {\n    for (var e in t || (t = {})) hn.call(t, e) && Mi(s, e, t[e]);\n    if (Oi) {\n      var _iterator19 = _createForOfIteratorHelper(Oi(t)),\n        _step19;\n      try {\n        for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {\n          var e = _step19.value;\n          cn.call(t, e) && Mi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator19.e(err);\n      } finally {\n        _iterator19.f();\n      }\n    }\n    return s;\n  },\n  xe = function xe(s, t) {\n    return an(s, ln(t));\n  };\nvar w = /*#__PURE__*/function () {\n  function w() {\n    _classCallCheck(this, w);\n  }\n  _createClass(w, null, [{\n    key: \"getOffsetCoordinate\",\n    value: function getOffsetCoordinate(t, e, i) {\n      return {\n        x: t.x * i + e.x,\n        y: t.y * i + e.y\n      };\n    }\n  }, {\n    key: \"changeDrawOutsideTarget\",\n    value: function changeDrawOutsideTarget(t, e, i, r, n, o) {\n      return typeof r == \"boolean\" && !r && (n && o ? (t.x - e.x > (n.x + n.width) * o && (t.x = (n.x + n.width) * o + e.x), t.x - e.x < n.x * o && (t.x = n.x * o + e.x), t.y - e.y > (n.y + n.height) * o && (t.y = (n.y + n.height) * o + e.y), t.y - e.y < n.y * o && (t.y = n.y * o + e.y)) : (t.x - e.x > i.width && (t.x = i.width + e.x), t.x - e.x < 0 && (t.x = e.x), t.y - e.y > i.height && (t.y = i.height + e.y), t.y - e.y < 0 && (t.y = e.y))), t;\n    }\n  }, {\n    key: \"changeCoordinateByRotate\",\n    value: function changeCoordinateByRotate(t, e, i) {\n      var r = i.width,\n        n = i.height,\n        o = t.x,\n        a = t.y;\n      switch (e % 360) {\n        case 90:\n          return {\n            x: n - a,\n            y: o\n          };\n        case 180:\n          return {\n            x: r - o,\n            y: n - a\n          };\n        case 270:\n          return {\n            x: a,\n            y: r - o\n          };\n        default:\n          return t;\n      }\n    }\n  }, {\n    key: \"changeRectByZoom\",\n    value: function changeRectByZoom(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        x: 0,\n        y: 0\n      };\n      return xe(ye({}, t), {\n        x: t.x * e + i.x,\n        y: t.y * e + i.y,\n        width: t.width * e,\n        height: t.height * e\n      });\n    }\n  }, {\n    key: \"changePointByZoom\",\n    value: function changePointByZoom(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        x: 0,\n        y: 0\n      };\n      return xe(ye({}, t), {\n        x: t.x * e + i.x,\n        y: t.y * e + i.y\n      });\n    }\n  }, {\n    key: \"changePointListByZoom\",\n    value: function changePointListByZoom(t, e) {\n      var _this66 = this;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        x: 0,\n        y: 0\n      };\n      return t.map(function (r) {\n        return _this66.changePointByZoom(r, e, i);\n      });\n    }\n  }, {\n    key: \"axisArea\",\n    value: function axisArea(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 3;\n      var i = t.x,\n        r = t.y,\n        n = [];\n      for (var o = i - e; o < i + e; o += e / 3) for (var a = r - e; a < r + e; a += e / 3) n.push({\n        x: o,\n        y: a\n      });\n      return n;\n    }\n  }, {\n    key: \"getOriginCoordinateWithOffsetCoordinate\",\n    value: function getOriginCoordinateWithOffsetCoordinate(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        x: 0,\n        y: 0\n      };\n      return {\n        x: (t.x - i.x) / e,\n        y: (t.y - i.y) / e\n      };\n    }\n  }, {\n    key: \"returnClosePointIndex\",\n    value: function returnClosePointIndex(t, e) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n      var r = -1;\n      for (var n = 0; n < e.length; n++) {\n        var o = e[n];\n        this.getIsInScope(t, o, i) && (r = n);\n      }\n      return r;\n    }\n  }, {\n    key: \"getIsInScope\",\n    value: function getIsInScope(t, e, i) {\n      return Math.abs(t.x - e.x) < i && Math.abs(t.y - e.y) < i;\n    }\n  }]);\n  return w;\n}();\nvar dn = /*#__PURE__*/function () {\n  function dn(t) {\n    _classCallCheck(this, dn);\n    this.currentPos = t.currentPos, this.zoom = t.zoom, this.basicImgInfo = t.basicImgInfo, this.dependToolName = \"\";\n  }\n  _createClass(dn, [{\n    key: \"isDependPolygon\",\n    get: function get() {\n      return this.dependToolName === P.Polygon;\n    }\n  }, {\n    key: \"isDependRect\",\n    get: function get() {\n      return this.dependToolName === P.Rect;\n    }\n  }, {\n    key: \"isDependOriginalImage\",\n    get: function get() {\n      return this.dependToolName === \"\";\n    }\n  }, {\n    key: \"getAbsCoord\",\n    value: function getAbsCoord(t) {\n      return {\n        x: (t.x - this.currentPos.x) / this.zoom,\n        y: (t.y - this.currentPos.y) / this.zoom\n      };\n    }\n  }, {\n    key: \"getRenderCoord\",\n    value: function getRenderCoord(t) {\n      return {\n        x: t.x * this.zoom + this.currentPos.x,\n        y: t.y * this.zoom + this.currentPos.y\n      };\n    }\n  }, {\n    key: \"coordInsideRect\",\n    value: function coordInsideRect(t, e) {\n      var i = e.x,\n        r = e.y,\n        n = e.width,\n        o = e.height;\n      return {\n        x: L.withinRange(t.x, [i, i + n]),\n        y: L.withinRange(t.y, [r, r + o])\n      };\n    }\n  }, {\n    key: \"getPolygonPointList\",\n    value: function getPolygonPointList(t, e) {\n      return t === R.Curve ? D.createSmoothCurvePointsFromPointList(e) : e;\n    }\n  }, {\n    key: \"getIntersection\",\n    value: function getIntersection(t, e, i) {\n      var r = this.getRenderCoord(e),\n        n = this.getRenderCoord(t),\n        o = {\n          pointA: r,\n          pointB: n\n        };\n      return M.calcOptimalIntersection(i, o, r, xr, this.zoom);\n    }\n  }, {\n    key: \"coordInsidePolygon\",\n    value: function coordInsidePolygon(t, e, i, r) {\n      var _this67 = this;\n      var n = i.pointList,\n        o = r == null ? void 0 : r.lineType;\n      if (n.length === 0) return t;\n      var a = this.getPolygonPointList(o, n);\n      if (D.isInPolygon(t, a)) return t;\n      var h = a.concat(a[0]).map(function (g) {\n          return _this67.getRenderCoord(g);\n        }),\n        c = this.getIntersection(t, e, h);\n      return c ? this.getAbsCoord(c == null ? void 0 : c.point) : t;\n    }\n  }, {\n    key: \"coordInsideImage\",\n    value: function coordInsideImage(t) {\n      return this.coordInsideRect(t, xe(ye({}, this.basicImgInfo), {\n        x: 0,\n        y: 0\n      }));\n    }\n  }, {\n    key: \"getNextCoordByDependTool\",\n    value: function getNextCoordByDependTool(t, e) {\n      if (this.isDependRect) return this.coordInsideRect(t, this.basicResult);\n      if (this.isDependPolygon) return this.coordInsidePolygon(t, e, this.basicResult, this.dependToolConfig);\n      if (this.isDependOriginalImage) return this.coordInsideImage(t);\n    }\n  }, {\n    key: \"setDependInfo\",\n    value: function setDependInfo(t, e) {\n      this.dependToolName = t != null ? t : \"\", this.dependToolConfig = t ? e : void 0;\n    }\n  }, {\n    key: \"setBasicImgInfo\",\n    value: function setBasicImgInfo(t) {\n      this.basicImgInfo = t;\n    }\n  }, {\n    key: \"setBasicResult\",\n    value: function setBasicResult(t) {\n      this.basicResult = t;\n    }\n  }, {\n    key: \"setZoomAndCurrentPos\",\n    value: function setZoomAndCurrentPos(t, e) {\n      this.zoom = t, this.currentPos = e;\n    }\n  }, {\n    key: \"isCoordInsideTarget\",\n    value: function isCoordInsideTarget(t) {\n      if (this.isDependPolygon) return this.isInBasicPolygon(t);\n      if (this.isDependRect) {\n        var _this$basicResult3 = this.basicResult,\n          e = _this$basicResult3.x,\n          i = _this$basicResult3.y,\n          r = _this$basicResult3.width,\n          n = _this$basicResult3.height,\n          o = [e, e + r],\n          a = [i, i + n];\n        return L.isInRange(t.x, o) && L.isInRange(t.y, a);\n      }\n      return L.isInRange(t.x, [0, this.basicImgInfo.width]) && L.isInRange(t.y, [0, this.basicImgInfo.height]);\n    }\n  }, {\n    key: \"isInBasicPolygon\",\n    value: function isInBasicPolygon(t) {\n      var e, i;\n      return D.isInPolygon(t, ((e = this.basicResult) == null ? void 0 : e.pointList) || [], (i = this.dependToolConfig) == null ? void 0 : i.lineType);\n    }\n  }]);\n  return dn;\n}();\nvar un = Object.defineProperty,\n  gn = Object.defineProperties,\n  fn = Object.getOwnPropertyDescriptors,\n  Ei = Object.getOwnPropertySymbols,\n  vn = Object.prototype.hasOwnProperty,\n  pn = Object.prototype.propertyIsEnumerable,\n  Ni = function Ni(s, t, e) {\n    return t in s ? un(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  $ = function $(s, t) {\n    for (var e in t || (t = {})) vn.call(t, e) && Ni(s, e, t[e]);\n    if (Ei) {\n      var _iterator20 = _createForOfIteratorHelper(Ei(t)),\n        _step20;\n      try {\n        for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {\n          var e = _step20.value;\n          pn.call(t, e) && Ni(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator20.e(err);\n      } finally {\n        _iterator20.f();\n      }\n    }\n    return s;\n  },\n  X = function X(s, t) {\n    return gn(s, fn(t));\n  };\nvar Tt = 6;\nvar me = /*#__PURE__*/function (_st7) {\n  _inherits(me, _st7);\n  var _super8 = _createSuper(me);\n  function me(t) {\n    var _this68;\n    _classCallCheck(this, me);\n    _this68 = _super8.call(this, t);\n    _this68.setMarkerIndex = function (e) {\n      _this68.markerIndex = e;\n    }, _this68.setMarkerIndexAndSelect = function (e) {\n      if (!_this68.config.markerList) return;\n      _this68.markerIndex = e;\n      var i = _this68.config.markerList[e].value,\n        r = _this68.currentPageResult.find(function (n) {\n          return n.label === i;\n        });\n      r && (_this68.setSelectedID(r.id), _this68.config.attributeConfigurable === !0 && _this68.setDefaultAttribute(r.attribute)), _this68.emit(\"markIndexChange\");\n    }, _this68.getHoverRectID = function (e) {\n      var i = _this68.getCoordinateUnderZoom(e),\n        r = Tt,\n        _assertThisInitialize6 = _assertThisInitialized(_this68),\n        n = _assertThisInitialize6.currentShowList;\n      if (n.length > 0) {\n        if (_this68.selectedRectID) {\n          var _assertThisInitialize7 = _assertThisInitialized(_this68),\n            a = _assertThisInitialize7.selectedRect;\n          if (a && U.isInRect(i, a, r, _this68.zoom)) return a.id;\n        }\n        var o = n.filter(function (a) {\n          return U.isInRect(i, a, r, _this68.zoom);\n        });\n        if (o.length === 0) return \"\";\n        if (o.length === 1) return o[0].id;\n        if (o.length > 1) return o.map(function (l) {\n          return {\n            size: l.width * l.height,\n            id: l.id\n          };\n        }).sort(function (l, h) {\n          return l.size - h.size;\n        })[0].id;\n      }\n      return \"\";\n    }, _this68.textChange = function (e) {\n      _this68.config.textConfigurable !== !0 || !_this68.selectedRectID || (_this68.setRectList(T.textChange(e, _this68.selectedRectID, _this68.rectList), !0), _this68.emit(\"selectedChange\"), _this68.render());\n    }, _this68.drawOutSideTarget = t.drawOutSideTarget || !1, _this68.rectList = [], _this68.isFlow = !0, _this68.config = x.jsonParser(t.config), _this68.hoverRectEdgeIndex = -1, _this68.hoverRectPointIndex = -1, _this68.markerIndex = 0, _this68.setStyle(t.style), _this68.createNewDrawingRect = _this68.createNewDrawingRect.bind(_assertThisInitialized(_this68)), _this68.getDrawingRectWithRectList = _this68.getDrawingRectWithRectList.bind(_assertThisInitialized(_this68)), _this68.setSelectedIdAfterAddingDrawingRect = _this68.setSelectedIdAfterAddingDrawingRect.bind(_assertThisInitialized(_this68)), _this68.getCurrentSelectedData = _this68.getCurrentSelectedData.bind(_assertThisInitialized(_this68)), _this68.updateSelectedRectTextAttribute = _this68.updateSelectedRectTextAttribute.bind(_assertThisInitialized(_this68)), _this68.setSelectedID = _this68.setSelectedID.bind(_assertThisInitialized(_this68));\n    return _this68;\n  }\n  _createClass(me, [{\n    key: \"setResult\",\n    value: function setResult(t) {\n      if (this.clearActiveStatus(), this.setRectList(t), this.hasMarkerConfig) {\n        var e = x.getNextMarker(this.getCurrentPageResult(t), this.config.markerList);\n        e && this.setMarkerIndex(e.index);\n      }\n      this.render();\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _get(_getPrototypeOf(me.prototype), \"destroy\", this).call(this), this._textAttributInstance && this._textAttributInstance.clearTextAttribute();\n    }\n  }, {\n    key: \"setConfig\",\n    value: function setConfig(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      this.config = t, e === !0 && this.clearResult(!1);\n    }\n  }, {\n    key: \"setRectList\",\n    value: function setRectList(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = this.rectList.length;\n      this.rectList = t, i !== t.length && this.emit(\"updatePageNumber\"), e && this.emit(\"updateResult\");\n    }\n  }, {\n    key: \"selectedRect\",\n    get: function get() {\n      var _this69 = this;\n      return this.rectList.find(function (t) {\n        return t.id === _this69.selectedRectID;\n      });\n    }\n  }, {\n    key: \"selectedID\",\n    get: function get() {\n      return this.selectedRectID;\n    }\n  }, {\n    key: \"selectedText\",\n    get: function get() {\n      var t;\n      return (t = this.selectedRect) == null ? void 0 : t.textAttribute;\n    }\n  }, {\n    key: \"dataList\",\n    get: function get() {\n      return this.rectList;\n    }\n  }, {\n    key: \"currentShowList\",\n    get: function get() {\n      var t = [];\n      var _x$getRenderResultLis15 = x.getRenderResultList(this.rectList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedID),\n        _x$getRenderResultLis16 = _slicedToArray(_x$getRenderResultLis15, 2),\n        e = _x$getRenderResultLis16[0],\n        i = _x$getRenderResultLis16[1];\n      return t = e, this.isHidden && (t = []), i && t.push(i), t;\n    }\n  }, {\n    key: \"currentPageResult\",\n    get: function get() {\n      var _x$getRenderResultLis17 = x.getRenderResultList(this.rectList, x.getSourceID(this.basicResult), []),\n        _x$getRenderResultLis18 = _slicedToArray(_x$getRenderResultLis17, 1),\n        t = _x$getRenderResultLis18[0];\n      return t;\n    }\n  }, {\n    key: \"getCurrentPageResult\",\n    value: function getCurrentPageResult(t) {\n      var _x$getRenderResultLis19 = x.getRenderResultList(t, x.getSourceID(this.basicResult), []),\n        _x$getRenderResultLis20 = _slicedToArray(_x$getRenderResultLis19, 1),\n        e = _x$getRenderResultLis20[0];\n      return e;\n    }\n  }, {\n    key: \"setSelectedID\",\n    value: function setSelectedID(t) {\n      this.setSelectedRectID(t);\n    }\n  }, {\n    key: \"setSelectedRectID\",\n    value: function setSelectedRectID(t) {\n      var e, i;\n      var r = this.selectedRectID;\n      t !== r && r && ((e = this._textAttributInstance) == null || e.changeSelected()), t || (i = this._textAttributInstance) == null || i.clearTextAttribute(), this.selectedRectID = t, this.render(), this.emit(\"selectedChange\");\n    }\n  }, {\n    key: \"setStyle\",\n    value: function setStyle(t) {\n      var e;\n      _get(_getPrototypeOf(me.prototype), \"setStyle\", this).call(this, t), this._textAttributInstance && this.config.attributeConfigurable === !1 && ((e = this._textAttributInstance) == null || e.updateIcon(this.getTextIconSvg()));\n    }\n  }, {\n    key: \"updateSelectedRectTextAttribute\",\n    value: function updateSelectedRectTextAttribute(t) {\n      var _this70 = this;\n      if (this._textAttributInstance && t) {\n        var e = t;\n        T.textAttributeValidate(this.config.textCheckType, \"\", e) === !1 && (this.emit(\"messageError\", T.getErrorNotice(this.config.textCheckType, this.lang)), e = \"\"), this.setRectList(this.rectList.map(function (i) {\n          return i.id === _this70.selectedRectID ? X($({}, i), {\n            textAttribute: e\n          }) : i;\n        }), !0), this.emit(\"updateTextAttribute\"), this.render();\n      }\n    }\n  }, {\n    key: \"getHoverRectPointIndex\",\n    value: function getHoverRectPointIndex(t) {\n      return this.selectedRect ? w.returnClosePointIndex(this.getCoordinateUnderZoom(t), U.getRectPointList(this.selectedRect, this.zoom), Tt + 2) : -1;\n    }\n  }, {\n    key: \"getHoverRectEdgeIndex\",\n    value: function getHoverRectEdgeIndex(t) {\n      if (!this.selectedRect) return -1;\n      var e = -1;\n      var i = this.selectedRect,\n        r = U.getRectEdgeList(i, this.zoom),\n        n = this.getCoordinateUnderZoom(t);\n      for (var o = 0; o < r.length; o++) {\n        var a = r[o],\n          _L$getFootOfPerpendic7 = L.getFootOfPerpendicular(n, a.begin, a.end),\n          l = _L$getFootOfPerpendic7.length;\n        l < Tt + 10 && (e = o);\n      }\n      return e;\n    }\n  }, {\n    key: \"getTextIconSvg\",\n    value: function getTextIconSvg() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n      return T.getTextIconSvg(t, this.config.attributeList, this.config.attributeConfigurable, this.baseIcon);\n    }\n  }, {\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      var _this71 = this;\n      if (_get(_getPrototypeOf(me.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation || t.ctrlKey === !0) return;\n      var e = this.getCoordinateUnderZoom(t),\n        i = this.getHoverRectID(t),\n        r = this.currentShowList.find(function (n) {\n          return n.id === _this71.selectedRectID;\n        });\n      if (!(!r || t.button === 2 || t.button === 0 && this.isSpaceKey === !0)) {\n        if (this.selectedRectID) {\n          if (this.getHoverRectPointIndex(t) > -1) {\n            var n = W.Point;\n            this.dragInfo = {\n              dragStartCoord: e,\n              dragTarget: n,\n              startTime: +new Date(),\n              firstRect: r\n            }, this.dragStatus = O.Start;\n            return;\n          }\n          if (this.getHoverRectEdgeIndex(t) > -1) {\n            var _n4 = W.Line;\n            this.dragInfo = {\n              dragStartCoord: e,\n              dragTarget: _n4,\n              startTime: +new Date(),\n              firstRect: r\n            }, this.dragStatus = O.Start;\n            return;\n          }\n        }\n        if (i === this.selectedRectID && !this.drawingRect) {\n          var _n5 = W.Plane;\n          this.dragInfo = {\n            dragStartCoord: e,\n            dragTarget: _n5,\n            firstRect: r,\n            startTime: +new Date()\n          }, this.dragStatus = O.Start;\n        }\n      }\n    }\n  }, {\n    key: \"onDragMove\",\n    value: function onDragMove(t) {\n      var _this72 = this;\n      var e, i, r, n, o, a;\n      if (!this.dragInfo) return;\n      this.dragStatus = O.Move;\n      var l = U.getRectUnderZoom(this.dragInfo.firstRect, this.zoom),\n        h = l.x,\n        c = l.y,\n        g = l.width,\n        d = l.height,\n        u = {\n          x: t.x - this.dragInfo.dragStartCoord.x,\n          y: t.y - this.dragInfo.dragStartCoord.y\n        };\n      var f = this.rectList.filter(function (v) {\n        return v.id === _this72.selectedRectID;\n      })[0];\n      switch (this.dragInfo.dragTarget) {\n        case W.Plane:\n          f = X($({}, f), {\n            x: h + u.x,\n            y: c + u.y,\n            width: g,\n            height: d\n          });\n          break;\n        case W.Point:\n          {\n            var v = h,\n              b = c,\n              p = g,\n              y = d;\n            switch (this.hoverRectPointIndex) {\n              case 0:\n                {\n                  v = g - u.x < 0 ? h + g : h + u.x, b = d - u.y < 0 ? c + d : c + u.y, p = Math.abs(u.x - g), y = Math.abs(u.y - d);\n                  break;\n                }\n              case 1:\n                {\n                  v = g + u.x > 0 ? h : h + g + u.x, b = d - u.y < 0 ? c + d : c + u.y, p = Math.abs(g + u.x), y = Math.abs(d - u.y);\n                  break;\n                }\n              case 2:\n                {\n                  v = g + u.x > 0 ? h : h + g + u.x, b = d + u.y > 0 ? c : c + d + u.y, p = Math.abs(g + u.x), y = d + u.y > 0 ? d + u.y : Math.abs(d + u.y);\n                  break;\n                }\n              case 3:\n                {\n                  v = g - u.x < 0 ? h + g : h + u.x, b = d + u.y > 0 ? c : c + d + u.y, p = Math.abs(u.x - g), y = d + u.y > 0 ? d + u.y : Math.abs(d + u.y);\n                  break;\n                }\n              default:\n                return;\n            }\n            f = X($({}, f), {\n              x: v,\n              y: b,\n              width: p,\n              height: y\n            });\n          }\n          break;\n        case W.Line:\n          {\n            var _v2 = h,\n              _b = c,\n              _p = g,\n              _y = d;\n            switch (this.hoverRectEdgeIndex) {\n              case 0:\n                {\n                  _b = d - u.y < 0 ? c + d : c + u.y, _y = Math.abs(u.y - d);\n                  break;\n                }\n              case 1:\n                {\n                  _v2 = g + u.x > 0 ? h : h + g + u.x, _p = Math.abs(g + u.x);\n                  break;\n                }\n              case 2:\n                {\n                  _b = d + u.y > 0 ? c : c + d + u.y, _y = d + u.y > 0 ? d + u.y : Math.abs(d + u.y);\n                  break;\n                }\n              case 3:\n                {\n                  _v2 = g - u.x < 0 ? h + g : h + u.x, _p = Math.abs(u.x - g);\n                  break;\n                }\n              default:\n                return;\n            }\n            f = X($({}, f), {\n              x: _v2,\n              y: _b,\n              width: _p,\n              height: _y\n            });\n            break;\n          }\n        default:\n          return;\n      }\n      if (this.config.drawOutsideTarget === !1) {\n        if (this.basicResult) {\n          if (((i = (e = this.basicResult) == null ? void 0 : e.pointList) == null ? void 0 : i.length) > 0 && U.isRectNotInPolygon(f, Te(this.basicResult.pointList, this.zoom))) return;\n          var _v3 = this.basicResult.x * this.zoom,\n            _b2 = this.basicResult.y * this.zoom,\n            _p2 = this.basicResult.width * this.zoom,\n            _y2 = this.basicResult.height * this.zoom;\n          if (this.dragInfo.dragTarget !== W.Plane && (f.x < _v3 - .01 || f.y < _b2 - .01 || f.width > _v3 + _p2 - f.x + .01 || f.height > _b2 + _y2 - f.y + .01)) return;\n          if (f.x < _v3 && (f.x = _v3), f.y < _b2 && (f.y = _b2), f.width > _v3 + _p2 - f.x) switch (this.dragInfo.dragTarget) {\n            case W.Plane:\n              f.x = _v3 + _p2 - g;\n              break;\n            case W.Point:\n            case W.Line:\n              u.x > 0 && u.y > 0 && (f.width = _v3 + _p2 - f.x);\n              break;\n            default:\n              return;\n          }\n          if (f.height > _b2 + _y2 - f.y) switch (this.dragInfo.dragTarget) {\n            case W.Plane:\n              f.y = _b2 + _y2 - d;\n              break;\n          }\n        } else if (f.x < 0 && (f.x = 0), f.y < 0 && (f.y = 0), this.imgInfo) switch (this.dragInfo.dragTarget) {\n          case W.Plane:\n            f.x + f.width > ((r = this.imgInfo) == null ? void 0 : r.width) && (f.x = this.imgInfo.width - g), f.y + f.height > ((n = this.imgInfo) == null ? void 0 : n.height) && (f.y = this.imgInfo.height - d);\n            break;\n          default:\n            if (f.x + f.width > ((o = this.imgInfo) == null ? void 0 : o.width) + .01 || f.y + f.height > ((a = this.imgInfo) == null ? void 0 : a.height) + .01) return;\n        }\n      }\n      this.setRectList(this.rectList.map(function (v) {\n        return v.id === f.id ? U.getRectUnderZoom(f, 1 / _this72.zoom) : v;\n      })), this.render();\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      var e, i;\n      if (_get(_getPrototypeOf(me.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      var r = this.getCoordinateUnderZoom(t),\n        n = w.changeDrawOutsideTarget(r, {\n          x: 0,\n          y: 0\n        }, this.imgInfo, this.config.drawOutsideTarget, this.basicResult, this.zoom);\n      if (this.selectedRectID && this.dragInfo) {\n        this.onDragMove(n);\n        return;\n      }\n      if (this.selectedRectID) {\n        var l = this.getHoverRectPointIndex(t);\n        if (l !== this.hoverRectPointIndex) {\n          this.hoverRectPointIndex = l, this.hoverRectEdgeIndex = -1, this.render();\n          return;\n        }\n        if (this.hoverRectPointIndex === -1) {\n          var h = this.getHoverRectEdgeIndex(t);\n          if (h !== this.hoverRectEdgeIndex) {\n            this.hoverRectEdgeIndex = h, this.render();\n            return;\n          }\n        }\n      }\n      var o = this.getHoverRectID(t),\n        a = this.hoverRectID;\n      if (this.hoverRectID = o, o !== a && this.render(), this.drawingRect && this.firstClickCoord) {\n        var _this$firstClickCoord = this.firstClickCoord,\n          _l2 = _this$firstClickCoord.x,\n          _h = _this$firstClickCoord.y,\n          _this$drawingRect = this.drawingRect,\n          c = _this$drawingRect.width,\n          g = _this$drawingRect.height;\n        if (c = Math.abs(_l2 - n.x), g = Math.abs(_h - n.y), n.x < _l2 && (_l2 = n.x), n.y < _h && (_h = n.y), this.config.drawOutsideTarget === !1) {\n          if (((i = (e = this.basicResult) == null ? void 0 : e.pointList) == null ? void 0 : i.length) > 0 && U.isRectNotInPolygon(X($({}, this.drawingRect), {\n            x: _l2,\n            y: _h,\n            width: c,\n            height: g\n          }), Te(this.basicResult.pointList, this.zoom))) return;\n          n.x < 0 && (c = Math.abs(this.firstClickCoord.x), _l2 = 0), n.y < 0 && (g = Math.abs(this.firstClickCoord.y), _h = 0), this.imgInfo && (_l2 + c > this.imgInfo.width && (c = Math.abs(this.imgInfo.width - _l2)), _h + g > this.imgInfo.height && (g = Math.abs(this.imgInfo.height - _h)));\n        }\n        this.drawingRect = X($({}, this.drawingRect), {\n          x: _l2,\n          y: _h,\n          width: c,\n          height: g\n        }), this.render();\n      }\n    }\n  }, {\n    key: \"setAttributeLockList\",\n    value: function setAttributeLockList(t) {\n      this.setSelectedRectID(void 0), _get(_getPrototypeOf(me.prototype), \"setAttributeLockList\", this).call(this, t);\n    }\n  }, {\n    key: \"setBasicResult\",\n    value: function setBasicResult(t) {\n      _get(_getPrototypeOf(me.prototype), \"setBasicResult\", this).call(this, t), this.clearActiveStatus();\n    }\n  }, {\n    key: \"setRectValidAndRender\",\n    value: function setRectValidAndRender(t) {\n      !t || (this.setRectList(this.rectList.map(function (e) {\n        return e.id === t ? X($({}, e), {\n          valid: !e.valid\n        }) : e;\n      }), !0), this.render(), this.emit(\"updateResult\"));\n    }\n  }, {\n    key: \"createNewDrawingRect\",\n    value: function createNewDrawingRect(t, e) {\n      if (!this.imgInfo) return;\n      var i = this.getCoordinateUnderZoom(t),\n        r = w.changeDrawOutsideTarget(i, {\n          x: 0,\n          y: 0\n        }, this.imgInfo, this.config.drawOutsideTarget, this.basicResult, this.zoom);\n      if (this.setSelectedRectID(\"\"), this.hoverRectID = \"\", this.drawOutSideTarget && (r.x < 0 && (r.x = 0), r.y < 0 && (r.y = 0)), this.drawingRect = X($({}, r), {\n        width: 0,\n        height: 0,\n        attribute: this.defaultAttribute,\n        valid: !t.ctrlKey,\n        isVisible: !0,\n        id: J(8, 62),\n        sourceID: e,\n        textAttribute: \"\"\n      }), this.hasMarkerConfig) {\n        var n = x.getNextMarker(this.currentPageResult, this.config.markerList, this.markerIndex);\n        if (n) this.drawingRect && (this.drawingRect = X($({}, this.drawingRect), {\n          label: n.label\n        })), this.markerIndex = n.index, this.emit(\"markIndexChange\");else {\n          this.emit(\"messageInfo\", H.getMessagesByLocale(C.MarkerFinish, this.lang)), this.drawingRect = void 0;\n          return;\n        }\n      }\n      if (this.config.textConfigurable) {\n        var _n6 = \"\";\n        _n6 = T.getTextAttribute(this.rectList.filter(function (o) {\n          return x.isSameSourceID(o.sourceID, e);\n        }), this.config.textCheckType), this.drawingRect && (this.drawingRect = X($({}, this.drawingRect), {\n          textAttribute: _n6\n        }));\n      }\n      if (Object.assign(this.drawingRect, {\n        order: x.getAllToolsMaxOrder(this.rectList, this.prevResultList) + 1\n      }), this.firstClickCoord = $({}, r), this.firstCurrentPos = $({}, this.currentPos), this.dataInjectionAtCreation) {\n        var _n7 = this.dataInjectionAtCreation(this.drawingRect);\n        _n7 && Object.assign(this.drawingRect, _n7);\n      }\n    }\n  }, {\n    key: \"addDrawingRectToRectList\",\n    value: function addDrawingRectToRectList() {\n      if (!this.drawingRect) return;\n      var _this$drawingRect2 = this.drawingRect,\n        t = _this$drawingRect2.width,\n        e = _this$drawingRect2.height;\n      if (t /= this.zoom, e /= this.zoom, Math.round(t) < this.config.minWidth || Math.round(e) < this.config.minHeight) {\n        this.emit(\"messageInfo\", H.getMessagesByLocale(C.RectErrorSizeNotice, this.lang)), this.drawingRect = void 0, this.firstClickCoord = void 0, this.dragInfo = void 0, this.dragStatus = O.Wait, this.render();\n        return;\n      }\n      var i = this.getDrawingRectWithRectList();\n      this.setRectList(i, !0), this.history.pushHistory(this.rectList), this.setSelectedIdAfterAddingDrawingRect(), this.firstClickCoord = void 0, this.drawingRect = void 0, this.dragInfo = void 0, this.dragStatus = O.Wait;\n    }\n  }, {\n    key: \"setSelectedIdAfterAddingDrawingRect\",\n    value: function setSelectedIdAfterAddingDrawingRect() {\n      !this.drawingRect || (this.config.textConfigurable ? this.setSelectedRectID(this.drawingRect.id) : this.setSelectedRectID());\n    }\n  }, {\n    key: \"getDrawingRectWithRectList\",\n    value: function getDrawingRectWithRectList() {\n      if (!this.drawingRect) return this.rectList;\n      var _this$drawingRect3 = this.drawingRect,\n        t = _this$drawingRect3.x,\n        e = _this$drawingRect3.y,\n        i = _this$drawingRect3.width,\n        r = _this$drawingRect3.height;\n      return t /= this.zoom, e /= this.zoom, i /= this.zoom, r /= this.zoom, [].concat(_toConsumableArray(this.rectList), [X($({}, this.drawingRect), {\n        x: t,\n        y: e,\n        width: i,\n        height: r\n      })]);\n    }\n  }, {\n    key: \"rightMouseUp\",\n    value: function rightMouseUp(t) {\n      var e = this.getHoverRectID(t),\n        i = this.rectList.find(function (n) {\n          return n.id === e;\n        }),\n        r = this.selectedRectID;\n      if (this.setSelectedRectID(void 0), i && this.setDefaultAttribute(i.attribute), this.drawingRect) this.drawingRect = void 0, this.firstClickCoord = void 0;else if (r !== e && this.dblClickListener.clearRightDblClick(), this.setSelectedRectID(e), this.hoverRectID = \"\", (i == null ? void 0 : i.label) && this.hasMarkerConfig) {\n        var n = x.getCurrentMarkerIndex(i.label, this.config.markerList);\n        n >= 0 && (this.setMarkerIndex(n), this.emit(\"markIndexChange\"));\n      }\n      this.render();\n    }\n  }, {\n    key: \"shiftRightMouseUp\",\n    value: function shiftRightMouseUp(t) {\n      var e = this.getHoverRectID(t);\n      this.emit(\"shiftRightMouseUp\", e);\n    }\n  }, {\n    key: \"onMouseUp\",\n    value: function onMouseUp(t) {\n      if (_get(_getPrototypeOf(me.prototype), \"onMouseUp\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return !0;\n      if (this.dragInfo && this.dragStatus === O.Move) {\n        this.dragInfo = void 0, this.dragStatus = O.Wait, this.history.pushHistory(this.rectList), this.emit(\"updateResult\");\n        return;\n      }\n      if (t.button === 2 && t.shiftKey === !0) {\n        this.shiftRightMouseUp(t);\n        return;\n      }\n      if (t.button === 2) {\n        this.rightMouseUp(t);\n        return;\n      }\n      var e = x.getSourceID(this.basicResult);\n      if (this.drawingRect) {\n        this.addDrawingRectToRectList();\n        return;\n      }\n      if (t.ctrlKey === !0 && t.button === 0 && this.hoverRectID) {\n        this.setRectValidAndRender(this.hoverRectID);\n        return;\n      }\n      this.createNewDrawingRect(t, e), this.render();\n    }\n  }, {\n    key: \"onRightDblClick\",\n    value: function onRightDblClick(t) {\n      _get(_getPrototypeOf(me.prototype), \"onRightDblClick\", this).call(this, t);\n      var e = this.getHoverRectID(t);\n      this.selectedRectID && this.selectedRectID === e && this.deleteRect(e);\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(t) {\n      if (!x.hotkeyFilter(t) || _get(_getPrototypeOf(me.prototype), \"onKeyDown\", this).call(this, t) === !1) return;\n      var e = t.keyCode;\n      switch (e) {\n        case S.Ctrl:\n          this.drawingRect && (this.drawingRect = X($({}, this.drawingRect), {\n            valid: !t.ctrlKey\n          }), this.render());\n          break;\n        case S.F:\n          this.selectedRectID && this.setRectValidAndRender(this.selectedRectID);\n          break;\n        case S.Delete:\n          this.deleteRect(this.selectedRectID);\n          break;\n        case S.Tab:\n          {\n            if (t.preventDefault(), this.drawingRect) return;\n            var i = G.ascend;\n            t.shiftKey && (i = G.descend);\n            var _x$getRenderResultLis21 = x.getRenderResultList(this.rectList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedRectID),\n              _x$getRenderResultLis22 = _slicedToArray(_x$getRenderResultLis21, 2),\n              r = _x$getRenderResultLis22[0],\n              n = _x$getRenderResultLis22[1];\n            var o = _toConsumableArray(r);\n            n && (o = [].concat(_toConsumableArray(o), [n]));\n            var a = at.getViewPort(this.canvas, this.currentPos, this.zoom);\n            o = o.filter(function (h) {\n              return at.inViewPort({\n                x: h.x,\n                y: h.y\n              }, a);\n            });\n            var l = x.getNextSelectedRectID(o, i, this.selectedRectID);\n            l && (this.setSelectedRectID(l.id), this.config.attributeConfigurable === !0 && this.setDefaultAttribute(l.attribute));\n            break;\n          }\n        default:\n          {\n            if (this.config.attributeConfigurable) {\n              var _i7 = T.getAttributeByKeycode(e, this.config.attributeList);\n              _i7 !== void 0 && this.setDefaultAttribute(_i7);\n            }\n            break;\n          }\n      }\n      return !0;\n    }\n  }, {\n    key: \"onKeyUp\",\n    value: function onKeyUp(t) {\n      switch (_get(_getPrototypeOf(me.prototype), \"onKeyUp\", this).call(this, t), t.keyCode) {\n        case S.Ctrl:\n          this.drawingRect && (this.drawingRect = X($({}, this.drawingRect), {\n            valid: !0\n          }), this.render());\n          break;\n      }\n    }\n  }, {\n    key: \"onWheel\",\n    value: function onWheel(t) {\n      var e = this.zoom;\n      var i, r;\n      this.drawingRect && this.firstClickCoord && (i = U.getRectUnderZoom(this.drawingRect, 1 / e), r = w.changePointByZoom(this.firstClickCoord, 1 / e)), _get(_getPrototypeOf(me.prototype), \"onWheel\", this).call(this, t, !1), i && r && (this.drawingRect = U.getRectUnderZoom(i, this.zoom), this.firstClickCoord = w.changePointByZoom(r, this.zoom)), this.render();\n    }\n  }, {\n    key: \"getCurrentSelectedData\",\n    value: function getCurrentSelectedData() {\n      var t = this.selectedRect;\n      if (!t) return;\n      var e = this.getColor(t.attribute),\n        i = t.valid ? e == null ? void 0 : e.valid.stroke : e == null ? void 0 : e.invalid.stroke;\n      return {\n        width: t.width * this.zoom * .6,\n        textAttribute: t.textAttribute,\n        color: i\n      };\n    }\n  }, {\n    key: \"getRenderStyle\",\n    value: function getRenderStyle(t) {\n      var e = this.getColor(t.attribute);\n      var i, r;\n      return t.valid === !1 ? (i = e == null ? void 0 : e.invalid.stroke, r = e == null ? void 0 : e.invalid.fill) : (i = e == null ? void 0 : e.valid.stroke, r = e == null ? void 0 : e.valid.fill), {\n        strokeColor: i,\n        fillColor: r,\n        textColor: i,\n        toolColor: e\n      };\n    }\n  }, {\n    key: \"renderTextAttribute\",\n    value: function renderTextAttribute() {\n      var t;\n      var e = this.selectedRect;\n      if (!this.ctx || this.config.textConfigurable !== !0 || !e) return;\n      var i = e.x,\n        r = e.y,\n        n = e.width,\n        o = e.height,\n        a = e.attribute,\n        l = e.valid,\n        h = n * this.zoom * .6,\n        c = w.getOffsetCoordinate({\n          x: i,\n          y: r + o\n        }, this.currentPos, this.zoom),\n        g = this.getColor(a),\n        d = l ? g == null ? void 0 : g.valid.stroke : g == null ? void 0 : g.invalid.stroke,\n        u = 4;\n      this._textAttributInstance || (this._textAttributInstance = new Vt({\n        width: h,\n        container: this.container,\n        icon: this.getTextIconSvg(a),\n        color: d,\n        getCurrentSelectedData: this.getCurrentSelectedData,\n        updateSelectedTextAttribute: this.updateSelectedRectTextAttribute\n      })), this._textAttributInstance && !((t = this._textAttributInstance) == null ? void 0 : t.isExit) && this._textAttributInstance.appendToContainer(), this._textAttributInstance.update(\"\".concat(e.textAttribute), {\n        left: c.x,\n        top: c.y + u,\n        color: d,\n        width: h\n      });\n    }\n  }, {\n    key: \"renderSelectedRect\",\n    value: function renderSelectedRect(t) {\n      var _this73 = this;\n      var e = this.selectedRect;\n      if (!this.ctx || !t || !e) return;\n      var i = this.ctx;\n      var r = 10;\n      var n = U.getRectPointList(e),\n        o = n.length,\n        a = this.getColor(t.attribute);\n      n.forEach(function (l, h) {\n        var c, g;\n        if (i.save(), i.moveTo(l.x, l.y), i.beginPath(), _this73.hoverRectPointIndex === h ? r = Tt + 6 : r = Tt, t.valid === !1 ? (i.strokeStyle = a == null ? void 0 : a.invalid.stroke, i.fillStyle = a == null ? void 0 : a.invalid.stroke) : (i.strokeStyle = a == null ? void 0 : a.valid.stroke, i.fillStyle = a == null ? void 0 : a.valid.stroke), i.arc(l.x * _this73.zoom + _this73.currentPos.x, l.y * _this73.zoom + _this73.currentPos.y, r, 0, 2 * Math.PI), i.fill(), _this73.hoverRectEdgeIndex === h) {\n          i.beginPath(), i.lineWidth = 10;\n          var d = _this73.getColor(t.attribute),\n            u = t.valid === !1 ? (c = d == null ? void 0 : d.invalid) == null ? void 0 : c.stroke : (g = d == null ? void 0 : d.valid) == null ? void 0 : g.stroke;\n          i.strokeStyle = u, i.moveTo(n[h].x * _this73.zoom + _this73.currentPos.x, n[h].y * _this73.zoom + _this73.currentPos.y), i.lineTo(n[(h + 1) % o].x * _this73.zoom + _this73.currentPos.x, n[(h + 1) % o].y * _this73.zoom + _this73.currentPos.y), i.stroke();\n        }\n        i.restore();\n      });\n    }\n  }, {\n    key: \"renderDrawingRect\",\n    value: function renderDrawingRect(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.zoom;\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      var r, n, o;\n      if (this.ctx && t) {\n        var a = this.ctx,\n          l = this.style,\n          _l$hiddenText = l.hiddenText,\n          h = _l$hiddenText === void 0 ? !1 : _l$hiddenText;\n        a.save();\n        var _this$getRenderStyle = this.getRenderStyle(t),\n          c = _this$getRenderStyle.strokeColor,\n          g = _this$getRenderStyle.fillColor,\n          d = _this$getRenderStyle.textColor;\n        a.font = \"lighter 14px Arial\";\n        var u = \"\";\n        this.isShowOrder && t.order && (t == null ? void 0 : t.order) > 0 && (u = \"\".concat(t.order)), t.label && this.hasMarkerConfig && (u = \"\".concat(x.getAllToolsMaxOrder(this.rectList, this.prevResultList), \"_\").concat(ve.getMarkerShowText(t.label, this.config.markerList))), t.attribute && (u = \"\".concat(u, \"  \").concat(T.getAttributeShowText(t.attribute, (r = this.config) == null ? void 0 : r.attributeList)));\n        var f = w.changeRectByZoom(t, i ? e : this.zoom, this.currentPos);\n        h || m.drawText(this.canvas, {\n          x: f.x,\n          y: f.y - 5\n        }, u, {\n          color: c,\n          textMaxWidth: 300\n        });\n        var v = (o = (n = this.style) == null ? void 0 : n.width) != null ? o : 2;\n        (t.id === this.hoverRectID || t.id === this.selectedRectID) && m.drawRectWithFill(this.canvas, f, {\n          color: g\n        }), m.drawRect(this.canvas, f, {\n          color: c,\n          thickness: v,\n          hiddenText: !0\n        }), a.restore();\n        var b = \"\".concat(Math.round(t.width), \" * \").concat(Math.round(t.height));\n        i === !0 && (b = \"\".concat(Math.round(t.width / this.zoom), \" * \").concat(Math.round(f.height / this.zoom)));\n        var p = b.length * 7;\n        if (!h && t.textAttribute && t.id !== this.selectedRectID && this.isShowAttributeText) {\n          var y = 0,\n            I = Math.max(20, f.width - p);\n          m.drawText(this.canvas, {\n            x: f.x,\n            y: f.y + f.height + 20 + y\n          }, t.textAttribute, {\n            color: d,\n            textMaxWidth: I\n          });\n        }\n      }\n    }\n  }, {\n    key: \"renderStaticRect\",\n    value: function renderStaticRect() {\n      var _this74 = this;\n      var t;\n      if (!(((t = this.rectList) == null ? void 0 : t.length) > 0 && JSON.stringify(this.rectList))) return;\n      var _this$renderEnhance = this.renderEnhance,\n        e = _this$renderEnhance === void 0 ? {} : _this$renderEnhance,\n        _x$getRenderResultLis23 = x.getRenderResultList(this.rectList, x.getSourceID(this.basicResult), this.attributeLockList, this.selectedRectID),\n        _x$getRenderResultLis24 = _slicedToArray(_x$getRenderResultLis23, 2),\n        i = _x$getRenderResultLis24[0],\n        r = _x$getRenderResultLis24[1];\n      this.isHidden || i == null || i.forEach(function (n) {\n        n.isVisible && (_this74.renderDrawingRect(n), e.staticRender && e.staticRender(_this74.canvas, w.changeRectByZoom(n, _this74.zoom, _this74.currentPos), _this74.getRenderStyle(n)));\n      }), r && (this.renderDrawingRect(r), this.renderSelectedRect(r), e.selectedRender && e.selectedRender(this.canvas, w.changeRectByZoom(r, this.zoom, this.currentPos), this.getRenderStyle(r)));\n    }\n  }, {\n    key: \"renderCreatingRect\",\n    value: function renderCreatingRect() {\n      if (!this.drawingRect) return;\n      var _this$renderEnhance2 = this.renderEnhance,\n        t = _this$renderEnhance2 === void 0 ? {} : _this$renderEnhance2;\n      this.renderDrawingRect(this.drawingRect, 1, !0), t.creatingRender && t.creatingRender(this.canvas, w.changeRectByZoom(this.drawingRect, 1, this.currentPos), this.getRenderStyle(this.drawingRect));\n    }\n  }, {\n    key: \"renderRect\",\n    value: function renderRect() {\n      this.container.dispatchEvent(this.saveDataEvent), this.renderStaticRect(), this.renderCreatingRect();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      !this.ctx || !this.renderReady || (_get(_getPrototypeOf(me.prototype), \"render\", this).call(this), this.renderRect(), this.renderCursorLine(this.getLineColor(this.defaultAttribute)));\n    }\n  }, {\n    key: \"setDefaultAttribute\",\n    value: function setDefaultAttribute(t) {\n      var _this75 = this;\n      var e = this.defaultAttribute;\n      if (this.defaultAttribute = t != null ? t : \"\", e !== t) {\n        this.changeStyle(t), this.emit(\"changeAttributeSidebar\");\n        var i = this.selectedRect;\n        if (i && (this.setRectList(this.rectList.map(function (r) {\n          return r.id === _this75.selectedID ? X($({}, r), {\n            attribute: _this75.defaultAttribute\n          }) : r;\n        }), !0), this.history.pushHistory(this.rectList), this.render()), this.drawingRect && (this.drawingRect = X($({}, this.drawingRect), {\n          attribute: this.defaultAttribute\n        }), this.render()), this._textAttributInstance) {\n          if (this.attributeLockList.length > 0 && !this.attributeLockList.includes(this.defaultAttribute)) {\n            this._textAttributInstance.clearTextAttribute();\n            return;\n          }\n          this._textAttributInstance.updateIcon(this.getTextIconSvg(t));\n        }\n      }\n    }\n  }, {\n    key: \"setValid\",\n    value: function setValid(t) {\n      _get(_getPrototypeOf(me.prototype), \"setValid\", this).call(this, t), this.emit(\"updateResult\");\n    }\n  }, {\n    key: \"clearActiveStatus\",\n    value: function clearActiveStatus() {\n      this.drawingRect = void 0, this.firstClickCoord = void 0, this.dragInfo = void 0, this.dragStatus = O.Wait, this.setSelectedRectID(void 0);\n    }\n  }, {\n    key: \"clearResult\",\n    value: function clearResult() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n      var e = this.rectList.filter(function (i) {\n        return i.disableDelete === !0;\n      });\n      e.length > 0 && t && this.emit(\"messageInfo\", H.getMessagesByLocale(C.ClearPartialData, this.lang)), this.setRectList(e, !0), this.setSelectedRectID(void 0);\n    }\n  }, {\n    key: \"deleteRect\",\n    value: function deleteRect(t) {\n      var e;\n      if (!t) return;\n      var i = this.rectList.find(function (r) {\n        return r.id === t;\n      });\n      if ((i == null ? void 0 : i.disableDelete) === !0) {\n        this.emit(\"messageInfo\", H.getMessagesByLocale(C.DisableDelete, this.lang));\n        return;\n      }\n      this.setRectList(this.rectList.filter(function (r) {\n        return r.id !== t;\n      }), !0), this.history.pushHistory(this.rectList), this.setSelectedRectID(void 0), (e = this._textAttributInstance) == null || e.clearTextAttribute(), this.render();\n    }\n  }, {\n    key: \"exportData\",\n    value: function exportData() {\n      var t = this.rectList;\n      return [t, this.basicImgInfo];\n    }\n  }, {\n    key: \"undo\",\n    value: function undo() {\n      var t = this.history.undo();\n      t && (t.length !== this.rectList.length && this.setSelectedRectID(\"\"), this.setRectList(t, !0), this.render());\n    }\n  }, {\n    key: \"redo\",\n    value: function redo() {\n      var t = this.history.redo();\n      t && (t.length !== this.rectList.length && this.setSelectedRectID(\"\"), this.setRectList(t, !0), this.render());\n    }\n  }]);\n  return me;\n}(st);\nvar bn = Object.defineProperty,\n  yn = Object.defineProperties,\n  xn = Object.getOwnPropertyDescriptors,\n  Hi = Object.getOwnPropertySymbols,\n  mn = Object.prototype.hasOwnProperty,\n  wn = Object.prototype.propertyIsEnumerable,\n  Bi = function Bi(s, t, e) {\n    return t in s ? bn(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  In = function In(s, t) {\n    for (var e in t || (t = {})) mn.call(t, e) && Bi(s, e, t[e]);\n    if (Hi) {\n      var _iterator21 = _createForOfIteratorHelper(Hi(t)),\n        _step21;\n      try {\n        for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {\n          var e = _step21.value;\n          wn.call(t, e) && Bi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator21.e(err);\n      } finally {\n        _iterator21.f();\n      }\n    }\n    return s;\n  },\n  Ln = function Ln(s, t) {\n    return yn(s, xn(t));\n  };\nvar Pn = {\n  textConfigurable: !1,\n  attributeConfigurable: !0,\n  attributeList: []\n};\nvar Cn = /*#__PURE__*/function (_me) {\n  _inherits(Cn, _me);\n  var _super9 = _createSuper(Cn);\n  function Cn(t) {\n    _classCallCheck(this, Cn);\n    return _super9.call(this, Ln(In({}, t), {\n      config: Pn\n    }));\n  }\n  _createClass(Cn, [{\n    key: \"setSelectedIdAfterAddingDrawingRect\",\n    value: function setSelectedIdAfterAddingDrawingRect() {\n      !this.drawingRect || this.setSelectedRectID(this.drawingRect.id);\n    }\n  }]);\n  return Cn;\n}(me);\nvar Dn = /*#__PURE__*/function () {\n  function Dn(t) {\n    _classCallCheck(this, Dn);\n    this._domMap = new Map(), this._container = t.container, this._height = t.height;\n  }\n  _createClass(Dn, [{\n    key: \"wheelChange\",\n    value: function wheelChange(t) {\n      t.stopPropagation();\n    }\n  }, {\n    key: \"clearTag\",\n    value: function clearTag(t) {\n      var e;\n      var i = this._container;\n      typeof window != \"undefined\" && (e = window.self.document.getElementById(t)), e && i && i.contains(e) && (e.removeEventListener(\"wheel\", this.wheelChange), i == null || i.removeChild(e));\n    }\n  }, {\n    key: \"render\",\n    value: function render(t) {\n      var _this76 = this;\n      var e = Array.from(this._domMap.keys()),\n        i = t.map(function (r) {\n          return r.id;\n        });\n      t.forEach(function (r) {\n        var n = r.text,\n          o = r.textMaxWidth,\n          _r$color6 = r.color,\n          a = _r$color6 === void 0 ? \"white\" : _r$color6,\n          _r$background = r.background,\n          l = _r$background === void 0 ? \"rgba(0, 0, 0, 0.6)\" : _r$background,\n          h = r.style;\n        if (_this76._domMap.has(r.id)) {\n          var c = _this76._domMap.get(r.id);\n          c && (c.innerHTML = n);\n        } else {\n          var _c = m.drawTagByDom(_this76._container, n, r.id);\n          _c && (_c.setAttribute(\"style\", \"\\n              position: absolute;\\n              top: 0;\\n              right: 0;\\n              z-index: 20;\\n              padding: 8px 20px;\\n              font-size: 15px;\\n              max-width: \".concat(o, \"px;\\n              color: \").concat(a, \";\\n              text-align: left;\\n              line-height: 32px;\\n              word-break: break-all;\\n              white-space: pre-wrap;\\n              background: \").concat(l, \";\\n              opacity: 0.9;\\n              max-height: \").concat(_this76._height * .8, \"px;\\n              overflow-y: scroll;\\n              clear: both;\\n              \").concat(et.getStyle2String(h), \"\\n            \")), _c.addEventListener(\"wheel\", _this76.wheelChange), _this76._domMap.set(r.id, _c));\n        }\n      }), e.forEach(function (r) {\n        i.indexOf(r) === -1 && (_this76.clearTag(r), _this76._domMap.delete(r));\n      });\n    }\n  }]);\n  return Dn;\n}();\nvar _n = Object.defineProperty,\n  An = Object.defineProperties,\n  Rn = Object.getOwnPropertyDescriptors,\n  $i = Object.getOwnPropertySymbols,\n  Tn = Object.prototype.hasOwnProperty,\n  Sn = Object.prototype.propertyIsEnumerable,\n  Fi = function Fi(s, t, e) {\n    return t in s ? _n(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  F = function F(s, t) {\n    for (var e in t || (t = {})) Tn.call(t, e) && Fi(s, e, t[e]);\n    if ($i) {\n      var _iterator22 = _createForOfIteratorHelper($i(t)),\n        _step22;\n      try {\n        for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {\n          var e = _step22.value;\n          Sn.call(t, e) && Fi(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator22.e(err);\n      } finally {\n        _iterator22.f();\n      }\n    }\n    return s;\n  },\n  Ct = function Ct(s, t) {\n    return An(s, Rn(t));\n  };\nvar kn = 3,\n  On = 3,\n  we = \"#6371FF\";\nvar Mn = /*#__PURE__*/function (_st8) {\n  _inherits(Mn, _st8);\n  var _super10 = _createSuper(Mn);\n  function Mn(t) {\n    var _this77;\n    _classCallCheck(this, Mn);\n    _this77 = _super10.call(this, Ct(F({}, t), {\n      showDefaultCursor: !0\n    }));\n    _this77.style = {}, _this77.annotations = [], _this77.getHoverRectID = function (i) {\n      var r, n;\n      var o = _this77.getCoordinateUnderZoom(i),\n        a = w.changePointByZoom(o, 1 / _this77.zoom);\n      if (((r = _this77.annotations) == null ? void 0 : r.length) <= 0 || !((n = _this77.annotations) == null ? void 0 : n.length)) return;\n      var l = \"\",\n        h = Number.MAX_SAFE_INTEGER;\n      for (var c = 0; c < _this77.annotations.length; c++) {\n        var g = _this77.annotations[c];\n        switch (g.type) {\n          case \"rect\":\n            {\n              var d = g.annotation;\n              if (U.isInRect(o, d, kn, _this77.zoom)) {\n                var u = d.width * d.height;\n                u < h && (l = d.id, h = u);\n              }\n              break;\n            }\n          case \"polygon\":\n            {\n              var _d8 = g.annotation;\n              if (D.isInPolygon(a, _d8.pointList)) {\n                var _u6 = D.getPolygonArea(_d8.pointList);\n                _u6 < h && (l = _d8.id, h = _u6);\n              }\n              break;\n            }\n        }\n      }\n      return l;\n    };\n    var e;\n    _this77.style = (e = t.style) != null ? e : {\n      stroke: we,\n      thickness: 3\n    }, _this77.annotations = t.annotations, _this77.loading = !1, _this77.renderDomInstance = new Dn({\n      container: _this77.container,\n      height: _this77.canvas.height\n    });\n    return _this77;\n  }\n  _createClass(Mn, [{\n    key: \"setLoading\",\n    value: function setLoading(t) {\n      this.loading = t, this.render();\n    }\n  }, {\n    key: \"onMouseLeave\",\n    value: function onMouseLeave() {\n      _get(_getPrototypeOf(Mn.prototype), \"onMouseLeave\", this).call(this), this.mouseHoverID = void 0, this.emit(\"onChange\", \"hover\", []);\n    }\n  }, {\n    key: \"onMouseDown\",\n    value: function onMouseDown(t) {\n      if (_get(_getPrototypeOf(Mn.prototype), \"onMouseDown\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return !0;\n      var e = this.mouseHoverID;\n      if (t.button === 0) {\n        var i = [];\n        e && (i = [e]), this.emit(\"onChange\", \"selected\", i), this.render();\n      }\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(t) {\n      if (_get(_getPrototypeOf(Mn.prototype), \"onMouseMove\", this).call(this, t) || this.forbidMouseOperation || !this.imgInfo) return;\n      var e = this.mouseHoverID,\n        i = this.getHoverRectID(t);\n      if (e !== i) {\n        this.mouseHoverID = i;\n        var r = [];\n        i && (r = [i]), this.emit(\"onChange\", \"hover\", r), this.render();\n      }\n    }\n  }, {\n    key: \"updateData\",\n    value: function updateData(t) {\n      this.annotations = t, this.render();\n    }\n  }, {\n    key: \"getSpecificStyle\",\n    value: function getSpecificStyle(t) {\n      var e = B.pick(t, [\"stroke\", \"thickness\", \"fill\", \"radius\"]),\n        i = F(F({}, this.style), e);\n      return i.stroke && Object.assign(i, {\n        color: i.stroke\n      }), i;\n    }\n  }, {\n    key: \"getRenderText\",\n    value: function getRenderText(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      var i = \"\",\n        r = \"\";\n      return !t || e === !0 ? {\n        headerText: i,\n        bottomText: r\n      } : ((t == null ? void 0 : t.order) && (i = \"\".concat(t.order)), (t == null ? void 0 : t.label) && (i ? i = \"\".concat(i, \"_\").concat(t.label) : i = \"\".concat(t.label)), (t == null ? void 0 : t.attribute) && (i ? i = \"\".concat(i, \"  \").concat(t.attribute) : i = \"\".concat(t.attribute)), (t == null ? void 0 : t.textAttribute) && (r = t == null ? void 0 : t.textAttribute), {\n        headerText: i,\n        bottomText: r\n      });\n    }\n  }, {\n    key: \"getReferenceOptions\",\n    value: function getReferenceOptions(t) {\n      return t ? {\n        lineCap: \"butt\",\n        lineDash: [20, 20]\n      } : {};\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this78 = this;\n      try {\n        if (_get(_getPrototypeOf(Mn.prototype), \"render\", this).call(this), this.loading === !0) return;\n        this.renderDomInstance.render(this.annotations.filter(function (t) {\n          return t.type === \"text\" && t.annotation.position === \"rt\";\n        }).map(function (t) {\n          return t.annotation;\n        })), this.annotations.forEach(function (t) {\n          var e, i, r, n, o, a, l, h, c, g, d, u, f;\n          switch (t.type) {\n            case \"rect\":\n              {\n                var v = t.annotation,\n                  _v$hiddenText = v.hiddenText,\n                  b = _v$hiddenText === void 0 ? !1 : _v$hiddenText,\n                  p = v.isReference,\n                  y = _this78.zoom,\n                  I = w.changeRectByZoom(v, _this78.zoom, _this78.currentPos),\n                  _ = I.x,\n                  A = I.y,\n                  E = I.width,\n                  N = I.height,\n                  k = _this78.getSpecificStyle(v);\n                if (v.id === _this78.mouseHoverID || k.fill) {\n                  var lt = Le((i = (e = k == null ? void 0 : k.fill) != null ? e : k == null ? void 0 : k.stroke) != null ? i : we),\n                    Dt = \"rgba(\".concat(lt[0], \", \").concat(lt[1], \", \").concat(lt[2], \",\").concat(lt[3] * .8, \")\");\n                  m.drawRectWithFill(_this78.canvas, I, {\n                    color: Dt\n                  });\n                }\n                m.drawRect(_this78.canvas, I, F(Ct(F({}, k), {\n                  hiddenText: !0\n                }), _this78.getReferenceOptions(p)));\n                var _this78$getRenderText = _this78.getRenderText(v, v == null ? void 0 : v.hiddenText),\n                  V = _this78$getRenderText.headerText,\n                  gt = _this78$getRenderText.bottomText;\n                V && m.drawText(_this78.canvas, {\n                  x: _,\n                  y: A - 6\n                }, V, Ct(F({\n                  color: k.stroke,\n                  font: \"normal normal 900 14px SourceHanSansCN-Regular\"\n                }, Bt), {\n                  textMaxWidth: 300\n                }));\n                var ft = \"\".concat(Math.round(E / y), \" * \").concat(Math.round(N / y)),\n                  St = ft.length * 7;\n                if (b || m.drawText(_this78.canvas, {\n                  x: _ + E - St,\n                  y: A + N + 15\n                }, ft, F({\n                  color: k.stroke,\n                  font: \"normal normal 600 14px Arial\"\n                }, Bt)), gt) {\n                  var _lt = 20,\n                    _Dt = Math.max(20, E - St);\n                  m.drawText(_this78.canvas, {\n                    x: _,\n                    y: A + N + _lt\n                  }, v.textAttribute, F({\n                    color: k.stroke,\n                    font: \"italic normal 900 14px Arial\",\n                    textMaxWidth: _Dt\n                  }, Bt));\n                }\n                break;\n              }\n            case \"polygon\":\n              {\n                var _v4 = t.annotation;\n                if (!(((r = _v4 == null ? void 0 : _v4.pointList) == null ? void 0 : r.length) >= 3)) return;\n                var _v4$lineType = _v4.lineType,\n                  _b3 = _v4$lineType === void 0 ? R.Line : _v4$lineType,\n                  _p3 = w.changePointListByZoom((n = _v4 == null ? void 0 : _v4.pointList) != null ? n : [], _this78.zoom, _this78.currentPos),\n                  _y3 = _this78.getSpecificStyle(_v4);\n                if (_v4.id === _this78.mouseHoverID || _y3.fill) {\n                  var _k = Le((a = (o = _y3 == null ? void 0 : _y3.fill) != null ? o : _y3 == null ? void 0 : _y3.stroke) != null ? a : we),\n                    _V = \"rgba(\".concat(_k[0], \", \").concat(_k[1], \", \").concat(_k[2], \",\").concat(_k[3] * .8, \")\");\n                  m.drawPolygonWithFill(_this78.canvas, _p3, {\n                    color: _V,\n                    lineType: _b3\n                  });\n                }\n                var _I = Ct(F(Ct(F({}, _y3), {\n                  isClose: !0\n                }), _this78.getReferenceOptions(_v4 == null ? void 0 : _v4.isReference)), {\n                  lineType: _b3,\n                  strokeColor: _y3.stroke\n                });\n                var _3 = [];\n                if (_v4.showKeyPoint ? _3 = m.drawPolygonWithKeyPoint(_this78.canvas, _p3, _I) : _3 = m.drawPolygon(_this78.canvas, _p3, _I), (_v4 == null ? void 0 : _v4.showDirection) === !0 && ((l = _v4 == null ? void 0 : _v4.pointList) == null ? void 0 : l.length) > 2) {\n                  var _k2 = _p3[0],\n                    _V2 = L.getLineCenterPoint([_p3[0], _p3[1]]);\n                  if (_b3 === R.Curve) {\n                    var _gt = Math.floor(Y / 2);\n                    _k2 = _3[_gt], _V2 = _3[_gt + 1];\n                  }\n                  m.drawArrowByCanvas(_this78.canvas, _k2, _V2, {\n                    color: _y3.stroke,\n                    thickness: _y3.thickness\n                  }), m.drawCircle(_this78.canvas, _p3[0], _y3.thickness + 6, {\n                    color: _y3.stroke,\n                    thickness: _y3.thickness\n                  });\n                }\n                var _this78$getRenderText2 = _this78.getRenderText(_v4, _v4 == null ? void 0 : _v4.hiddenText),\n                  _E = _this78$getRenderText2.headerText,\n                  _N = _this78$getRenderText2.bottomText;\n                if (_E && m.drawText(_this78.canvas, _p3[0], _E, F({\n                  color: _y3.stroke\n                }, Z)), _N) {\n                  var _k3 = _p3[_p3.length - 1];\n                  m.drawText(_this78.canvas, {\n                    x: _k3.x + ot.x,\n                    y: _k3.y + ot.y\n                  }, _N, F({\n                    color: _y3.stroke\n                  }, Z));\n                }\n                break;\n              }\n            case \"line\":\n              {\n                var _v5 = t.annotation;\n                if (!(((h = _v5 == null ? void 0 : _v5.pointList) == null ? void 0 : h.length) >= 2)) return;\n                var _v5$lineType = _v5.lineType,\n                  _b4 = _v5$lineType === void 0 ? R.Line : _v5$lineType,\n                  _p4 = w.changePointListByZoom((c = _v5 == null ? void 0 : _v5.pointList) != null ? c : [], _this78.zoom, _this78.currentPos),\n                  _y4 = _this78.getSpecificStyle(_v5),\n                  _I2 = m.drawPolygon(_this78.canvas, _p4, Ct(F(F({}, _y4), _this78.getReferenceOptions(_v5 == null ? void 0 : _v5.isReference)), {\n                    lineType: _b4\n                  }));\n                if ((_v5 == null ? void 0 : _v5.showDirection) === !0 && ((g = _v5 == null ? void 0 : _v5.pointList) == null ? void 0 : g.length) > 2) {\n                  var _N2 = _p4[0],\n                    _k4 = L.getLineCenterPoint([_p4[0], _p4[1]]);\n                  if (_b4 === R.Curve) {\n                    var _V3 = Math.floor(Y / 2);\n                    _N2 = _I2[_V3], _k4 = _I2[_V3 + 1];\n                  }\n                  m.drawArrowByCanvas(_this78.canvas, _N2, _k4, {\n                    color: _y4.stroke,\n                    thickness: _y4.thickness\n                  }), m.drawCircle(_this78.canvas, _p4[0], _y4.thickness + 6, {\n                    color: _y4.stroke,\n                    thickness: _y4.thickness\n                  });\n                }\n                var _this78$getRenderText3 = _this78.getRenderText(_v5, _v5 == null ? void 0 : _v5.hiddenText),\n                  _A2 = _this78$getRenderText3.headerText,\n                  _E2 = _this78$getRenderText3.bottomText;\n                if (_A2 && m.drawText(_this78.canvas, _p4[0], _A2, F({\n                  color: _y4.stroke\n                }, Z)), _E2) {\n                  var _N3 = _p4[_p4.length - 1];\n                  m.drawText(_this78.canvas, {\n                    x: _N3.x + ot.x,\n                    y: _N3.y + ot.y\n                  }, _E2, F({\n                    color: _y4.stroke\n                  }, Z));\n                }\n                break;\n              }\n            case \"point\":\n              {\n                var _v6 = t.annotation,\n                  _b5 = w.changePointByZoom(_v6, _this78.zoom, _this78.currentPos),\n                  _p5 = _this78.getSpecificStyle(_v6),\n                  _y5 = (d = _p5.radius) != null ? d : On;\n                m.drawCircle(_this78.canvas, _b5, _y5, _p5);\n                var _this78$getRenderText4 = _this78.getRenderText(_v6, _v6 == null ? void 0 : _v6.hiddenText),\n                  _I3 = _this78$getRenderText4.headerText,\n                  _4 = _this78$getRenderText4.bottomText;\n                _I3 && m.drawText(_this78.canvas, {\n                  x: _b5.x + _y5 / 2,\n                  y: _b5.y - _y5 - 4\n                }, _I3, {\n                  textAlign: \"center\",\n                  color: _p5.stroke\n                }), _4 && m.drawText(_this78.canvas, {\n                  x: _b5.x + _y5,\n                  y: _b5.y + _y5 + 24\n                }, _4, F({\n                  color: _p5.stroke\n                }, Z));\n                break;\n              }\n            case \"text\":\n              {\n                var _v7 = t.annotation,\n                  _b6 = _v7.text,\n                  _p6 = _v7.x,\n                  _y6 = _v7.y,\n                  _I4 = _v7.textMaxWidth,\n                  _v$color = _v7.color,\n                  _5 = _v$color === void 0 ? \"white\" : _v$color,\n                  _v$background = _v7.background,\n                  _A3 = _v$background === void 0 ? \"rgba(0, 0, 0, 0.6)\" : _v$background,\n                  _v$lineHeight = _v7.lineHeight,\n                  _E3 = _v$lineHeight === void 0 ? 25 : _v$lineHeight,\n                  _v$font = _v7.font,\n                  _N4 = _v$font === void 0 ? yt : _v$font,\n                  _k5 = _v7.position,\n                  _V4 = 10,\n                  _gt2 = 10,\n                  _ft = w.changePointByZoom({\n                    x: _p6,\n                    y: _y6\n                  }, _this78.zoom, _this78.currentPos),\n                  _L$getTextArea = L.getTextArea(_this78.canvas, _v7.text, _I4, _N4, _E3),\n                  _St = _L$getTextArea.width,\n                  _lt2 = _L$getTextArea.height,\n                  _L$getTextArea$fontHe = _L$getTextArea.fontHeight,\n                  _Dt2 = _L$getTextArea$fontHe === void 0 ? 0 : _L$getTextArea$fontHe;\n                if (_k5 === \"rt\") break;\n                m.drawRectWithFill(_this78.canvas, {\n                  x: _ft.x,\n                  y: _ft.y,\n                  width: _St + _gt2 * 2,\n                  height: _lt2 + _V4 * 2,\n                  id: \"\",\n                  sourceID: \"\",\n                  valid: !0,\n                  textAttribute: \"\",\n                  attribute: \"\",\n                  isVisible: !0\n                }, {\n                  color: _A3\n                }), m.drawText(_this78.canvas, {\n                  x: _ft.x + _gt2,\n                  y: _ft.y + _Dt2 + _V4\n                }, _b6, {\n                  color: _5,\n                  lineHeight: _E3,\n                  font: _N4,\n                  textMaxWidth: _I4\n                });\n                break;\n              }\n            default:\n          }\n          (f = (u = t.annotation) == null ? void 0 : u.renderEnhance) == null || f.call(u, {\n            ctx: _this78.ctx,\n            canvas: _this78.canvas,\n            currentPos: _this78.currentPos,\n            zoom: _this78.zoom,\n            data: t,\n            toolInstance: _this78\n          });\n        });\n      } catch (t) {\n        console.error(\"ViewOperation Render Error\", t);\n      }\n    }\n  }]);\n  return Mn;\n}(st);\nvar En = {\n    0: \"\\u76EE\\u6807\\u68C0\\u6D4B\",\n    1: \"\\u56FE\\u50CF\\u5206\\u7C7B\"\n  },\n  Nn = {\n    0: \"\\u6807\\u6CE8\\u6587\\u4EF6\\u4F20\\u8F93\\u4E2D\",\n    1: \"\\u6807\\u6CE8\\u6587\\u4EF6\\u4F20\\u8F93\\u91CD\\u8BD5\",\n    2: \"\\u6807\\u6CE8\\u6587\\u4EF6\\u4F20\\u8F93\\u5931\\u8D25\",\n    3: \"\\u6807\\u6CE8\\u4E2D\",\n    4: \"\\u4EFB\\u52A1\\u7EC8\\u6B62\",\n    5: \"\\u4EFB\\u52A1\\u5B8C\\u6210\",\n    6: \"\\u6570\\u636E\\u5DF2\\u53D1\\u5E03\"\n  };\nvar Ie;\n(function (s) {\n  s[s.Upload = 0] = \"Upload\", s[s.UploadRetry = 1] = \"UploadRetry\", s[s.UploadFail = 2] = \"UploadFail\", s[s.Annotation = 3] = \"Annotation\", s[s.Terminated = 4] = \"Terminated\", s[s.Finish = 5] = \"Finish\", s[s.Publish = 6] = \"Publish\";\n})(Ie || (Ie = {}));\nvar Hn = Object.freeze({\n  __proto__: null,\n  ANNOTATION_TYPE: En,\n  ANNOTATION_STATUS: Nn,\n  get EAnnotationStatus() {\n    return Ie;\n  }\n});\nvar Bn = /*#__PURE__*/function () {\n  function Bn() {\n    _classCallCheck(this, Bn);\n  }\n  _createClass(Bn, null, [{\n    key: \"load\",\n    value: function load(t) {\n      return new Promise(function (e, i) {\n        var r;\n        typeof Image != \"undefined\" && (r = new Image(), t.startsWith(\"file\") ? r.src = encodeURI(t) : r.src = t, r.onload = function () {\n          e(r);\n        }, r.onerror = function () {\n          i(r);\n        });\n      });\n    }\n  }]);\n  return Bn;\n}();\nvar $n = Object.defineProperty,\n  Fn = Object.defineProperties,\n  Zn = Object.getOwnPropertyDescriptors,\n  Zi = Object.getOwnPropertySymbols,\n  Un = Object.prototype.hasOwnProperty,\n  zn = Object.prototype.propertyIsEnumerable,\n  Ui = function Ui(s, t, e) {\n    return t in s ? $n(s, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : s[t] = e;\n  },\n  Vn = function Vn(s, t) {\n    for (var e in t || (t = {})) Un.call(t, e) && Ui(s, e, t[e]);\n    if (Zi) {\n      var _iterator23 = _createForOfIteratorHelper(Zi(t)),\n        _step23;\n      try {\n        for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {\n          var e = _step23.value;\n          zn.call(t, e) && Ui(s, e, t[e]);\n        }\n      } catch (err) {\n        _iterator23.e(err);\n      } finally {\n        _iterator23.f();\n      }\n    }\n    return s;\n  },\n  Wn = function Wn(s, t) {\n    return Fn(s, Zn(t));\n  },\n  jn = function jn(s, t, e) {\n    return new Promise(function (i, r) {\n      var n = function n(l) {\n          try {\n            a(e.next(l));\n          } catch (h) {\n            r(h);\n          }\n        },\n        o = function o(l) {\n          try {\n            a(e.throw(l));\n          } catch (h) {\n            r(h);\n          }\n        },\n        a = function a(l) {\n          return l.done ? i(l.value) : Promise.resolve(l.value).then(n, o);\n        };\n      a((e = e.apply(s, t)).next());\n    });\n  };\nvar Xn = function Xn(s) {\n  return new Promise(function (t, e) {\n    var i = document.createElement(\"img\");\n    i.crossOrigin = \"Anonymous\", i.onerror = function (r) {\n      console.error(r), e(i);\n    }, i.src = s, i.onload = function () {\n      t(i);\n    };\n  });\n};\nvar Kn = /*#__PURE__*/function () {\n  function Kn(t) {\n    var _this79 = this;\n    _classCallCheck(this, Kn);\n    this.setImgSrc = function (a) {\n      return jn(_this79, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var l;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return Xn(a);\n            case 2:\n              l = _context4.sent;\n              !l || this.setImgNode(l);\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n    };\n    var e, i, r;\n    this.isShowOrder = t.isShowOrder, this.tagConfigList = t.tagConfigList, this.attributeList = t.attributeList, this.allAttributesList = t.allAttributesList, this.container = t.container, this.size = t.size, this.toolName = t.toolName, this.imgNode = t.imgNode;\n    var n = (e = t.config) != null ? e : Ye(t.toolName);\n    var o = _toConsumableArray(t.attributeList);\n    (t.toolName === \"rectTool\" || t.toolName === \"pointTool\" || t.toolName === \"lineTool\" || t.toolName === \"polygonTool\") && t.config && typeof t.config == \"object\" && Object.keys(t.config).indexOf(\"attributeList\") >= 0 && (o = [].concat(_toConsumableArray(o), _toConsumableArray((i = t.config) == null ? void 0 : i.attributeList))), this.config = Wn(Vn({}, n), {\n      attributeList: o,\n      tagConfigList: t.tagConfigList\n    }), this.style = (r = t.style) != null ? r : Ge, this.i18nLanguage = \"cn\", this._initToolOperation();\n  }\n  _createClass(Kn, [{\n    key: \"setToolName\",\n    value: function setToolName(t, e) {\n      this.toolName = t;\n      var i = e || Ye(t);\n      this.config = i, this._initToolOperation();\n    }\n  }, {\n    key: \"setImgNode\",\n    value: function setImgNode(t, e) {\n      !this.toolInstance || (this.imgNode = t, this.toolInstance.setImgNode(t, e));\n    }\n  }, {\n    key: \"setSize\",\n    value: function setSize(t) {\n      this.size = t;\n    }\n  }, {\n    key: \"setStyle\",\n    value: function setStyle(t) {\n      this.style = t;\n    }\n  }, {\n    key: \"_initToolOperation\",\n    value: function _initToolOperation() {\n      var t;\n      this.toolInstance && this.toolInstance.destroy();\n      var e = x.getCurrentOperation(this.toolName);\n      if (!e) return;\n      var i = {\n        container: this.container,\n        size: this.size,\n        config: this.config,\n        drawOutSideTarget: !1,\n        style: this.style\n      };\n      this.imgNode && Object.assign(i, {\n        imgNode: this.imgNode\n      }), this.toolInstance = new e(i), this.setLang(this.i18nLanguage), this.toolInstance.init(), this.toolInstance.setIsShowOrder(this.isShowOrder), this.allAttributesList && ((t = this.toolInstance) == null || t.setAllAttributes(this.allAttributesList));\n    }\n  }, {\n    key: \"setBasicInfo\",\n    value: function setBasicInfo(t, e) {\n      this.dependToolName = t, this.basicResult = e, this.toolInstance.setDependName(t), this.toolInstance.setBasicResult(e), this.toolInstance.renderBasicCanvas();\n    }\n  }, {\n    key: \"setPrevResultList\",\n    value: function setPrevResultList(t) {\n      this.toolInstance.setPrevResultList(t);\n    }\n  }, {\n    key: \"clearBasicResult\",\n    value: function clearBasicResult() {\n      this.setBasicInfo();\n    }\n  }, {\n    key: \"forbidOperation\",\n    value: function forbidOperation() {\n      this.toolInstance.setForbidOperation(!0);\n    }\n  }, {\n    key: \"launchOperation\",\n    value: function launchOperation() {\n      this.toolInstance.setForbidOperation(!1);\n    }\n  }, {\n    key: \"setLang\",\n    value: function setLang(t) {\n      switch (this.i18nLanguage = t, t) {\n        case \"cn\":\n          this.toolInstance.setLang(ht.Zh);\n          break;\n        case \"en\":\n          this.toolInstance.setLang(ht.US);\n          break;\n      }\n    }\n  }, {\n    key: \"setDataInjectionAtCreation\",\n    value: function setDataInjectionAtCreation(t) {\n      this.toolInstance.setDataInjectionAtCreation(t);\n    }\n  }, {\n    key: \"setRenderEnhance\",\n    value: function setRenderEnhance(t) {\n      this.toolInstance.setRenderEnhance(t);\n    }\n  }]);\n  return Kn;\n}();\nvar Yn = x;\nexport { Kn as AnnotationEngine, T as AttributeUtils, w as AxisUtils, st as BasicToolOperation, pt as COLORS_ARRAY, x as CommonToolUtils, ni as DblClickEventListener, m as DrawUtils, S as EKeyCode, P as EToolName, Bn as ImgUtils, wi as LineToolOperation, ve as MarkerUtils, L as MathUtils, Cn as MeasureOperation, Di as PointOperation, pi as PolygonOperation, me as RectOperation, U as RectUtils, Pe as TOOL_NAME, bi as TagOperation, Lt as TagUtils, _i as TextToolOperation, Mn as ViewOperation, hs as cAnnotation, Hn as cAnnotationTask, mr as cKeyCode, Vs as cStyle, Gi as cTool, Yn as toolUtils, J as uuid };","map":null,"metadata":{},"sourceType":"module"}