{"ast":null,"code":"import _toConsumableArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/decrytal-ade/project/work/shlab/labelU-Kit/packages/web/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport u, { useState as x, useRef as I, useEffect as $ } from \"react\";\nimport { useDispatch as z, useSelector as B } from \"react-redux\";\nimport M from \"../../../../assets/annotation/common/icon_next.svg.js\";\nimport U from \"../../../../assets/annotation/common/icon_back.svg.js\";\nimport Z from \"../../../../assets/annotation/common/icon_nextA.svg.js\";\nimport q from \"../../../../assets/annotation/common/icon_backA.svg.js\";\nimport { prefix as F } from \"../../../../constant/index.js\";\nimport { EToolName as v } from \"../../../../data/enums/ToolType.js\";\nimport { useTranslation as G } from \"react-i18next\";\nimport { cTool as Q, EKeyCode as H } from \"@label-u/annotation\";\nimport { Popover as W } from \"antd\";\nimport { UpdateImgList as L } from \"../../../../store/annotation/actionCreators.js\";\nimport { toolList as X } from \"../ToolOperation/index.js\";\nvar Y = Object.defineProperty,\n  ee = Object.defineProperties,\n  te = Object.getOwnPropertyDescriptors,\n  C = Object.getOwnPropertySymbols,\n  oe = Object.prototype.hasOwnProperty,\n  re = Object.prototype.propertyIsEnumerable,\n  A = function A(r, o, s) {\n    return o in r ? Y(r, o, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: s\n    }) : r[o] = s;\n  },\n  le = function le(r, o) {\n    for (var s in o || (o = {})) oe.call(o, s) && A(r, s, o[s]);\n    if (C) {\n      var _iterator = _createForOfIteratorHelper(C(o)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var s = _step.value;\n          re.call(o, s) && A(r, s, o[s]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return r;\n  },\n  se = function se(r, o) {\n    return ee(r, te(o));\n  };\nvar ne = Q.EVideoToolName;\nvar f;\n(function (r) {\n  r.Hover = \"#666fff\", r.Normal = \"#cccccc\";\n})(f || (f = {}));\nvar d = [v.Rect, v.Point, v.Line, v.Polygon],\n  ae = function ae(r) {\n    var _x = x(\"\"),\n      _x2 = _slicedToArray(_x, 2),\n      o = _x2[0],\n      s = _x2[1],\n      _x3 = x([]),\n      _x4 = _slicedToArray(_x3, 2),\n      y = _x4[0],\n      O = _x4[1],\n      T = r.stepInfo,\n      P = z(),\n      E = I(),\n      R = I(),\n      _G = G(),\n      S = _G.t,\n      _B = B(function (e) {\n        return {\n          annotation: e.annotation,\n          imgAttribute: e.imgAttribute\n        };\n      }),\n      _B$annotation = _B.annotation,\n      N = _B$annotation.toolInstance,\n      c = _B$annotation.imgList,\n      p = _B$annotation.imgIndex,\n      w = _B$annotation.currentToolName,\n      _ = [v.Tag, ne.VideoTagTool].includes(T == null ? void 0 : T.tool),\n      g = r.isBegin || _,\n      k = function k(e) {\n        var a, t;\n        switch (e.keyCode === H.Alt && e.preventDefault(), e.keyCode) {\n          case H.Z:\n            if (e.ctrlKey) return e.shiftKey ? (a = R.current) == null || a.click() : (t = E.current) == null || t.click(), !1;\n            break;\n        }\n      };\n    $(function () {\n      return document.addEventListener(\"keydown\", k), function () {\n        document.removeEventListener(\"keydown\", k);\n      };\n    }, []);\n    var b = function b(e) {\n        var a = [];\n        var _iterator2 = _createForOfIteratorHelper(X),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var t = _step2.value;\n            if (t.toolName !== w && e[t.toolName]) {\n              var i = {\n                toolName: t.toolName,\n                result: e[t.toolName].result\n              };\n              a.push(i);\n            }\n            t.toolName === w && N.setResult(e[t.toolName].result);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        N.setPrevResultList(a), N.render();\n      },\n      D = function D() {\n        var e, a, t;\n        if (c && c.length > 0 && c.length > p) {\n          var i = 0,\n            m = JSON.parse(c[p].result);\n          for (var _i = 0, _d = d; _i < _d.length; _i++) {\n            var n = _d[_i];\n            ((e = m[n]) == null ? void 0 : e.result) && (i += (a = m[n]) == null ? void 0 : a.result.length);\n          }\n          var _loop = function _loop() {\n            var n = _d2[_i2];\n            var l = (t = m[n]) == null ? void 0 : t.result;\n            if (l && l.length > 0) {\n              var V = l.reduce(function (j, h) {\n                return h.order !== i ? j.push(h) : (y.push(se(le({}, h), {\n                  toolName: n\n                })), O(y)), j;\n              }, []);\n              m[n].result = V;\n            }\n          };\n          for (var _i2 = 0, _d2 = d; _i2 < _d2.length; _i2++) {\n            _loop();\n          }\n          c[p].result = JSON.stringify(m), P(L(c)), b(m);\n        }\n      },\n      J = function J() {\n        var e, a;\n        var t = JSON.parse(c[p].result),\n          i = y.pop();\n        if (!i) {\n          O([]);\n          return;\n        }\n        var m = 0;\n        for (var _i3 = 0, _d3 = d; _i3 < _d3.length; _i3++) {\n          var n = _d3[_i3];\n          var l = (e = t[n]) == null ? void 0 : e.result;\n          l && l.length > 0 && (m += l.length);\n        }\n        i.order = m + 1;\n        for (var _i4 = 0, _d4 = d; _i4 < _d4.length; _i4++) {\n          var _n = _d4[_i4];\n          var _l = (a = t[_n]) == null ? void 0 : a.result;\n          i.toolName === _n && (delete i.toolName, _l && _l.length > 0 ? _l = [].concat(_toConsumableArray(_l), [i]) : _l = [i], t[_n].result = _l);\n        }\n        c[p].result = JSON.stringify(t), P(L(c)), b(t);\n      },\n      K = [{\n        toolName: \"revocation\",\n        show: !0,\n        commonSvg: U,\n        selectedSvg: q,\n        click: function click() {\n          _ || D();\n        },\n        style: {\n          opacity: g === !0 ? .4 : 1,\n          fontSize: \"12px\",\n          color: !g && o === \"restore\" ? f.Hover : f.Normal\n        },\n        ref: E\n      }, {\n        toolName: \"restore\",\n        show: !0,\n        commonSvg: M,\n        selectedSvg: Z,\n        click: function click() {\n          _ || J();\n        },\n        style: {\n          opacity: g === !0 ? .4 : 1,\n          fontSize: \"12px\",\n          color: !g && o === \"revocation\" ? f.Hover : f.Normal\n        },\n        ref: R\n      }];\n    return /*#__PURE__*/u.createElement(\"div\", {\n      className: \"\".concat(F, \"-header__hotKey\")\n    }, K.map(function (e) {\n      return e.show && /*#__PURE__*/u.createElement(W, {\n        key: e.toolName,\n        content: S(e.toolName),\n        trigger: \"hover\"\n      }, /*#__PURE__*/u.createElement(\"div\", {\n        className: \"item\",\n        onMouseEnter: function onMouseEnter() {\n          return s(e.toolName);\n        },\n        onMouseLeave: function onMouseLeave() {\n          return s(\"\");\n        }\n      }, /*#__PURE__*/u.createElement(\"a\", {\n        ref: e.ref,\n        className: \"item\",\n        onClick: e.click\n      }, /*#__PURE__*/u.createElement(\"img\", {\n        className: \"singleTool\",\n        src: o === e.toolName ? e.selectedSvg : e.commonSvg,\n        style: e.style\n      }), /*#__PURE__*/u.createElement(\"div\", {\n        style: e.style\n      }, S(e.title)))));\n    }));\n  };\nexport { ae as default, d as labelTool };","map":null,"metadata":{},"sourceType":"module"}